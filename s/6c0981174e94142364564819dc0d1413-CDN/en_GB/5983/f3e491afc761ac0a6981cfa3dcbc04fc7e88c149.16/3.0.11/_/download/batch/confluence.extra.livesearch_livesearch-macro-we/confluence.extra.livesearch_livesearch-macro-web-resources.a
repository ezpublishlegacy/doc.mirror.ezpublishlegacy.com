;try {
/* module-key = 'confluence.extra.livesearch:livesearch-macro-web-resources', location = 'templates/extra/livesearch/script/livesearch.js' */
AJS.toInit(function(c){var e={userinfo:"icon-user",personalspace:"icon-personal-space"};var a=function(f){var g={title:f.title,link:[{type:"text/html",rel:"alternate",href:AJS.params.contextPath+decodeURI(f.url)}],type:f.contentType};if(f.searchResultContainer){g.space={name:f.searchResultContainer.name}}if(f.metadata&&f.metadata.cssClass){g.livesearchIconClass=f.metadata.cssClass}var h=f.contentType;if(h&&e[h]){g.livesearchIconClass=e[h]}if(f.bodyTextHighlights){g.bodyTextHighlights=f.bodyTextHighlights}return g};var b=function(f,g){f.after(f.clone().attr("class","additional").html(g));f.parent().addClass("with-additional")};var d=function(h,f,g){return[{title:g,link:[{type:"text/html",rel:"alternate",href:AJS.params.baseUrl+"/dosearchsite.action?queryString="+h+"&where="+f}],iconClass:"search-for"}]};c(".search-macro-query input").each(function(){var l=c(this),h=l.closest("form"),g=h.find(".aui-icon.aui-iconfont-search"),i=h.find("input[name='where']").val(),f=h.find("input[name='additional']").val(),k=h.find("input[name='labels']").val(),j=h.find("input[name='contentType']").val();l.quicksearch("/rest/searchv3/1.0/search",null,{minLengthForGetData:3,dropdownPlacement:function(o){var m=h.siblings(".aui-dd-parent");var n=h.parent(".search-macro").position();m.css({position:"absolute",top:n.top+l.outerHeight(),width:l.outerWidth()});o.width(l.outerWidth());m.append(o)},makeParams:function(m){return{queryString:m,where:i,labels:k?k.split(","):undefined,type:j,user:AJS.Meta.get("remote-user"),pageSize:5,highlight:false,sessionUuid:"0-0-0-0"}},makeRestMatrixFromData:function(o){var m=[],n=l.val();if(o.results&&o.results.length){m=_.map(o.results,a);return[m,d(n,i,AJS.format("See more results for \'\'{0}\'\'",n))]}else{m=d(n,i,AJS.format("No results found for \'\'{0}\'\'",n));return m?[m]:[]}},dropdownPostprocess:function(m){AJS.$("a",m).each(function(){var r=c(this),o=r.find("span"),s=r.parent("li"),n=AJS.dropDown.getAdditionalPropertyValue(o,"restObj");if(n&&n.livesearchIconClass){var q=AJS.dropDown.getAdditionalPropertyValue(o,"iconClass");r.removeClass(q);o.addClass(n.livesearchIconClass)}if(f==="space name"){var p=AJS.dropDown.getAdditionalPropertyValue(o,"spaceName");if(p&&!r.is(".content-type-spacedesc")){b(r,p)}}else{if(f==="page excerpt"){if(n.bodyTextHighlights){b(r,n.bodyTextHighlights)}}}s.attr("data-content-type",n.type)})},ajsDropDownOptions:{className:"search-macro-dropdown"}});l.on({"quick-search-loading-start":function(){g.addClass("aui-icon-wait").removeClass("aui-iconfont-search")},"quick-search-loading-stop":function(){g.removeClass("aui-icon-wait").addClass("aui-iconfont-search")}})})});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
