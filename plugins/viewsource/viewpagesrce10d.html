                    
    
                    
    
                    
    
<!DOCTYPE html>
<html>
    
<!-- Mirrored from doc.ez.no/plugins/viewsource/viewpagesrc.action?pageId=31430179 by HTTrack Website Copier/3.x [XR&CO'2013], Tue, 31 Jan 2017 09:38:04 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head>
        <title>View Source</title>
        <link rel="canonical" href="../../pages/viewpagee10d.html?pageId=31430179" />
        <script>
window.WRM=window.WRM||{};window.WRM._unparsedData=window.WRM._unparsedData||{};
WRM._unparsedData["com.atlassian.plugins.atlassian-plugins-webresource-rest:web-resource-manager.resource-base-url-pattern"]="\"(?:(?:/s/.*?/_)?/download)\"";
WRM._unparsedData["com.atlassian.plugins.atlassian-plugins-webresource-plugin:context-path.context-path"]="\"\"";
WRM._unparsedData["com.atlassian.plugins.browser.metrics.browser-metrics-plugin:browser-metrics.feature-data-provider-legacy"]="true";
</script>
<link type="text/css" rel="stylesheet" href="../../s/1b9968ac17721e3a6947d14e3a43c3f8-CDN/en_GB/5983/f3e491afc761ac0a6981cfa3dcbc04fc7e88c149.16/89/_/download/superbatch/css/batch9c16.css?build-number=5983" media="all">
<!--[if lt IE 9]>
<link type="text/css" rel="stylesheet" href="/s/d41d8cd98f00b204e9800998ecf8427e-CDN/en_GB/5983/f3e491afc761ac0a6981cfa3dcbc04fc7e88c149.16/89/_/download/superbatch/css/batch.css?conditionalComment=lt+IE+9" media="all">
<![endif]-->
<!--[if lte IE 9]>
<link type="text/css" rel="stylesheet" href="/s/d41d8cd98f00b204e9800998ecf8427e-CDN/en_GB/5983/f3e491afc761ac0a6981cfa3dcbc04fc7e88c149.16/89/_/download/superbatch/css/batch.css?conditionalComment=lte+IE+9" media="all">
<![endif]-->
<link type="text/css" rel="stylesheet" href="../../s/d41d8cd98f00b204e9800998ecf8427e-CDN/en_GB/5983/f3e491afc761ac0a6981cfa3dcbc04fc7e88c149.16/f3685658010e413141854089096800b5/_/download/contextbatch/css/plugin.viewsource/batch.css" media="all">
<link type="text/css" rel="stylesheet" href="../../s/df762e50bc83a9608020a1ff1476cda6-CDN/en_GB/5983/f3e491afc761ac0a6981cfa3dcbc04fc7e88c149.16/5a0f37b8e5a58a48983bc1f25fb099f6/_/download/contextbatch/css/page/batch.css" media="all">
<!--[if lt IE 9]>
<link type="text/css" rel="stylesheet" href="/s/d41d8cd98f00b204e9800998ecf8427e-CDN/en_GB/5983/f3e491afc761ac0a6981cfa3dcbc04fc7e88c149.16/5a0f37b8e5a58a48983bc1f25fb099f6/_/download/contextbatch/css/page/batch.css?conditionalComment=lt+IE+9" media="all">
<![endif]-->
<link type="text/css" rel="stylesheet" href="../../s/5714bd5a5c86641cad10106916cda7c8-CDN/en_GB/5983/f3e491afc761ac0a6981cfa3dcbc04fc7e88c149.16/49f5f7dfc888d48bff618d087d8044cc/_/download/contextbatch/css/editor-content/batch.css" media="all">
<!--[if lte IE 9]>
<link type="text/css" rel="stylesheet" href="/s/d41d8cd98f00b204e9800998ecf8427e-CDN/en_GB/5983/f3e491afc761ac0a6981cfa3dcbc04fc7e88c149.16/49f5f7dfc888d48bff618d087d8044cc/_/download/contextbatch/css/editor-content/batch.css?conditionalComment=lte+IE+9" media="all">
<![endif]-->
<link type="text/css" rel="stylesheet" href="../../s/en_GB/5983/f3e491afc761ac0a6981cfa3dcbc04fc7e88c149.16/6/_/styles/colors74cd.css?spaceKey=DEVELOPER" media="all">
<link type="text/css" rel="stylesheet" href="../../s/en_GB/5983/f3e491afc761ac0a6981cfa3dcbc04fc7e88c149.16/6/_/styles/custom74cd.css?spaceKey=DEVELOPER" media="all">

    </head>

    <body class="mceContentBody aui-theme-default wiki-content fullsize">
        <p>&nbsp;</p>         <div class="contentLayout2">
<div class="columnLayout two-right-sidebar" data-layout="two-right-sidebar">
<div class="cell normal" data-type="normal">
<div class="innerCell">
<h1>Introduction</h1><p>Image variations (image aliases) allow you to define and use different versions of the same image. You generate variations based on filters which modify aspects such as size and proportions, quality or decorations.</p><p>Image variations are generated with <a href="https://github.com/liip/LiipImagineBundle">LiipImagineBundle</a>, using the underlying <a href="http://imagine.readthedocs.org/en/latest/">Imagine library from avalanche123</a>. This bundle supports GD, Imagick or Gmagick PHP extensions, and allows you to define flexible filters in PHP. Image files are stored using the <code>IOService,</code> and are completely independent from the <code style="line-height: 1.42857;">ezimage</code> Field Type. They are generated only once and cleared on demand (e.g. on content removal).</p><h1>Configuration</h1><p>Custom image variations are defined in <code>ezplatform.yml</code> or any imported semantic configuration file. The definition is <a href="../../display/DEVELOPER/SiteAccess.html#SiteAccess-Configuration"><span class="confluence-link">dynamic</span></a>, so it can be configured per siteaccess and all the other scopes.</p><table class="wysiwyg-macro" data-macro-name="code" data-macro-id="85053dde-1ea5-4e64-a62e-00c9a53c643d" data-macro-parameters="title=Example image variation definition" data-macro-schema-version="1" style="background-image: url(../servlet/confluence/placeholder/macro-heading943b.png?definition=e2NvZGU6dGl0bGU9RXhhbXBsZSBpbWFnZSB2YXJpYXRpb24gZGVmaW5pdGlvbn0&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="PLAIN_TEXT"><tr><td class="wysiwyg-macro-body"><pre>ezpublish:
    system:
        my_siteaccess:
            image_variations:
                small:
                    reference: null
                    filters:
                        - { name: geometry/scaledownonly, params: [100, 160] }
                medium:
                    reference: null
                    filters:
                        - { name: geometry/scaledownonly, params: [200, 290] }
                listitem:
                    reference: null
                    filters:
                        - { name: geometry/scaledownonly, params: [130, 190] }
                articleimage:
                    reference: null
                    filters:
                        - { name: geometry/scalewidth, params: [770] }</pre></td></tr></table><table class="wysiwyg-macro" data-macro-name="tip" data-macro-id="714e1463-552c-4f9a-9b4c-ac90955dc884" data-macro-parameters="title=Important" data-macro-schema-version="1" style="background-image: url(../servlet/confluence/placeholder/macro-headingf7d5.png?definition=e3RpcDp0aXRsZT1JbXBvcnRhbnR9&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="RICH_TEXT"><tr><td class="wysiwyg-macro-body">Each variation name <strong>must be unique</strong>. It may contain <code>_</code> or <code>-</code> or numbers, but no spaces.</td></tr></table><p>The following parameters are set for each variation:</p><ul class="task-list"><li><p><code>reference</code>: Name of a reference variation to base the variation on. If set to <code>null</code> (or <code>~</code>, which means <code>null</code> in YAML), the variation will take the original image for reference. It can be any available variation configured in the <code>ezpublish</code> namespace, or a <code>filter_set</code> defined in the <code>liip_imagine</code> namespace.</p></li><li><p><code>filters</code>: Array of filter definitions (hashes containing <code>name</code> and <code>params</code> keys). See possible values <a class="confluence-link" href="#Images-Reference" data-anchor="Reference" data-linked-resource-default-alias="Reference" data-base-url="../../index.html">below</a>.</p></li></ul><h2>Default image variations</h2><p>A few basic image variations are included by default in eZ Platform in the <code><a href="https://github.com/ezsystems/ezpublish-kernel/blob/master/eZ/Bundle/EzPublishCoreBundle/Resources/config/default_settings.yml">default_settings.yml</a></code> config file:</p><table class="wysiwyg-macro" data-macro-name="code" data-macro-id="61bdc41d-32cd-4dbf-9642-c3ef86c32348" data-macro-schema-version="1" style="background-image: url(../servlet/confluence/placeholder/macro-heading34e7.png?definition=e2NvZGV9&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="PLAIN_TEXT"><tr><td class="wysiwyg-macro-body"><pre>ezsettings.default.image_variations:
    reference:
        reference: ~
        filters:
            geometry/scaledownonly: [600, 600]
    small:
        reference: reference
        filters:
            geometry/scaledownonly: [100, 100]
    tiny:
        reference: reference
        filters:
            geometry/scaledownonly: [30, 30]
    medium:
        reference: reference
        filters:
            geometry/scaledownonly: [200, 200]
    large:
        reference: reference
        filters:
            geometry/scaledownonly: [300, 300]</pre></td></tr></table><h1>Usage</h1><h2>Filter usage examples</h2><h5>Scaling with an eZ Platform filter</h5><p>This configuration defines a <code>medium</code> image variation that is scaled to a width of 700 px.</p><table class="wysiwyg-macro" data-macro-name="code" data-macro-id="8dda6a2d-dc5d-451e-bde9-c1fbc23bffec" data-macro-parameters="language=css" data-macro-schema-version="1" style="background-image: url(../servlet/confluence/placeholder/macro-headingfc2e.png?definition=e2NvZGU6bGFuZ3VhZ2U9Y3NzfQ&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="PLAIN_TEXT"><tr><td class="wysiwyg-macro-body"><pre>ezpublish:
    system:
        my_siteaccess:
            image_variations:
                medium:
                    reference: null
                    filters:
                        - geometry/scalewidth:
					        params: [770]</pre></td></tr></table><h5>Image quality with a liip filter</h5><p>This configuration adds a limit to the image quality using a liip filter.</p><p>You can use both an eZ Platform and a liip filter for the same image variation, in this case <code>medium</code>.</p><table class="wysiwyg-macro" data-macro-name="code" data-macro-id="501bcbaa-7ec2-4f23-ac6c-a6b6ba6e7df4" data-macro-parameters="language=css" data-macro-schema-version="1" style="background-image: url(../servlet/confluence/placeholder/macro-headingfc2e.png?definition=e2NvZGU6bGFuZ3VhZ2U9Y3NzfQ&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="PLAIN_TEXT"><tr><td class="wysiwyg-macro-body"><pre>ezpublish:
    system:
        my_siteaccess:
            image_variations:
				# List of variations

liip_imagine:
    driver: imagick
    filter_sets:
        medium:
            jpeg_quality: 50</pre></td></tr></table><table class="wysiwyg-macro" data-macro-name="note" data-macro-id="fb8bf151-625c-4a53-9d75-862aeb195c6b" data-macro-schema-version="1" style="background-image: url(../servlet/confluence/placeholder/macro-headingdd57.png?definition=e25vdGV9&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="RICH_TEXT"><tr><td class="wysiwyg-macro-body"><p>Notice that the <code>liip_imagine</code> key is not placed under <code>image_variations</code>, but at the same level as <code>ezpublish</code>.</p></td></tr></table><h2>Post-Processors</h2><p>LiipImagineBundle supports <a href="http://symfony.com/doc/master/bundles/LiipImagineBundle/post-processors.html">post-processors on image aliases</a><span>. It is possible to specify them in image variation configuration:</span></p><table class="wysiwyg-macro" data-macro-name="code" data-macro-id="21de7456-a8b8-4d5c-85f6-561c1dd50121" data-macro-parameters="language=bash" data-macro-schema-version="1" style="background-image: url(../servlet/confluence/placeholder/macro-heading174f.png?definition=e2NvZGU6bGFuZ3VhZ2U9YmFzaH0&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="PLAIN_TEXT"><tr><td class="wysiwyg-macro-body"><pre>ezpublish:
    system:
        my_siteaccess:
            image_variations:
                articleimage:
                    reference: null
                    filters:
                        - { name: geometry/scalewidth, params: [770] }
                    post_processors:
                        jpegoptim: {}</pre></td></tr></table><p><span>Please refer to <a href="http://symfony.com/doc/master/bundles/LiipImagineBundle/post-processors.html">post-processors documentation in LiipImagineBundle</a> <span> for details.</span> </span></p><h2>Drivers</h2><p>LiipImagineBundle supports GD (default), Imagick and GMagick PHP extensions and only works on image blobs (no command line tool is needed). See the <a href="http://symfony.com/doc/master/bundles/LiipImagineBundle/configuration.html">bundle's documentation to learn more on that topic</a>.</p><h2>Upgrade</h2><h4>Instantiate <code>LiipImagineBundle</code> in your kernel class</h4><p>If you were using ImageMagick, install <a href="http://php.net/imagick">Imagick</a> or <a href="http://php.net/gmagick">Gmagick</a> PHP extensions and activate the driver in <code>liip_imagine </code>(<a href="http://symfony.com/doc/master/bundles/LiipImagineBundle/configuration.html">see LiipImagineBundle configuration documentation for more information</a>):</p><table class="wysiwyg-macro" data-macro-name="code" data-macro-id="05910c60-35d0-445f-bbc3-c0c8b86e48b1" data-macro-parameters="language=bash" data-macro-schema-version="1" style="background-image: url(../servlet/confluence/placeholder/macro-heading174f.png?definition=e2NvZGU6bGFuZ3VhZ2U9YmFzaH0&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="PLAIN_TEXT"><tr><td class="wysiwyg-macro-body"><pre># ezplatform.yml or config.yml
liip_imagine:
    # Driver can be either "imagick", "gmagick" or "gd", depending on the PHP extension you're using.
    driver: imagick</pre></td></tr></table><table class="wysiwyg-macro" data-macro-name="info" data-macro-id="08b910cd-1a90-41c0-90d3-c24bad500857" data-macro-schema-version="1" style="background-image: url(../servlet/confluence/placeholder/macro-headingd35c.png?definition=e2luZm99&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="RICH_TEXT"><tr><td class="wysiwyg-macro-body"><p>GD will be used by default if no driver is specified.</p></td></tr></table><h2>Purging aliases</h2><p>It is possible to use the Liip Imagine console tool to clear generated aliases.</p><table class="wysiwyg-macro" data-macro-name="code" data-macro-id="878ce32c-5f55-4f8e-b7a0-f07e5b3334f0" data-macro-schema-version="1" style="background-image: url(../servlet/confluence/placeholder/macro-heading34e7.png?definition=e2NvZGV9&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="PLAIN_TEXT"><tr><td class="wysiwyg-macro-body"><pre>$ php app/console liip:imagine:cache:remove --filters=large
$ php app/console liip:imagine:cache:remove -v</pre></td></tr></table><p>The first example will clear the image files for the <code>large</code> alias. The second will clear all the generated aliases (be careful), and list the removed files (<code>-v).</code></p><table class="wysiwyg-macro" data-macro-name="note" data-macro-id="75897336-1ba4-418d-94a7-787d41fdca10" data-macro-schema-version="1" style="background-image: url(../servlet/confluence/placeholder/macro-headingdd57.png?definition=e25vdGV9&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="RICH_TEXT"><tr><td class="wysiwyg-macro-body"><p>The naming scheme change introduced by this feature wasn't enabled by default on 5.4.x. As part of migration you'll need to adapt to the new schema to get the benefit of this more efficient purge method. More technical information can be found on the <a href="https://github.com/ezsystems/ezpublish-kernel/pull/1276">pull request</a>.</p></td></tr></table><h1>Reference</h1><h2>Available filters</h2><p>In addition to <a href="http://symfony.com/doc/master/bundles/LiipImagineBundle/configuration.html">filters exposed by LiipImagineBundle</a>, the following are available:</p><table class="confluenceTable"><thead><tr><th class="confluenceTh">Filter name</th><th class="confluenceTh">Parameters</th><th class="confluenceTh">Description</th></tr></thead><tbody><tr><td class="confluenceTd">geometry/scaledownonly</td><td class="confluenceTd">[width, height]</td><td class="confluenceTd">Generates a thumbnail that will not exceed width/height.</td></tr><tr><td class="confluenceTd">geometry/scalewidthdownonly</td><td class="confluenceTd">[width]</td><td class="confluenceTd">Generates a thumbnail that will not exceed width.</td></tr><tr><td class="confluenceTd">geometry/scaleheightdownonly</td><td class="confluenceTd">[height]</td><td class="confluenceTd">Generates a thumbnail that will not exceed height.</td></tr><tr><td class="confluenceTd">geometry/scalewidth</td><td class="confluenceTd">[width]</td><td class="confluenceTd">Alters image width. Proportion will be kept.</td></tr><tr><td class="confluenceTd">geometry/scaleheight</td><td class="confluenceTd">[height]</td><td class="confluenceTd">Alters image height. Proportion will be kept.</td></tr><tr><td class="confluenceTd">geometry/scale</td><td class="confluenceTd">[width, height]</td><td class="confluenceTd">Alters image size, not exceeding provided width and height. Proportion will be kept.</td></tr><tr><td class="confluenceTd">geometry/scaleexact</td><td class="confluenceTd">[width, height]</td><td class="confluenceTd">Alters image size to fit exactly provided width and height. Proportion will not be kept.</td></tr><tr><td class="confluenceTd">geometry/scalepercent</td><td class="confluenceTd">[widthPercent, heightPercent]</td><td class="confluenceTd">Scales width and height with provided percent values. Proportion will not be kept.</td></tr><tr><td class="confluenceTd">geometry/crop</td><td class="confluenceTd">[width, height, startX, startY]</td><td class="confluenceTd">Crops the image. Result will have provided width/height, starting at provided startX/startY</td></tr><tr><td class="confluenceTd">border</td><td class="confluenceTd">[thickBorderX, thickBorderY, color=#000]</td><td class="confluenceTd">Adds a border around the image. Thickness is defined in px. Color is &quot;#000&quot; by default.</td></tr><tr><td class="confluenceTd">filter/noise</td><td class="confluenceTd">[radius=0]</td><td class="confluenceTd">Smooths the contours of an image (<code>imagick</code>/<code>gmagick</code> only). <code>radius</code> is in pixel.</td></tr><tr><td class="confluenceTd">filter/swirl</td><td class="confluenceTd">[degrees=60]</td><td class="confluenceTd">Swirls the pixels of the center of an image (<code>imagick</code>/<code>gmagick</code> only). <code>degrees</code> defaults to 60°.</td></tr><tr><td class="confluenceTd">resize</td><td class="confluenceTd">{size: [width, height]}</td><td class="confluenceTd">Simple resize filter (provided by LiipImagineBundle).</td></tr><tr><td class="confluenceTd">colorspace/gray</td><td class="confluenceTd">N/A</td><td class="confluenceTd">Converts an image to grayscale.</td></tr></tbody></table><table class="wysiwyg-macro" data-macro-name="info" data-macro-id="da273979-9814-4a65-bd99-dc77f2b3215c" data-macro-schema-version="1" style="background-image: url(../servlet/confluence/placeholder/macro-headingd35c.png?definition=e2luZm99&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="RICH_TEXT"><tr><td class="wysiwyg-macro-body"><p>LiipImagineBundle supports additional settings, it is possible to combine filters from the list above to <a href="http://symfony.com/doc/master/bundles/LiipImagineBundle/filters.html">the ones provided in LiipImagineBundle</a> or custom ones.</p></td></tr></table><h2>Discarded filters</h2><p>The following filters exist in the Imagine library but are not used in eZ Platform due to incompatibility:</p><ul class="task-list"><li><code>flatten</code>. Obsolete, images are automatically flattened.</li><li><code>bordercolor</code></li><li><code>border/width</code></li><li><code>colorspace/transparent</code></li><li><code>colorspace</code></li></ul><h2>Custom filters</h2><p>Please refer to <a href="http://symfony.com/doc/master/bundles/LiipImagineBundle/filters.html#custom-filters">LiipImagineBundle documentation on custom filters</a>. <a href="http://imagine.readthedocs.org/en/latest/">Imagine library documentation</a> may also be useful.</p></div>
</div>
<div class="cell aside" data-type="aside">
<div class="innerCell">
<h4>In this topic:</h4><p><img class="editor-inline-macro" src="../servlet/confluence/placeholder/macro7c73.png?definition=e3RvYzptYXhMZXZlbD0zfQ&amp;locale=en_GB&amp;version=2" data-macro-name="toc" data-macro-id="47079e32-4625-4387-a608-336506b480ab" data-macro-parameters="maxLevel=3" data-macro-schema-version="1"></p></div>
</div>
</div>
</div>
        <p>&nbsp;</p>
    </body>

<!-- Mirrored from doc.ez.no/plugins/viewsource/viewpagesrc.action?pageId=31430179 by HTTrack Website Copier/3.x [XR&CO'2013], Tue, 31 Jan 2017 09:38:05 GMT -->
</html>
