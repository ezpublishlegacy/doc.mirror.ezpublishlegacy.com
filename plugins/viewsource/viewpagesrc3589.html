                    
    
                    
    
                    
    
<!DOCTYPE html>
<html>
    
<!-- Mirrored from doc.ez.no/plugins/viewsource/viewpagesrc.action?pageId=31430309 by HTTrack Website Copier/3.x [XR&CO'2013], Tue, 31 Jan 2017 10:18:00 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head>
        <title>View Source</title>
        <link rel="canonical" href="../../pages/viewpage3589.html?pageId=31430309" />
        <script>
window.WRM=window.WRM||{};window.WRM._unparsedData=window.WRM._unparsedData||{};
WRM._unparsedData["com.atlassian.plugins.atlassian-plugins-webresource-rest:web-resource-manager.resource-base-url-pattern"]="\"(?:(?:/s/.*?/_)?/download)\"";
WRM._unparsedData["com.atlassian.plugins.atlassian-plugins-webresource-plugin:context-path.context-path"]="\"\"";
WRM._unparsedData["com.atlassian.plugins.browser.metrics.browser-metrics-plugin:browser-metrics.feature-data-provider-legacy"]="true";
</script>
<link type="text/css" rel="stylesheet" href="../../s/1b9968ac17721e3a6947d14e3a43c3f8-CDN/en_GB/5983/f3e491afc761ac0a6981cfa3dcbc04fc7e88c149.16/89/_/download/superbatch/css/batch9c16.css?build-number=5983" media="all">
<!--[if lt IE 9]>
<link type="text/css" rel="stylesheet" href="/s/d41d8cd98f00b204e9800998ecf8427e-CDN/en_GB/5983/f3e491afc761ac0a6981cfa3dcbc04fc7e88c149.16/89/_/download/superbatch/css/batch.css?conditionalComment=lt+IE+9" media="all">
<![endif]-->
<!--[if lte IE 9]>
<link type="text/css" rel="stylesheet" href="/s/d41d8cd98f00b204e9800998ecf8427e-CDN/en_GB/5983/f3e491afc761ac0a6981cfa3dcbc04fc7e88c149.16/89/_/download/superbatch/css/batch.css?conditionalComment=lte+IE+9" media="all">
<![endif]-->
<link type="text/css" rel="stylesheet" href="../../s/d41d8cd98f00b204e9800998ecf8427e-CDN/en_GB/5983/f3e491afc761ac0a6981cfa3dcbc04fc7e88c149.16/f3685658010e413141854089096800b5/_/download/contextbatch/css/plugin.viewsource/batch.css" media="all">
<link type="text/css" rel="stylesheet" href="../../s/df762e50bc83a9608020a1ff1476cda6-CDN/en_GB/5983/f3e491afc761ac0a6981cfa3dcbc04fc7e88c149.16/5a0f37b8e5a58a48983bc1f25fb099f6/_/download/contextbatch/css/page/batch.css" media="all">
<!--[if lt IE 9]>
<link type="text/css" rel="stylesheet" href="/s/d41d8cd98f00b204e9800998ecf8427e-CDN/en_GB/5983/f3e491afc761ac0a6981cfa3dcbc04fc7e88c149.16/5a0f37b8e5a58a48983bc1f25fb099f6/_/download/contextbatch/css/page/batch.css?conditionalComment=lt+IE+9" media="all">
<![endif]-->
<link type="text/css" rel="stylesheet" href="../../s/5714bd5a5c86641cad10106916cda7c8-CDN/en_GB/5983/f3e491afc761ac0a6981cfa3dcbc04fc7e88c149.16/49f5f7dfc888d48bff618d087d8044cc/_/download/contextbatch/css/editor-content/batch.css" media="all">
<!--[if lte IE 9]>
<link type="text/css" rel="stylesheet" href="/s/d41d8cd98f00b204e9800998ecf8427e-CDN/en_GB/5983/f3e491afc761ac0a6981cfa3dcbc04fc7e88c149.16/49f5f7dfc888d48bff618d087d8044cc/_/download/contextbatch/css/editor-content/batch.css?conditionalComment=lte+IE+9" media="all">
<![endif]-->
<link type="text/css" rel="stylesheet" href="../../s/en_GB/5983/f3e491afc761ac0a6981cfa3dcbc04fc7e88c149.16/6/_/styles/colors74cd.css?spaceKey=DEVELOPER" media="all">
<link type="text/css" rel="stylesheet" href="../../s/en_GB/5983/f3e491afc761ac0a6981cfa3dcbc04fc7e88c149.16/6/_/styles/custom74cd.css?spaceKey=DEVELOPER" media="all">

    </head>

    <body class="mceContentBody aui-theme-default wiki-content fullsize">
        <p>&nbsp;</p>         <div class="contentLayout2">
<div class="columnLayout two-right-sidebar" data-layout="two-right-sidebar">
<div class="cell normal" data-type="normal">
<div class="innerCell">
<p>In the following recipes, you will see how to create Content, including complex fields like XmlText or Image.</p><h2>Identifying to the repository with a login and a password</h2><p>As seen earlier, the Repository executes operations with a user's credentials. In a web context, the currently logged-in user is automatically identified. In a command line context, you need to manually log a user in. We have already seen how to manually load and set a user using its ID. If you would like to identify a user using their username and password instead, this can be achieved in the following way:</p><table class="wysiwyg-macro" data-macro-name="code" data-macro-id="73397120-64ac-4be3-84ab-d06c5491f9ac" data-macro-parameters="language=php|title=authentication " data-macro-schema-version="1" style="background-image: url(../servlet/confluence/placeholder/macro-heading24b2.png?definition=e2NvZGU6bGFuZ3VhZ2U9cGhwfHRpdGxlPWF1dGhlbnRpY2F0aW9uIH0&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="PLAIN_TEXT"><tr><td class="wysiwyg-macro-body"><pre>$user = $userService->loadUserByCredentials( $user, $password );
$repository->setCurrentUser( $user );</pre></td></tr></table><h2>Creating content</h2><table class="wysiwyg-macro" data-macro-name="info" data-macro-id="c5d8cb7d-f062-49ab-b5fb-3cc471662e7f" data-macro-parameters="title=Full code" data-macro-schema-version="1" style="background-image: url(../servlet/confluence/placeholder/macro-headingecc6.png?definition=e2luZm86dGl0bGU9RnVsbCBjb2RlfQ&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="RICH_TEXT"><tr><td class="wysiwyg-macro-body"><p><a href="https://github.com/ezsystems/CookbookBundle/blob/master/Command/CreateContentCommand.php">https://github.com/ezsystems/CookbookBundle/blob/master/Command/CreateContentCommand.php</a></p></td></tr></table><p>We will now see how to create Content using the Public API. This example will work with the default Folder (ID 1) Content Type from eZ Platform.</p><table class="wysiwyg-macro" data-macro-name="code" data-macro-id="b8729ae8-91f6-44ca-a8bf-65ceddaaf4ca" data-macro-parameters="language=php" data-macro-schema-version="1" style="background-image: url(../servlet/confluence/placeholder/macro-heading1802.png?definition=e2NvZGU6bGFuZ3VhZ2U9cGhwfQ&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="PLAIN_TEXT"><tr><td class="wysiwyg-macro-body"><pre>/** @var $repository \eZ\Publish\API\Repository\Repository */
$repository = $this->getContainer()->get( 'ezpublish.api.repository' );
$contentService = $repository->getContentService();
$locationService = $repository->getLocationService();
$contentTypeService = $repository->getContentTypeService();</pre></td></tr></table><p>We first need the required services. In this case: <code>ContentService</code>, <code>LocationService</code> and <code>ContentTypeService</code>.</p><h3>The ContentCreateStruct</h3><p>As explained in <a class="confluence-link" href="../../display/DEVELOPER/eZ%2bPlatform%2bPublic%2bPHP%2bAPI.html" data-linked-resource-id="31429583" data-linked-resource-version="5" data-linked-resource-type="page" data-linked-resource-default-alias="eZ Platform Public PHP API" data-base-url="../../index.html">eZ Platform Public PHP API</a>, Value Objects are read only. Dedicated objects are provided for Update and Create operations: structs, like <code>ContentCreateStruct</code> or <code>UpdateCreateStruct</code>. In this case, we need to use a <code>ContentCreateStruct</code>. </p><table class="wysiwyg-macro" data-macro-name="code" data-macro-id="cebc0cba-2d48-4cc5-a388-274b1178b0fe" data-macro-parameters="language=php" data-macro-schema-version="1" style="background-image: url(../servlet/confluence/placeholder/macro-heading1802.png?definition=e2NvZGU6bGFuZ3VhZ2U9cGhwfQ&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="PLAIN_TEXT"><tr><td class="wysiwyg-macro-body"><pre>$contentType = $contentTypeService->loadContentTypeByIdentifier( 'article' );
$contentCreateStruct = $contentService->newContentCreateStruct( $contentType, 'eng-GB' );</pre></td></tr></table><p>We first need to get the <a href="http://apidoc.ez.no/sami/trunk/NS/html/eZ/Publish/API/Repository/Values/ContentType/ContentType.html"> <code>ContentType</code> </a> we want to create a <code>Content</code> with. To do so, we use <a href="http://apidoc.ez.no/sami/trunk/NS/html/eZ/Publish/API/Repository/ContentTypeService.html#method_loadContentTypeByIdentifier"> <code>ContentTypeService::loadContentTypeByIdentifier()</code> </a>, with the wanted <code>ContentType</code> identifier, like 'article'. We finally get a ContentTypeCreateStruct using <a href="http://apidoc.ez.no/sami/trunk/NS/html/eZ/Publish/API/Repository/ContentService.html#method_newContentCreateStruct"> <code>ContentService::newContentCreateStruct()</code> </a>, providing the Content Type and a Locale Code (eng-GB).</p><h3>Setting the fields values</h3><table class="wysiwyg-macro" data-macro-name="code" data-macro-id="2f2a3b94-8f24-4541-a469-9a1b08e1fa63" data-macro-parameters="language=php" data-macro-schema-version="1" style="background-image: url(../servlet/confluence/placeholder/macro-heading1802.png?definition=e2NvZGU6bGFuZ3VhZ2U9cGhwfQ&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="PLAIN_TEXT"><tr><td class="wysiwyg-macro-body"><pre>$contentCreateStruct->setField( 'title', 'My title' );
$contentCreateStruct->setField( 'intro', $intro );
$contentCreateStruct->setField( 'body', $body );</pre></td></tr></table><p>Using our create struct, we can now set the values for our Content item's Fields, using the <a href="http://apidoc.ez.no/sami/trunk/NS/html/eZ/Publish/API/Repository/Values/Content/ContentCreateStruct.html#method_setField"> <code>setField()</code> </a> method. For now, we will just set the title. <code>setField()</code> for a TextLine Field simply expects a string as input argument. More complex Field Types, like Author or Image, expect different input values.</p><table class="wysiwyg-macro" data-macro-name="note" data-macro-id="e34587a1-52fd-4894-b7cc-7dafd7e8cf2e" data-macro-schema-version="1" style="background-image: url(../servlet/confluence/placeholder/macro-headingdd57.png?definition=e25vdGV9&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="RICH_TEXT"><tr><td class="wysiwyg-macro-body"><p>The <code>
        <a href="http://apidoc.ez.no/sami/trunk/NS/html/eZ/Publish/API/Repository/Values/Content/ContentCreateStruct.html#method_setField">ContentCreateStruct::setField()</a>
      </code> method can take several type of arguments.</p><p>In any case, whatever the Field Type is, a Value of this type can be provided. For instance, a TextLine\Value can be provided for a TextLine\Type. Depending on the Field Type implementation itself, more specifically on the <code>fromHash()</code> method every Field Type implements, various arrays can be accepted, as well as primitive types, depending on the Type.</p></td></tr></table><h3>Setting the Location</h3><p>In order to set a Location for our object, we must instantiate a <a href="http://apidoc.ez.no/sami/trunk/NS/html/eZ/Publish/API/Repository/Values/Content/LocationCreateStruct.html"> <code>LocationCreateStruct</code> </a>. This is done with <code>LocationService::newLocationCreateStruct()</code>, with the new Location's parent ID as an argument.</p><table class="wysiwyg-macro" data-macro-name="code" data-macro-id="93962610-2297-4225-b241-dff163250314" data-macro-parameters="language=php" data-macro-schema-version="1" style="background-image: url(../servlet/confluence/placeholder/macro-heading1802.png?definition=e2NvZGU6bGFuZ3VhZ2U9cGhwfQ&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="PLAIN_TEXT"><tr><td class="wysiwyg-macro-body"><pre>$locationCreateStruct = $locationService->newLocationCreateStruct( 2 );</pre></td></tr></table><h3>Creating and publishing</h3><p>To actually create our Content in the Repository, we need to use <code>ContentService::createContent()</code>. This method expects a <code>ContentCreateStruct</code>, as well as a <code>LocationCreateStruct</code>. We have created both in the previous steps.</p><table class="wysiwyg-macro" data-macro-name="code" data-macro-id="b9ae26d3-6fdd-4e76-b9c9-68682f5a9620" data-macro-parameters="language=php" data-macro-schema-version="1" style="background-image: url(../servlet/confluence/placeholder/macro-heading1802.png?definition=e2NvZGU6bGFuZ3VhZ2U9cGhwfQ&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="PLAIN_TEXT"><tr><td class="wysiwyg-macro-body"><pre>$draft = $contentService->createContent( $contentCreateStruct, array( $locationCreateStruct ) );
$content = $contentService->publishVersion( $draft->versionInfo );</pre></td></tr></table><p>The LocationCreateStruct is provided as an array, since a Content item can have multiple locations.</p><p><code>createContent()</code>returns a new Content Value Object, with one version that has the DRAFT status. To make this Content visible, we need to publish it. This is done using <code>ContentService::publishVersion()</code>. This method expects a <code>VersionInfo</code> object as its parameter. In our case, we simply use the current version from <code>$draft</code>, with the <code>versionInfo</code> property.</p><h2>Updating Content</h2><table class="wysiwyg-macro" data-macro-name="info" data-macro-id="8d147706-c31d-48e2-8ad9-d3a7a150ee5c" data-macro-parameters="title=Full code" data-macro-schema-version="1" style="background-image: url(../servlet/confluence/placeholder/macro-headingecc6.png?definition=e2luZm86dGl0bGU9RnVsbCBjb2RlfQ&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="RICH_TEXT"><tr><td class="wysiwyg-macro-body"><p><a href="https://github.com/ezsystems/CookbookBundle/blob/master/Command/UpdateContentCommand.php">https://github.com/ezsystems/CookbookBundle/blob/master/Command/UpdateContentCommand.php</a></p></td></tr></table><p>We will now see how the previously created Content can be updated. To do so, we will create a new draft for our Content, update it using a <a href="http://apidoc.ez.no/sami/trunk/NS/html/eZ/Publish/API/Repository/Values/Content/ContentUpdateStruct.html"> <code>ContentUpdateStruct</code> </a>, and publish the updated Version.</p><table class="wysiwyg-macro" data-macro-name="code" data-macro-id="10c44616-1efe-441a-9337-c3f1ee927e51" data-macro-parameters="language=php" data-macro-schema-version="1" style="background-image: url(../servlet/confluence/placeholder/macro-heading1802.png?definition=e2NvZGU6bGFuZ3VhZ2U9cGhwfQ&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="PLAIN_TEXT"><tr><td class="wysiwyg-macro-body"><pre>$contentInfo = $contentService->loadContentInfo( $contentId );
$contentDraft = $contentService->createContentDraft( $contentInfo );</pre></td></tr></table><p>To create our draft, we need to load the Content item's ContentInfo using <code>ContentService::loadContentInfo()</code>. We can then use <code>ContentService::createContentDraft()</code> to add a new Draft to our Content.</p><table class="wysiwyg-macro" data-macro-name="code" data-macro-id="0429fad6-be0b-4255-943e-bdb89ec89125" data-macro-parameters="language=php" data-macro-schema-version="1" style="background-image: url(../servlet/confluence/placeholder/macro-heading1802.png?definition=e2NvZGU6bGFuZ3VhZ2U9cGhwfQ&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="PLAIN_TEXT"><tr><td class="wysiwyg-macro-body"><pre>// instantiate a content update struct and set the new fields
$contentUpdateStruct = $contentService->newContentUpdateStruct();
$contentUpdateStruct->initialLanguageCode = 'eng-GB'; // set language for new version
$contentUpdateStruct->setField( 'title', $newTitle );
$contentUpdateStruct->setField( 'body', $newBody );</pre></td></tr></table><p>To set the new values for this version, we request a <code>ContentUpdateStruct</code> from the <code>ContentService</code> using the <code>newContentUpdateStruct()</code> method. Updating the values hasn't changed: we use the <code>setField()</code> method.</p><table class="wysiwyg-macro" data-macro-name="code" data-macro-id="d70f80e9-1596-4243-8d12-7db81d6b26fb" data-macro-parameters="language=php" data-macro-schema-version="1" style="background-image: url(../servlet/confluence/placeholder/macro-heading1802.png?definition=e2NvZGU6bGFuZ3VhZ2U9cGhwfQ&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="PLAIN_TEXT"><tr><td class="wysiwyg-macro-body"><pre>$contentDraft = $contentService->updateContent( $contentDraft->versionInfo, $contentUpdateStruct );
$content = $contentService->publishVersion( $contentDraft->versionInfo );</pre></td></tr></table><p>We can now use <code>ContentService::updateContent()</code> to apply our <code>ContentUpdateStruct</code> to our draft's <code>VersionInfo</code>. Publishing is done exactly the same way as for a new content, using <code>ContentService::publishVersion()</code>.</p><h2>Handling translations</h2><p>In the two previous examples, you have seen that we set the ContentUpdateStruct's <code>initialLanguageCode</code> property. To translate an object to a new language, set the locale to a new one.</p><table class="wysiwyg-macro" data-macro-name="code" data-macro-id="9d8cf03a-c79f-48dd-961d-bbdb96285a28" data-macro-parameters="language=php|title=translating" data-macro-schema-version="1" style="background-image: url(../servlet/confluence/placeholder/macro-heading19c2.png?definition=e2NvZGU6bGFuZ3VhZ2U9cGhwfHRpdGxlPXRyYW5zbGF0aW5nfQ&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="PLAIN_TEXT"><tr><td class="wysiwyg-macro-body"><pre>$contentUpdateStruct->initialLanguageCode = 'ger-DE';
$contentUpdateStruct->setField( 'title', $newtitle );
$contentUpdateStruct->setField( 'body', $newbody );</pre></td></tr></table><p>It is possible to create or update content in multiple languages at once. There is one restriction: only one language can be set a version's language. This language is the one that will get a flag in the back office. However, you can set values in other languages for your attributes, using the <code>setField</code> method's third argument.</p><table class="wysiwyg-macro" data-macro-name="code" data-macro-id="ee0ccd82-a060-4634-9e74-6a9d3612b1ba" data-macro-parameters="language=php|title=update multiple languages" data-macro-schema-version="1" style="background-image: url(../servlet/confluence/placeholder/macro-headingf6b1.png?definition=e2NvZGU6bGFuZ3VhZ2U9cGhwfHRpdGxlPXVwZGF0ZSBtdWx0aXBsZSBsYW5ndWFnZXN9&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="PLAIN_TEXT"><tr><td class="wysiwyg-macro-body"><pre>// set one language for new version
$contentUpdateStruct->initialLanguageCode = 'fre-FR';

$contentUpdateStruct->setField( 'title', $newgermantitle, 'ger-DE' );
$contentUpdateStruct->setField( 'body', $newgermanbody, 'ger-DE' );

$contentUpdateStruct->setField( 'title', $newfrenchtitle );
$contentUpdateStruct->setField( 'body', $newfrenchbody );
</pre></td></tr></table><p>Since we don't specify a locale for the last two fields, they are set for the <code>UpdateStruct</code>'s <code>initialLanguageCode</code>, fre-FR.</p><h2>Creating Content containing an image</h2><table class="wysiwyg-macro" data-macro-name="info" data-macro-id="9e4564cc-bae7-4940-bf32-b210c979e7c5" data-macro-parameters="title=Full code" data-macro-schema-version="1" style="background-image: url(../servlet/confluence/placeholder/macro-headingecc6.png?definition=e2luZm86dGl0bGU9RnVsbCBjb2RlfQ&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="RICH_TEXT"><tr><td class="wysiwyg-macro-body"><p><a href="https://github.com/ezsystems/CookbookBundle/blob/master/Command/CreateImageCommand.php">https://github.com/ezsystems/CookbookBundle/blob/master/Command/CreateImageCommand.php</a></p></td></tr></table><p>As explained above, the <code>setField()</code> method can accept various values: an instance of the Field Type's Value class, a primitive type, or a hash. The last two depend on what the <code>Type::acceptValue()</code> method is build up to handle. TextLine can, for instance, accept a simple string as an input value. In this example, you will see how to set an Image value.</p><p>We assume that we use the default image class. Creating our Content, using the Content Type and a ContentCreateStruct, has been covered above, and can be found in the full code. Let's focus on how the image is provided.</p><table class="wysiwyg-macro" data-macro-name="code" data-macro-id="c4faadcb-481d-4172-8776-58b7adc7d3c7" data-macro-parameters="language=php" data-macro-schema-version="1" style="background-image: url(../servlet/confluence/placeholder/macro-heading1802.png?definition=e2NvZGU6bGFuZ3VhZ2U9cGhwfQ&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="PLAIN_TEXT"><tr><td class="wysiwyg-macro-body"><pre>$file = '/path/to/image.png';

$value = new \eZ\Publish\Core\FieldType\Image\Value(
    array(
        'path' => '/path/to/image.png',
        'fileSize' => filesize( '/path/to/image.png' ),
        'fileName' => basename( 'image.png' ),
        'alternativeText' => 'My image'
    )
);
$contentCreateStruct->setField( 'image', $value );</pre></td></tr></table><p>This time, we create our image by directly providing an <a href="http://apidoc.ez.no/sami/trunk/NS/html/eZ/Publish/Core/FieldType/Image/Value.html"> <code>Image\Value</code> </a> object. The values are directly provided to the constructor using a hash with predetermined keys that depend on each Type. In this case: the path where the image can be found, its size, the file name, and an alternative text.</p><p>Images also implement a static <a href="http://apidoc.ez.no/sami/trunk/NS/html/eZ/Publish/Core/FieldType/Image/Value.html#method_fromString"> <code>fromString()</code> </a> method that will, given a path to an image, return an <code>Image\Value</code> object.</p><table class="wysiwyg-macro" data-macro-name="code" data-macro-id="c099cdbd-06d2-4329-b265-be677d863ca7" data-macro-parameters="language=php" data-macro-schema-version="1" style="background-image: url(../servlet/confluence/placeholder/macro-heading1802.png?definition=e2NvZGU6bGFuZ3VhZ2U9cGhwfQ&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="PLAIN_TEXT"><tr><td class="wysiwyg-macro-body"><pre>$value = \eZ\Publish\Core\FieldType\Image\Value::fromString( '/path/to/image.png' );</pre></td></tr></table><p>But as said before, whatever you provide <code>setField()</code> with is sent to the <code>acceptValue()</code> method. This method really is the entry point to the input formats a Field Type accepts. In this case, you could have provided setField with either a hash, similar to the one we provided the Image\Value constructor with, or the path to your image, as a string.</p><table class="wysiwyg-macro" data-macro-name="code" data-macro-id="3f70fd35-4f39-40d3-9178-531f29abf3b4" data-macro-parameters="language=php" data-macro-schema-version="1" style="background-image: url(../servlet/confluence/placeholder/macro-heading1802.png?definition=e2NvZGU6bGFuZ3VhZ2U9cGhwfQ&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="PLAIN_TEXT"><tr><td class="wysiwyg-macro-body"><pre>$contentCreateStruct->setField( 'image', '/path/to/image.png' );
 
// or
 
$contentCreateStruct->setField( 'image', array(
    'path' => '/path/to/image.png',
    'fileSize' => filesize( '/path/to/image.png' ),
    'fileName' => basename( 'image.png' ),
    'alternativeText' => 'My image'
);</pre></td></tr></table><h2>Create Content with XML Text</h2><table class="wysiwyg-macro" data-macro-name="info" data-macro-id="374c64a0-3638-450b-abba-96357e31168a" data-macro-parameters="title=Full code" data-macro-schema-version="1" style="background-image: url(../servlet/confluence/placeholder/macro-headingecc6.png?definition=e2luZm86dGl0bGU9RnVsbCBjb2RlfQ&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="RICH_TEXT"><tr><td class="wysiwyg-macro-body"><p><a href="https://github.com/ezsystems/CookbookBundle/blob/master/Command/CreateXMLContentCommand.php">https://github.com/ezsystems/CookbookBundle/blob/master/Command/CreateXMLContentCommand.php</a></p></td></tr></table><p>Another very commonly used Field Type is the rich text one, <code>XmlText</code>.</p><table class="wysiwyg-macro" data-macro-name="code" data-macro-id="11b4a6d4-193d-4dac-bfb0-5824d7d0e167" data-macro-parameters="language=php|title=working with xml text" data-macro-schema-version="1" style="background-image: url(../servlet/confluence/placeholder/macro-heading5275.png?definition=e2NvZGU6bGFuZ3VhZ2U9cGhwfHRpdGxlPXdvcmtpbmcgd2l0aCB4bWwgdGV4dH0&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="PLAIN_TEXT"><tr><td class="wysiwyg-macro-body"><pre>$xmlText = &lt;&lt;&lt; EOX
&lt;?xml version='1.0' encoding='utf-8'?>
&lt;section>
&lt;paragraph>This is a &lt;strong>image test&lt;/strong>&lt;/paragraph>
&lt;paragraph>&lt;embed view='embed' size='medium' object_id='$imageId'/>&lt;/paragraph>
&lt;/section>
EOX;
$contentCreateStruct->setField( 'body', $xmlText );</pre></td></tr></table><p>As for the last example above, we use the multiple formats accepted by <code>setField()</code>, and provide our XML string as is. The only accepted format as of 5.0 is internal XML, the one stored in the Legacy database.</p><table class="wysiwyg-macro" data-macro-name="info" data-macro-id="e98509f9-2407-47ed-bf21-b0b1ce4dcff7" data-macro-schema-version="1" style="background-image: url(../servlet/confluence/placeholder/macro-headingd35c.png?definition=e2luZm99&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="RICH_TEXT"><tr><td class="wysiwyg-macro-body"><p>The XSD for the internal XML representation can be found in the kernel: <a href="https://github.com/ezsystems/ezpublish-kernel/blob/master/eZ/Publish/Core/FieldType/XmlText/Input/Resources/schemas/ezxml.xsd">https://github.com/ezsystems/ezpublish-kernel/blob/master/eZ/Publish/Core/FieldType/XmlText/Input/Resources/schemas/ezxml.xsd</a>.</p></td></tr></table><p>We embed an image in our XML, using the <code>&lt;embed&gt;</code> tag, providing an image Content ID as the <code>object_id</code> attribute.</p><table class="wysiwyg-macro" data-macro-name="note" data-macro-id="5b1fa3c9-a6ac-4481-b9bf-734e9e4701ed" data-macro-parameters="title=Using a custom format as input" data-macro-schema-version="1" style="background-image: url(../servlet/confluence/placeholder/macro-headinga8c3.png?definition=e25vdGU6dGl0bGU9VXNpbmcgYSBjdXN0b20gZm9ybWF0IGFzIGlucHV0fQ&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="RICH_TEXT"><tr><td class="wysiwyg-macro-body"><p>More input formats will be added later. The API for that is actually already available: you simply need to implement the <a href="http://apidoc.ez.no/sami/trunk/NS/html/eZ/Publish/Core/FieldType/XmlText/Input.html"> <code>XmlText\Input</code> </a> interface. It contains one method, <a href="http://apidoc.ez.no/sami/trunk/NS/html/eZ/Publish/Core/FieldType/XmlText/Input.html#method_getInternalRepresentation"> <code>getInternalRepresentation()</code> </a>, that must return an internal XML string. Create your own bundle, add your implementation to it, and use it in your code!</p><table class="wysiwyg-macro" data-macro-name="code" data-macro-id="335761c3-ab20-442a-9c0e-4570847c3b86" data-macro-parameters="language=php" data-macro-schema-version="1" style="background-image: url(../servlet/confluence/placeholder/macro-heading1802.png?definition=e2NvZGU6bGFuZ3VhZ2U9cGhwfQ&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="PLAIN_TEXT"><tr><td class="wysiwyg-macro-body"><pre>$input = new \My\XmlText\CustomInput( 'My custom format string' );
$contentCreateStruct->setField( 'body', $input );</pre></td></tr></table></td></tr></table><h2>Deleting Content</h2><table class="wysiwyg-macro" data-macro-name="code" data-macro-id="c5d828c2-c942-4743-9ee1-105ed1af9678" data-macro-parameters="language=php" data-macro-schema-version="1" style="background-image: url(../servlet/confluence/placeholder/macro-heading1802.png?definition=e2NvZGU6bGFuZ3VhZ2U9cGhwfQ&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="PLAIN_TEXT"><tr><td class="wysiwyg-macro-body"><pre>$contentService->deleteContent( $contentInfo );</pre></td></tr></table><p><a href="http://apidoc.ez.no/sami/trunk/NS/html/eZ/Publish/API/Repository/ContentService.html#method_deleteContent"> <code>ContentService::deleteContent()</code> </a> method expects a <code>ContentInfo</code> as an argument. It will delete the given Content item, all of its Locations, as well as all of the Content item's Locations' descendants and their associated Content.</p><table class="wysiwyg-macro" data-macro-name="note" data-macro-id="b74b880f-8bc5-486a-9033-daf71f9c4bdd" data-macro-schema-version="1" style="background-image: url(../servlet/confluence/placeholder/macro-headingdd57.png?definition=e25vdGV9&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="RICH_TEXT"><tr><td class="wysiwyg-macro-body">Use with caution!</td></tr></table><p><strong><br /></strong></p></div>
</div>
<div class="cell aside" data-type="aside">
<div class="innerCell">
<h4>In this topic:</h4><p><img class="editor-inline-macro" src="../servlet/confluence/placeholder/macro7c73.png?definition=e3RvYzptYXhMZXZlbD0zfQ&amp;locale=en_GB&amp;version=2" data-macro-name="toc" data-macro-id="3e1b20aa-871e-488c-86b7-d23ec60c6d88" data-macro-parameters="maxLevel=3" data-macro-schema-version="1"></p></div>
</div>
</div>
</div>
        <p>&nbsp;</p>
    </body>

<!-- Mirrored from doc.ez.no/plugins/viewsource/viewpagesrc.action?pageId=31430309 by HTTrack Website Copier/3.x [XR&CO'2013], Tue, 31 Jan 2017 10:18:00 GMT -->
</html>
