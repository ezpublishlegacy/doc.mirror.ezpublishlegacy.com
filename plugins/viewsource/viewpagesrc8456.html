                    
    
                    
    
                    
    
<!DOCTYPE html>
<html>
    
<!-- Mirrored from doc.ez.no/plugins/viewsource/viewpagesrc.action?pageId=31425411 by HTTrack Website Copier/3.x [XR&CO'2013], Tue, 31 Jan 2017 09:51:02 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head>
        <title>View Source</title>
        <link rel="canonical" href="../../pages/viewpage8456.html?pageId=31425411" />
        <script>
window.WRM=window.WRM||{};window.WRM._unparsedData=window.WRM._unparsedData||{};
WRM._unparsedData["com.atlassian.plugins.atlassian-plugins-webresource-rest:web-resource-manager.resource-base-url-pattern"]="\"(?:(?:/s/.*?/_)?/download)\"";
WRM._unparsedData["com.atlassian.plugins.atlassian-plugins-webresource-plugin:context-path.context-path"]="\"\"";
WRM._unparsedData["com.atlassian.plugins.browser.metrics.browser-metrics-plugin:browser-metrics.feature-data-provider-legacy"]="true";
</script>
<link type="text/css" rel="stylesheet" href="../../s/1b9968ac17721e3a6947d14e3a43c3f8-CDN/en_GB/5983/f3e491afc761ac0a6981cfa3dcbc04fc7e88c149.16/89/_/download/superbatch/css/batch9c16.css?build-number=5983" media="all">
<!--[if lt IE 9]>
<link type="text/css" rel="stylesheet" href="/s/d41d8cd98f00b204e9800998ecf8427e-CDN/en_GB/5983/f3e491afc761ac0a6981cfa3dcbc04fc7e88c149.16/89/_/download/superbatch/css/batch.css?conditionalComment=lt+IE+9" media="all">
<![endif]-->
<!--[if lte IE 9]>
<link type="text/css" rel="stylesheet" href="/s/d41d8cd98f00b204e9800998ecf8427e-CDN/en_GB/5983/f3e491afc761ac0a6981cfa3dcbc04fc7e88c149.16/89/_/download/superbatch/css/batch.css?conditionalComment=lte+IE+9" media="all">
<![endif]-->
<link type="text/css" rel="stylesheet" href="../../s/d41d8cd98f00b204e9800998ecf8427e-CDN/en_GB/5983/f3e491afc761ac0a6981cfa3dcbc04fc7e88c149.16/f3685658010e413141854089096800b5/_/download/contextbatch/css/plugin.viewsource/batch.css" media="all">
<link type="text/css" rel="stylesheet" href="../../s/df762e50bc83a9608020a1ff1476cda6-CDN/en_GB/5983/f3e491afc761ac0a6981cfa3dcbc04fc7e88c149.16/5a0f37b8e5a58a48983bc1f25fb099f6/_/download/contextbatch/css/page/batch.css" media="all">
<!--[if lt IE 9]>
<link type="text/css" rel="stylesheet" href="/s/d41d8cd98f00b204e9800998ecf8427e-CDN/en_GB/5983/f3e491afc761ac0a6981cfa3dcbc04fc7e88c149.16/5a0f37b8e5a58a48983bc1f25fb099f6/_/download/contextbatch/css/page/batch.css?conditionalComment=lt+IE+9" media="all">
<![endif]-->
<link type="text/css" rel="stylesheet" href="../../s/5714bd5a5c86641cad10106916cda7c8-CDN/en_GB/5983/f3e491afc761ac0a6981cfa3dcbc04fc7e88c149.16/49f5f7dfc888d48bff618d087d8044cc/_/download/contextbatch/css/editor-content/batch.css" media="all">
<!--[if lte IE 9]>
<link type="text/css" rel="stylesheet" href="/s/d41d8cd98f00b204e9800998ecf8427e-CDN/en_GB/5983/f3e491afc761ac0a6981cfa3dcbc04fc7e88c149.16/49f5f7dfc888d48bff618d087d8044cc/_/download/contextbatch/css/editor-content/batch.css?conditionalComment=lte+IE+9" media="all">
<![endif]-->
<link type="text/css" rel="stylesheet" href="../../s/en_GB/5983/f3e491afc761ac0a6981cfa3dcbc04fc7e88c149.16/8/_/styles/colors82a8.css?spaceKey=TECHDOC" media="all">
<link type="text/css" rel="stylesheet" href="../../s/en_GB/5983/f3e491afc761ac0a6981cfa3dcbc04fc7e88c149.16/8/_/styles/custom82a8.css?spaceKey=TECHDOC" media="all">

    </head>

    <body class="mceContentBody aui-theme-default wiki-content fullsize">
        <p>&nbsp;</p>         <p>Using the internal cache service allows you to use an interface and to not have to care whether the system has been configured to place the cache in Memcached or on File system. And as eZ Platform requires that instances use a cluster-aware cache in Cluster setup, you can safely assume your cache is shared <em>(and invalidated)</em> across all web servers.</p><table class="wysiwyg-macro" data-macro-name="warning" data-macro-id="2a38f2d8-2cd8-4d32-8d8a-14f23b0b24d2" data-macro-parameters="title=Interface will change in the future" data-macro-schema-version="1" style="background-image: url(../servlet/confluence/placeholder/macro-heading3212.png?definition=e3dhcm5pbmc6dGl0bGU9SW50ZXJmYWNlIHdpbGwgY2hhbmdlIGluIHRoZSBmdXR1cmV9&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="RICH_TEXT"><tr><td class="wysiwyg-macro-body"><p>Current implementation uses a caching library called <a class="external-link" href="http://stash.tedivm.com/" rel="nofollow">Stash</a>, via <a class="external-link" href="https://github.com/tedivm/TedivmStashBundle" rel="nofollow">StashBundle</a>. We plan to move to a PSR-6 compatible cache service capable of supporting cache Tagging and multi get/set in the future, when that happens the interface of the cache service will change!</p></td></tr></table><table class="wysiwyg-macro" data-macro-name="note" data-macro-id="487f2fb5-b135-440d-95a8-7b81ad9480e7" data-macro-parameters="title=Use unique vendor prefix for Cache key!" data-macro-schema-version="1" style="background-image: url(../servlet/confluence/placeholder/macro-heading1338.png?definition=e25vdGU6dGl0bGU9VXNlIHVuaXF1ZSB2ZW5kb3IgcHJlZml4IGZvciBDYWNoZSBrZXkhfQ&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="RICH_TEXT"><tr><td class="wysiwyg-macro-body"><p>When reusing the cache service within your own code, it is very important to not conflict with the cache keys used by others. That is why the example of usage below starts with a unique &quot;myApp&quot; key. For the namespace of your own cache, you must do the same! So never clear cache using the cache service without your key specified, otherwise you'll clear all cache.</p></td></tr></table><h2>Get Cache service</h2><h3>Via Dependency injection</h3><p>In your Symfony services configuration you can simply define that you require the &quot;cache&quot; service in your configuration like so:</p><table class="wysiwyg-macro" data-macro-name="code" data-macro-id="86a26b86-99f1-4a5c-81bd-e64dffc81f8d" data-macro-parameters="title=yml configuration" data-macro-schema-version="1" style="background-image: url(../servlet/confluence/placeholder/macro-heading5d0e.png?definition=e2NvZGU6dGl0bGU9eW1sIGNvbmZpZ3VyYXRpb259&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="PLAIN_TEXT"><tr><td class="wysiwyg-macro-body"><pre>    myApp.myService:
        class: %myApp.myService.class%
        arguments:
            - @ezpublish.cache_pool</pre></td></tr></table><p>The &quot;cache&quot; service is an instance of the following class: <code>Tedivm\StashBundle\Service\CacheService</code></p><h3>Via Symfony Container</h3><p>Like any other service, it is also possible to get the &quot;cache&quot; service via container like so:</p><table class="wysiwyg-macro" data-macro-name="code" data-macro-id="83a9d69e-e983-46ab-b533-b792f44c3794" data-macro-parameters="language=php|title=Getting the cache service in PHP" data-macro-schema-version="1" style="background-image: url(../servlet/confluence/placeholder/macro-heading01dc.png?definition=e2NvZGU6bGFuZ3VhZ2U9cGhwfHRpdGxlPUdldHRpbmcgdGhlIGNhY2hlIHNlcnZpY2UgaW4gUEhQfQ&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="PLAIN_TEXT"><tr><td class="wysiwyg-macro-body"><pre>/** @var $cacheService \Tedivm\StashBundle\Service\CacheService */
$cacheService = $container->get('ezpublish.cache_pool');</pre></td></tr></table><h2>Using the cache service</h2><p>Example usage of the cache service:</p><table class="wysiwyg-macro" data-macro-name="code" data-macro-id="19d00d26-4117-494d-aed7-82109e86aea8" data-macro-parameters="language=php|title=Example" data-macro-schema-version="1" style="background-image: url(../servlet/confluence/placeholder/macro-headingc9ae.png?definition=e2NvZGU6bGFuZ3VhZ2U9cGhwfHRpdGxlPUV4YW1wbGV9&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="PLAIN_TEXT"><tr><td class="wysiwyg-macro-body"><pre>    $cacheItem = $cacheService->getItem('myApp', 'object', $id);
    $myObject = $cacheItem->get();
    if ($cacheItem->isMiss()) {
        $myObject = $container->get('my_app.backend_service')->loadObject($id)
        $cacheItem->set($myObject);
    }
    return $myObject;</pre></td></tr></table><p>For more info on usage, take a look at <a href="http://stash.tedivm.com/">Stash's documentation</a>.</p><h2>Clearing Persistence cache</h2><p>Persistence cache uses a separate Cache Pool decorator which by design prefixes cache keys with &quot;<span style="color: rgb(0,128,0);">ez_spi</span>&quot;. Clearing persistence cache can thus be done in the following way:</p><table class="wysiwyg-macro" data-macro-name="code" data-macro-id="92444ede-e36b-47d9-9470-f1f9b7f6170d" data-macro-parameters="language=php|title=getting the cache service in php" data-macro-schema-version="1" style="background-image: url(../servlet/confluence/placeholder/macro-headingb6d4.png?definition=e2NvZGU6bGFuZ3VhZ2U9cGhwfHRpdGxlPWdldHRpbmcgdGhlIGNhY2hlIHNlcnZpY2UgaW4gcGhwfQ&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="PLAIN_TEXT"><tr><td class="wysiwyg-macro-body"><pre>/** @var $cacheService \eZ\Publish\Core\Persistence\Cache\CacheServiceDecorator */
$cacheService = $container->get('ezpublish.cache_pool.spi.cache.decorator');
 
// To clear all cache
$cacheService->clear();
 
// To clear a specific cache item (check source code in eZ\Publish\Core\Persistence\Cache\*Handlers for further info)
$cacheService->clear('content', 'info', $contentId);

// Stash cache is hierarchical, so you can clear all content/info cache like so:
$cacheService->clear('content', 'info');</pre></td></tr></table><p> </p><p> </p>
        <p>&nbsp;</p>
    </body>

<!-- Mirrored from doc.ez.no/plugins/viewsource/viewpagesrc.action?pageId=31425411 by HTTrack Website Copier/3.x [XR&CO'2013], Tue, 31 Jan 2017 09:51:03 GMT -->
</html>
