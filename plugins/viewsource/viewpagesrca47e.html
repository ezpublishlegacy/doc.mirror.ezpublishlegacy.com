                    
    
                    
    
                    
    
<!DOCTYPE html>
<html>
    
<!-- Mirrored from doc.ez.no/plugins/viewsource/viewpagesrc.action?pageId=32114318 by HTTrack Website Copier/3.x [XR&CO'2013], Wed, 01 Feb 2017 06:07:39 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head>
        <title>View Source</title>
        <link rel="canonical" href="../../pages/viewpagea47e.html?pageId=32114318" />
        <script>
window.WRM=window.WRM||{};window.WRM._unparsedData=window.WRM._unparsedData||{};
WRM._unparsedData["com.atlassian.plugins.atlassian-plugins-webresource-rest:web-resource-manager.resource-base-url-pattern"]="\"(?:(?:/s/.*?/_)?/download)\"";
WRM._unparsedData["com.atlassian.plugins.atlassian-plugins-webresource-plugin:context-path.context-path"]="\"\"";
WRM._unparsedData["com.atlassian.plugins.browser.metrics.browser-metrics-plugin:browser-metrics.feature-data-provider-legacy"]="true";
</script>
<link type="text/css" rel="stylesheet" href="../../s/1b9968ac17721e3a6947d14e3a43c3f8-CDN/en_GB/5983/f3e491afc761ac0a6981cfa3dcbc04fc7e88c149.16/89/_/download/superbatch/css/batch9c16.css?build-number=5983" media="all">
<!--[if lt IE 9]>
<link type="text/css" rel="stylesheet" href="/s/d41d8cd98f00b204e9800998ecf8427e-CDN/en_GB/5983/f3e491afc761ac0a6981cfa3dcbc04fc7e88c149.16/89/_/download/superbatch/css/batch.css?conditionalComment=lt+IE+9" media="all">
<![endif]-->
<!--[if lte IE 9]>
<link type="text/css" rel="stylesheet" href="/s/d41d8cd98f00b204e9800998ecf8427e-CDN/en_GB/5983/f3e491afc761ac0a6981cfa3dcbc04fc7e88c149.16/89/_/download/superbatch/css/batch.css?conditionalComment=lte+IE+9" media="all">
<![endif]-->
<link type="text/css" rel="stylesheet" href="../../s/d41d8cd98f00b204e9800998ecf8427e-CDN/en_GB/5983/f3e491afc761ac0a6981cfa3dcbc04fc7e88c149.16/f3685658010e413141854089096800b5/_/download/contextbatch/css/plugin.viewsource/batch.css" media="all">
<link type="text/css" rel="stylesheet" href="../../s/df762e50bc83a9608020a1ff1476cda6-CDN/en_GB/5983/f3e491afc761ac0a6981cfa3dcbc04fc7e88c149.16/5a0f37b8e5a58a48983bc1f25fb099f6/_/download/contextbatch/css/page/batch.css" media="all">
<!--[if lt IE 9]>
<link type="text/css" rel="stylesheet" href="/s/d41d8cd98f00b204e9800998ecf8427e-CDN/en_GB/5983/f3e491afc761ac0a6981cfa3dcbc04fc7e88c149.16/5a0f37b8e5a58a48983bc1f25fb099f6/_/download/contextbatch/css/page/batch.css?conditionalComment=lt+IE+9" media="all">
<![endif]-->
<link type="text/css" rel="stylesheet" href="../../s/5714bd5a5c86641cad10106916cda7c8-CDN/en_GB/5983/f3e491afc761ac0a6981cfa3dcbc04fc7e88c149.16/49f5f7dfc888d48bff618d087d8044cc/_/download/contextbatch/css/editor-content/batch.css" media="all">
<!--[if lte IE 9]>
<link type="text/css" rel="stylesheet" href="/s/d41d8cd98f00b204e9800998ecf8427e-CDN/en_GB/5983/f3e491afc761ac0a6981cfa3dcbc04fc7e88c149.16/49f5f7dfc888d48bff618d087d8044cc/_/download/contextbatch/css/editor-content/batch.css?conditionalComment=lte+IE+9" media="all">
<![endif]-->
<link type="text/css" rel="stylesheet" href="../../s/en_GB/5983/f3e491afc761ac0a6981cfa3dcbc04fc7e88c149.16/16/_/styles/colors.css" media="all">

    </head>

    <body class="mceContentBody aui-theme-default wiki-content fullsize">
        <p>&nbsp;</p>         <div class="contentLayout2">
<div class="columnLayout two-right-sidebar" data-layout="two-right-sidebar">
<div class="cell normal" data-type="normal">
<div class="innerCell">
<p>We will begin by customizing the global layout of our site, in order to end up with this rendering:</p><p><strong> <img class="confluence-embedded-image image-center" width="600" src="../../download/attachments/31428488/index_final7cf8.png?version=1&amp;modificationDate=1458915346000&amp;api=v2" data-image-src="/download/attachments/31428488/index_final.png?version=1&amp;modificationDate=1458915346000&amp;api=v2" data-unresolved-comment-count="0" data-linked-resource-id="31428487" data-linked-resource-version="1" data-linked-resource-type="attachment" data-linked-resource-default-alias="index_final.png" data-base-url="https://doc.ez.no" data-linked-resource-content-type="image/png" data-linked-resource-container-id="31428488" data-linked-resource-container-version="46" title="Developer > Step 3 - Customizing the general layout > index_final.png" data-location="Developer > Step 3 - Customizing the general layout > index_final.png" data-image-height="1389" data-image-width="1585"> <br /> </strong></p><p><strong> <br /> </strong></p><p><img class="editor-inline-macro" src="../servlet/confluence/placeholder/macroa4f0.png?definition=e3RvYzptYXhMZXZlbD0zfG91dGxpbmU9dHJ1ZX0&amp;locale=en_GB&amp;version=2" data-macro-name="toc" data-macro-id="36dfbc0d-7043-4ce0-b457-a286327cbc98" data-macro-parameters="maxLevel=3|outline=true" data-macro-schema-version="1"></p><p>First, go to the root of your eZ Platform site. You should see the root folder of the clean install, without any kind of layout. You can go to <code>/ez</code>, edit this Content item and see that this page changes. When <code>/</code> is requested, eZ Platform renders the root content using the <code>ez_content:viewContent</code> controller. We will customize this step by instructing Platform to use a custom template to render this particular item.</p><blockquote><p>eZ Platform organizes content as a tree. Each Content item is referenced by a Location, and each Location as a parent. The root content Location has the ID <code>2</code> by default.</p></blockquote><h2>Content rendering configuration</h2><p>To use a custom template when rendering the root content, let's create a <code>content_view</code> configuration block for <code>ezpublish</code>.</p><p>We will use the <code>default</code> namespace, but we could have used any siteaccess instead. Edit <code>app/config/ezplatform.yml</code>. At the end, add the following block, right after the language configuration (pay attention to indentation: <code>default</code> should be at the same level as <code>site_group</code>):</p><table class="wysiwyg-macro" data-macro-name="code" data-macro-id="3f851fba-ef5f-4ef6-bf98-7eab20cab9e7" data-macro-parameters="language=groovy|title=ezplatform.yml" data-macro-schema-version="1" style="background-image: url(../servlet/confluence/placeholder/macro-headingad1e.png?definition=e2NvZGU6bGFuZ3VhZ2U9Z3Jvb3Z5fHRpdGxlPWV6cGxhdGZvcm0ueW1sfQ&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="PLAIN_TEXT"><tr><td class="wysiwyg-macro-body"><pre>    system:
    #existing directives: don't touch them    
        default: #same level as site_group directive
		    content_view:
		        full:
			        root_folder:
			            template: "full/root_folder.html.twig"
			            match:
				            Id\Location: 2</pre></td></tr></table><p>This tells Platform to use the <code>template</code> when rendering any content referenced by the Location with the id <code>2</code>. There is a whole set of <a class="confluence-link" href="../../display/DEVELOPER/Content%2bRendering.html#ContentRendering-Viewproviderconfiguration" data-anchor="Viewproviderconfiguration" data-linked-resource-id="31429679" data-linked-resource-version="70" data-linked-resource-type="page" data-linked-resource-default-alias="Content Rendering#Viewproviderconfiguration" data-base-url="../../index.html">view matchers</a> that can be used to customize rendering depending on any criterion.</p><h2>Creating the template</h2><ol><li><a class="button-panel-button" href="https://github.com/bdunogier/platform-workshop/blob/master/src/Workshop/TutorialBundle/Resources/public/index.html">Download index.html</a></li><li>Save it in <code>app/Resources/views</code> as <code>
          <code>app/Resources/views/</code>full/root_folder.html.twig</code>.</li><li>Refresh the site's root and you should see the site's structure, but without any styles or images. Let's fix this.</li><li>Edit the <code>root_folder.html.twig</code> template.</li></ol><h2>Fixing the assets</h2><ol><li>The first thing to do is to fix the loading of stylesheets, scripts and design images.</li><li><a class="aui-button" href="https://github.com/ezsystems/ezsc2015-beginner-tutorial/blob/master/assets.zip">Download assets.zip</a> by clicking on the &quot;Raw&quot; button on Github.</li><li>Then unpack its contents to the <code>web</code> directory of your project. You will end up with <code>web/assets/</code>, containing <code>css</code>, <code>js</code> and <code>images</code> subfolders.</li><li>In the template, in the<code> &lt;html&gt;</code> section, replace the <code>&lt;style&gt;</code> tags about bootstrap and custom CSS lines  (lines 15 to 21) with the following code:</li></ol><table class="wysiwyg-macro" data-macro-name="code" data-macro-id="e6b34dab-17b3-4fe4-8578-ad3e32a5e35b" data-macro-parameters="language=xml|title=root_folder.html.twig" data-macro-schema-version="1" style="background-image: url(../servlet/confluence/placeholder/macro-heading860c.png?definition=e2NvZGU6bGFuZ3VhZ2U9eG1sfHRpdGxlPXJvb3RfZm9sZGVyLmh0bWwudHdpZ30&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="PLAIN_TEXT"><tr><td class="wysiwyg-macro-body"><pre>{% stylesheets 'assets/css/*' filter='cssrewrite' %}
    &lt;link rel="stylesheet" href="{{ asset_url }}" />
{% endstylesheets %}</pre></td></tr></table><p>As explained in the <a href="http://symfony.com/doc/current/cookbook/assetic/asset_management.html#including-css-stylesheets">Symfony assetic doc</a>, this will iterate over the files in <code>web/assets/css</code> and load them as stylesheets.<br />Refresh the page and you should now see the static design of the site !</p><p>At the bottom of the template, you will find <code>&lt;script&gt;</code> tags that load jQuery and Bootstrap javascript (around line 360). Replace them with an equivalent block for scripts:</p><table class="wysiwyg-macro" data-macro-name="code" data-macro-id="5e5a317c-7ca9-4e56-b44e-1f06fcde4eaa" data-macro-parameters="language=xml|title=root_folder.html.twig" data-macro-schema-version="1" style="background-image: url(../servlet/confluence/placeholder/macro-heading860c.png?definition=e2NvZGU6bGFuZ3VhZ2U9eG1sfHRpdGxlPXJvb3RfZm9sZGVyLmh0bWwudHdpZ30&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="PLAIN_TEXT"><tr><td class="wysiwyg-macro-body"><pre>{% javascripts 'assets/js/*' %}
    &lt;script src="{{ asset_url }}">&lt;/script>
{% endjavascripts %}</pre></td></tr></table><p>Let's finish this by fixing the design images. Locate the <code>&lt;img&gt;</code> tag with <code>&quot;images/128_bike_white_avenir.png&quot;</code>. Change the <code>src</code> to <code>{{ asset('assets/images/128_bike_white_avenir.png') }}</code>:</p><table class="wysiwyg-macro" data-macro-name="code" data-macro-id="3a2e158f-7730-4277-bda4-4eb617431b15" data-macro-parameters="language=xml|title=root_folder.html.twig" data-macro-schema-version="1" style="background-image: url(../servlet/confluence/placeholder/macro-heading860c.png?definition=e2NvZGU6bGFuZ3VhZ2U9eG1sfHRpdGxlPXJvb3RfZm9sZGVyLmh0bWwudHdpZ30&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="PLAIN_TEXT"><tr><td class="wysiwyg-macro-body"><pre>&lt;img alt="Brand" src="{{ asset('assets/images/128_bike_white_avenir.png') }}"></pre></td></tr></table><p>Do the same for <code>&quot;images/logo_just_letters.png&quot;</code> and refresh the page. The design should now be in order, with the logo, fonts and colors as the first image of this page.</p><h2>Rendering the content</h2><p>At this point, the <code>root_folder.html.twig</code> template is static. It doesn't render any dynamic data from the repository.</p><p>The root is rendered by the <code>ez_content:viewAction</code> controller action. This action assigns the currently viewed content as the <code>content</code> Twig variable. We will use that variable to display some of the fields from the root content. Replace the central section of the template, around line 90, with the following block:</p><table class="wysiwyg-macro" data-macro-name="code" data-macro-id="6985ffc5-c634-459c-aa77-6e5046a86c8d" data-macro-parameters="language=xml|title=root_folder.html.twig" data-macro-schema-version="1" style="background-image: url(../servlet/confluence/placeholder/macro-heading860c.png?definition=e2NvZGU6bGFuZ3VhZ2U9eG1sfHRpdGxlPXJvb3RfZm9sZGVyLmh0bWwudHdpZ30&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="PLAIN_TEXT"><tr><td class="wysiwyg-macro-body"><pre>&lt;section class="buttons">
    &lt;div class="container">
        &lt;div class="row regular-content-size">
            &lt;div class="col-xs-10 col-xs-offset-1 box-style">
                &lt;h3 class="center bottom-plus new-header">{{ ez_content_name(content) }}&lt;/h3>
                &lt;div class="col-xs-10 text-justified">{{ ez_render_field(content, 'description') }}&lt;/div>
            &lt;/div>
        &lt;/div>
    &lt;/div>
&lt;/section></pre></td></tr></table><p>The page will now show the values of title and description fields of the root Platform Content.</p><h2>Extracting the layout</h2><p>The general layout of the site, with the navigation, footer, scripts, etc., is written down in the template we use to render the root. Let's extract the part that is common to all the pages so that we can re-use it.</p><p>Twig supports a powerful <a href="http://twig.sensiolabs.org/doc/templates.html#template-inheritance">template inheritance</a> API. Templates may declare named blocks. Any template may extend other templates, and modify the blocks defined by its parents.</p><p>Create a new <code>app/Resources/views/pagelayout.html.twig</code> template and copy the contents of the current <code>root_folder.html.twig</code> into it. Change the central section from the previous chapter as follows:</p><table class="wysiwyg-macro" data-macro-name="code" data-macro-id="d95469ba-47fa-4a74-a4e1-99a769a4ab58" data-macro-parameters="language=xml|title=pagelayout.html.twig" data-macro-schema-version="1" style="background-image: url(../servlet/confluence/placeholder/macro-heading53ff.png?definition=e2NvZGU6bGFuZ3VhZ2U9eG1sfHRpdGxlPXBhZ2VsYXlvdXQuaHRtbC50d2lnfQ&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="PLAIN_TEXT"><tr><td class="wysiwyg-macro-body"><pre>&lt;section class="buttons">
    &lt;div class="container">
        &lt;div class="row regular-content-size">
            &lt;div class="col-xs-10 col-xs-offset-1 box-style">
                {% block content %}
                {% endblock %}
            &lt;/div>
        &lt;/div>
    &lt;/div>
&lt;/section></pre></td></tr></table><p>This defines a block named &quot;content&quot;. Other templates can add content to it, so that the result of the execution of the controller is contained within the site's general layout.</p><p>Edit <code>root_folder.html.twig</code> and replace the whole content of the file with the following code:</p><table class="wysiwyg-macro" data-macro-name="code" data-macro-id="5a1ea649-8d60-42bc-a684-c7e0126e65cc" data-macro-parameters="language=xml|title=root_folder.html.twig" data-macro-schema-version="1" style="background-image: url(../servlet/confluence/placeholder/macro-heading860c.png?definition=e2NvZGU6bGFuZ3VhZ2U9eG1sfHRpdGxlPXJvb3RfZm9sZGVyLmh0bWwudHdpZ30&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="PLAIN_TEXT"><tr><td class="wysiwyg-macro-body"><pre>{% extends "pagelayout.html.twig" %}
{% block content %}
&lt;h3 class="center bottom-plus new-header">{{ ez_content_name(content) }}&lt;/h3>
&lt;div class="col-xs-10 text-justified">{{ ez_render_field(content, 'description') }}&lt;/div>
{% endblock %}</pre></td></tr></table><p>This will re-use <code>pagelayout.html.twig</code> and replace the <code>content</code> block with the title and description from the root folder. We could easily create more blocks in the pagelayout so that templates can modify other parts of the page (footer, head, navigation), and we will over the course of this tutorial. We can now create more templates that inherit from <code>pagelayout.html.twig</code>, and customize how content is rendered.</p><p>Let's do it for the Ride Content Type.</p><p> </p><p> </p><table class="wysiwyg-macro" data-macro-name="section" data-macro-id="41e7e605-9582-4936-9388-61fecf064cd3" data-macro-schema-version="1" style="background-image: url(../servlet/confluence/placeholder/macro-heading83a9.png?definition=e3NlY3Rpb259&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="RICH_TEXT"><tr><td class="wysiwyg-macro-body"><table class="wysiwyg-macro" data-macro-name="column" data-macro-id="c5ff3b80-996f-47b3-9944-9ce7cabcabc5" data-macro-parameters="width=50%" data-macro-schema-version="1" style="background-image: url(../servlet/confluence/placeholder/macro-heading99b3.png?definition=e2NvbHVtbjp3aWR0aD01MCV9&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="RICH_TEXT"><tr><td class="wysiwyg-macro-body"><p><span class="char" title="Left Right White Arrow"> </span> <span class="char" title="Leftwards Black Arrow">⬅</span> Previous: <a class="confluence-link" href="../../display/DEVELOPER/Step%2b1%2b-%2bGetting%2bReady.html" data-linked-resource-id="31431834" data-linked-resource-version="17" data-linked-resource-type="page" data-linked-resource-default-alias="Step 1 - Getting Ready" data-base-url="../../index.html">Step 1 - Getting Ready</a></p></td></tr></table><table class="wysiwyg-macro" data-macro-name="column" data-macro-id="686b47a9-2bc8-4417-8e6a-1f42ad62e5da" data-macro-schema-version="1" style="background-image: url(../servlet/confluence/placeholder/macro-heading16cd.png?definition=e2NvbHVtbn0&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="RICH_TEXT"><tr><td class="wysiwyg-macro-body"><p style="text-align: right;"><span class="confluence-link" title="Black Rightwards Arrow"> Next: <a class="confluence-link unresolved" data-content-title="Step 3 - Create your content model" data-linked-resource-default-alias="Step 3 - Create your content model" href="#">Step 3 - Create your content model</a> ➡</span><span class="char" title="Black Rightwards Arrow"> <br /></span></p></td></tr></table></td></tr></table><p><br /><span class="char" title="Black Rightwards Arrow"> </span></p><p> </p></div>
</div>
<div class="cell aside" data-type="aside">
<div class="innerCell">
<table class="wysiwyg-macro" data-macro-name="panel" data-macro-id="d8c77d99-57aa-4735-a392-c4f56fe8f2c9" data-macro-parameters="borderColor=#f58220|borderWidth=2|title=Tutorial path" data-macro-schema-version="1" style="background-image: url(../servlet/confluence/placeholder/macro-headingc82d-2.png?definition=e3BhbmVsOmJvcmRlckNvbG9yPSNmNTgyMjB8Ym9yZGVyV2lkdGg9Mnx0aXRsZT1UdXRvcmlhbCBwYXRofQ&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="RICH_TEXT"><tr><td class="wysiwyg-macro-body"><p><img class="editor-inline-macro" src="../servlet/confluence/placeholder/macroc62c.png?definition=e3BhZ2V0cmVlOnJvb3Q9QnVpbGRpbmcgYSBCaWN5Y2xlIFJvdXRlIFRyYWNrZXIgaW4gZVogUGxhdGZvcm19&amp;locale=en_GB&amp;version=2" data-macro-name="pagetree" data-macro-id="596105a7-4fd9-4e5b-8f3a-dc3600876fb6" data-macro-parameters="root=Building a Bicycle Route Tracker in eZ Platform" data-macro-schema-version="1"></p></td></tr></table></div>
</div>
</div>
</div>
        <p>&nbsp;</p>
    </body>

<!-- Mirrored from doc.ez.no/plugins/viewsource/viewpagesrc.action?pageId=32114318 by HTTrack Website Copier/3.x [XR&CO'2013], Wed, 01 Feb 2017 06:07:39 GMT -->
</html>
