                    
    
                    
    
                    
    
<!DOCTYPE html>
<html>
    
<!-- Mirrored from doc.ez.no/plugins/viewsource/viewpagesrc.action?pageId=30712516 by HTTrack Website Copier/3.x [XR&CO'2013], Tue, 31 Jan 2017 10:02:09 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head>
        <title>View Source</title>
        <link rel="canonical" href="../../pages/viewpage4c44.html?pageId=30712516" />
        <script>
window.WRM=window.WRM||{};window.WRM._unparsedData=window.WRM._unparsedData||{};
WRM._unparsedData["com.atlassian.plugins.atlassian-plugins-webresource-rest:web-resource-manager.resource-base-url-pattern"]="\"(?:(?:/s/.*?/_)?/download)\"";
WRM._unparsedData["com.atlassian.plugins.atlassian-plugins-webresource-plugin:context-path.context-path"]="\"\"";
WRM._unparsedData["com.atlassian.plugins.browser.metrics.browser-metrics-plugin:browser-metrics.feature-data-provider-legacy"]="true";
</script>
<link type="text/css" rel="stylesheet" href="../../s/1b9968ac17721e3a6947d14e3a43c3f8-CDN/en_GB/5983/f3e491afc761ac0a6981cfa3dcbc04fc7e88c149.16/89/_/download/superbatch/css/batch9c16.css?build-number=5983" media="all">
<!--[if lt IE 9]>
<link type="text/css" rel="stylesheet" href="/s/d41d8cd98f00b204e9800998ecf8427e-CDN/en_GB/5983/f3e491afc761ac0a6981cfa3dcbc04fc7e88c149.16/89/_/download/superbatch/css/batch.css?conditionalComment=lt+IE+9" media="all">
<![endif]-->
<!--[if lte IE 9]>
<link type="text/css" rel="stylesheet" href="/s/d41d8cd98f00b204e9800998ecf8427e-CDN/en_GB/5983/f3e491afc761ac0a6981cfa3dcbc04fc7e88c149.16/89/_/download/superbatch/css/batch.css?conditionalComment=lte+IE+9" media="all">
<![endif]-->
<link type="text/css" rel="stylesheet" href="../../s/d41d8cd98f00b204e9800998ecf8427e-CDN/en_GB/5983/f3e491afc761ac0a6981cfa3dcbc04fc7e88c149.16/f3685658010e413141854089096800b5/_/download/contextbatch/css/plugin.viewsource/batch.css" media="all">
<link type="text/css" rel="stylesheet" href="../../s/df762e50bc83a9608020a1ff1476cda6-CDN/en_GB/5983/f3e491afc761ac0a6981cfa3dcbc04fc7e88c149.16/5a0f37b8e5a58a48983bc1f25fb099f6/_/download/contextbatch/css/page/batch.css" media="all">
<!--[if lt IE 9]>
<link type="text/css" rel="stylesheet" href="/s/d41d8cd98f00b204e9800998ecf8427e-CDN/en_GB/5983/f3e491afc761ac0a6981cfa3dcbc04fc7e88c149.16/5a0f37b8e5a58a48983bc1f25fb099f6/_/download/contextbatch/css/page/batch.css?conditionalComment=lt+IE+9" media="all">
<![endif]-->
<link type="text/css" rel="stylesheet" href="../../s/5714bd5a5c86641cad10106916cda7c8-CDN/en_GB/5983/f3e491afc761ac0a6981cfa3dcbc04fc7e88c149.16/49f5f7dfc888d48bff618d087d8044cc/_/download/contextbatch/css/editor-content/batch.css" media="all">
<!--[if lte IE 9]>
<link type="text/css" rel="stylesheet" href="/s/d41d8cd98f00b204e9800998ecf8427e-CDN/en_GB/5983/f3e491afc761ac0a6981cfa3dcbc04fc7e88c149.16/49f5f7dfc888d48bff618d087d8044cc/_/download/contextbatch/css/editor-content/batch.css?conditionalComment=lte+IE+9" media="all">
<![endif]-->
<link type="text/css" rel="stylesheet" href="../../s/en_GB/5983/f3e491afc761ac0a6981cfa3dcbc04fc7e88c149.16/8/_/styles/colors82a8.css?spaceKey=TECHDOC" media="all">
<link type="text/css" rel="stylesheet" href="../../s/en_GB/5983/f3e491afc761ac0a6981cfa3dcbc04fc7e88c149.16/8/_/styles/custom82a8.css?spaceKey=TECHDOC" media="all">

    </head>

    <body class="mceContentBody aui-theme-default wiki-content fullsize">
        <p>&nbsp;</p>         <p><img class="editor-inline-macro" src="../servlet/confluence/placeholder/macro4170.png?definition=e3RvY30&amp;locale=en_GB&amp;version=2" data-macro-name="toc" data-macro-id="ef3e279b-7614-45a8-b661-50a2619571e6" data-macro-schema-version="1"></p><h2>Views in PlatformUI</h2><p>Each route defines a View to render when the route is matched. As explained in <a href="../../display/TECHDOC/Backend%2binterface.html#Backendinterface-Views:mainview,sub-view,side-view">the PlatformUI technical introduction</a>, this kind of view is called a<strong> Main View</strong>. Like any view, it can have an arbitrary number of sub-views.</p><table class="wysiwyg-macro" data-macro-name="info" data-macro-id="c4d79ac5-2e50-46de-97f7-f1b8b70c17b0" data-macro-schema-version="1" style="background-image: url(../servlet/confluence/placeholder/macro-headingd35c.png?definition=e2luZm99&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="RICH_TEXT"><tr><td class="wysiwyg-macro-body"><p><strong>Good practice:</strong> keep the views small and do not hesitate to create sub-views. This eases the maintenance and allows you to reuse the small sub-views in different context.</p></td></tr></table><p>A View is responsible for generating the User Interface and handling the user input (click, keyboard, drag and drop, etc.). In its lifecycle, a view first receives a set of parameters, then it is rendered and added to DOM.</p><table class="wysiwyg-macro" data-macro-name="info" data-macro-id="28cac2b0-5886-4808-84c6-44dad285a3a3" data-macro-schema-version="1" style="background-image: url(../servlet/confluence/placeholder/macro-headingd35c.png?definition=e2luZm99&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="RICH_TEXT"><tr><td class="wysiwyg-macro-body"><p>PlatformUI reuses <a href="http://yuilibrary.com/yui/docs/view/#views-models-and-addtarget">the YUI View system</a>. <code>Y.View</code> is designed to be a very simple component. PlatformUI extends this concept to have views with more features like templates or asynchronous behavior.</p></td></tr></table><h2>Creating and using a custom Main View</h2><h3>Creating a new View</h3><p>As for the plugin in the previous step, the first thing to do is to declare a new module in the extension bundle <code>yui.yml</code> file:</p><table class="wysiwyg-macro" data-macro-name="code" data-macro-id="8a94e6dc-eb2f-4b3c-ab2a-43e5525d6dd6" data-macro-parameters="language=text|theme=Midnight|title=New module in yui.yml" data-macro-schema-version="1" style="background-image: url(../servlet/confluence/placeholder/macro-headingdde4.png?definition=e2NvZGU6bGFuZ3VhZ2U9dGV4dHx0aGVtZT1NaWRuaWdodHx0aXRsZT1OZXcgbW9kdWxlIGluIHl1aS55bWx9&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="PLAIN_TEXT"><tr><td class="wysiwyg-macro-body"><pre>ezconf-listview:
    requires: ['ez-view']
    path: %extending_platformui.public_dir%/js/views/ezconf-listview.js</pre></td></tr></table><p>Our basic view will extend the PlatformUI basic view which is available in the <code>ez-view</code> module. As a result, <code>ez-view</code> has to be added in the module requirements.</p><p>Then we have to create the corresponding module file. In this file, we'll create a new View component by extending <code>Y.eZ.View</code> provided by <code>ez-view</code>.</p><table class="wysiwyg-macro" data-macro-name="code" data-macro-id="74d538db-a9c3-44e6-ae70-7cbc17696456" data-macro-parameters="language=js|theme=Midnight|title=%extending_platformui.public_dir%/js/views/ezconf-listview.js" data-macro-schema-version="1" style="background-image: url(../servlet/confluence/placeholder/macro-heading013f.png?definition=e2NvZGU6bGFuZ3VhZ2U9anN8dGhlbWU9TWlkbmlnaHR8dGl0bGU9JWV4dGVuZGluZ19wbGF0Zm9ybXVpLnB1YmxpY19kaXIlL2pzL3ZpZXdzL2V6Y29uZi1saXN0dmlldy5qc30&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="PLAIN_TEXT"><tr><td class="wysiwyg-macro-body"><pre>YUI.add('ezconf-listview', function (Y) {
    Y.namespace('eZConf');

    Y.eZConf.ListView = Y.Base.create('ezconfListView', Y.eZ.View, [], {
        initializer: function () {
            console.log("Hey, I'm the list view");
        },

        render: function () {
            // this.get('container') is an auto generated &lt;div>
            // here, it's not yet in the DOM of the page and it will be added
            // after the execution of render().
            this.get('container').setContent(
                "Hey, I'm the listView and I was rendered it seems"
            );
            this.get('container').setStyles({
                background: '#fff',
                fontSize: '200%',
            });
            return this;
        },
    });
});
</pre></td></tr></table><p>This code creates the <code>Y.eZConf.ListView</code> by extending <code>Y.eZ.View</code>. The newly created view component has a custom <code>render</code> method. As its name suggests, this method is called when the view needs to be rendered. For now, we are directly manipulating the DOM. <code>this.get('container')</code> in a View allows you to retrieve the container DOM node, it's actually <a href="http://yuilibrary.com/yui/docs/node/">a Y.Node instance</a> that is automatically created and added to the page when the View is needed in the application.</p><table class="wysiwyg-macro" data-macro-name="info" data-macro-id="a9335214-206b-4f18-8fa3-2e98c4c7d8c8" data-macro-schema-version="1" style="background-image: url(../servlet/confluence/placeholder/macro-headingd35c.png?definition=e2luZm99&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="RICH_TEXT"><tr><td class="wysiwyg-macro-body"><p>A View is responsible for handling only what happens in its own container. While it's technically possible, it is a very bad practice for a View to handle anything that is outside its own container.</p></td></tr></table><p>At this point, if you open/refresh PlatformUI in your browser, nothing will have really changed, because the newly added View is not used anywhere yet.</p><h3>Using it as a Main View</h3><p>Now that we have a View, it's time to change the route configuration added in the previous step so that our custom route uses it. To do that, we'll have to change the application plugin to register the new view as a main view in the application and then to define the custom route with that view. Since we want to use the new view in the plugin, the <code>ezconf-listview</code> module becomes a dependency of the plugin module. The plugin module declaration becomes:</p><table class="wysiwyg-macro" data-macro-name="code" data-macro-id="da70057e-3358-4d83-9aa1-4b40d60c6a8b" data-macro-parameters="theme=Midnight" data-macro-schema-version="1" style="background-image: url(../servlet/confluence/placeholder/macro-heading86ef.png?definition=e2NvZGU6dGhlbWU9TWlkbmlnaHR9&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="PLAIN_TEXT"><tr><td class="wysiwyg-macro-body"><pre>ezconf-listapplugin:
    requires: ['ez-pluginregistry', 'plugin', 'base', 'ezconf-listview'] # we've added 'ezconf-listview'
    dependencyOf: ['ez-platformuiapp']
    path: %extending_platformui.public_dir%/js/apps/plugins/ezconf-listappplugin.js</pre></td></tr></table><p>Then in the plugin, <code>Y.eZConf.ListView</code> becomes available; we can register it as a potential main view and change the route to use it:</p><table class="wysiwyg-macro" data-macro-name="code" data-macro-id="7170354f-0724-4480-9e48-c10199382419" data-macro-parameters="language=js|theme=Midnight|title=ezconf-listappplugin.js" data-macro-schema-version="1" style="background-image: url(../servlet/confluence/placeholder/macro-heading1ee9.png?definition=e2NvZGU6bGFuZ3VhZ2U9anN8dGhlbWU9TWlkbmlnaHR8dGl0bGU9ZXpjb25mLWxpc3RhcHBwbHVnaW4uanN9&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="PLAIN_TEXT"><tr><td class="wysiwyg-macro-body"><pre>YUI.add('ezconf-listapplugin', function (Y) {
    Y.namespace('eZConf.Plugin');

    Y.eZConf.Plugin.ListAppPlugin = Y.Base.create('ezconfListAppPlugin', Y.Plugin.Base, [], {
        initializer: function () {
            var app = this.get('host'); // the plugged object is called host

            console.log("Hey, I'm a plugin for PlatformUI App!");
            console.log("And I'm plugged in ", app);

            console.log('Registering the ezconfListView in the app');
            app.views.ezconfListView = {
                type: Y.eZConf.ListView,
            };

            console.log("Let's add a route");
            app.route({
                name: "eZConfList",
                path: "/ezconf/list",
                view: "ezconfListView", // because we registered the view in app.views.ezconfListView
                sideViews: {'navigationHub': true, 'discoveryBar': false},
                callbacks: ['open', 'checkUser', 'handleSideViews', 'handleMainView'],
            });
        },
    }, {
        NS: 'ezconfTypeApp' // don't forget that
    });

    Y.eZ.PluginRegistry.registerPlugin(
        Y.eZConf.Plugin.ListAppPlugin, ['platformuiApp']
    );
});
</pre></td></tr></table><p>After doing that, <code>/ez#/ezconf/list</code> should no longer display the dashboard, but you should see the message generated by <code>Y.eZConf.ListView</code>.</p><h3>Using a template</h3><p>Manipulating the DOM in a view render method is fine for small changes but not very handy as soon as you want to generate a more complex UI. It's also a great way to separate pure UI/markup code from the actual view logic.</p><table class="wysiwyg-macro" data-macro-name="info" data-macro-id="3b6c5daf-1613-49dd-bc73-4cab41acaaf2" data-macro-schema-version="1" style="background-image: url(../servlet/confluence/placeholder/macro-headingd35c.png?definition=e2luZm99&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="RICH_TEXT"><tr><td class="wysiwyg-macro-body"><p>In PlatformUI, most views are using a template to generate their own markup, those templates are interpreted by <a href="http://yuilibrary.com/yui/docs/handlebars/">the Handlebars.js template engine embed into YUI</a>.</p></td></tr></table><p>The templates are made available in the application by defining them as modules in <code>yui.yml</code>. The template modules are a bit special though. To be recognized as a template and correctly handled by the application, a template module has a <code>type</code> property that should be set to <code>template</code>. Also, to get everything ready <em>automatically</em>, the module name should follow a naming convention. The module name should consist of the lowercase View internal name (the first <code>Y.Base.create</code> parameter) where the template is supposed to be used followed by the suffix <code>-ez-template</code>. In our case, the internal name of <code>Y.eZConf.ListView</code> is <code>ezconfListView</code>, so if we want to use a template in this view, the module for this template should be <code>ezconflistview-ez-template</code>. As a result, the module declaration for the template module will be:</p><table class="wysiwyg-macro" data-macro-name="code" data-macro-id="519794fb-5972-4af2-bee8-dcd24fe23613" data-macro-parameters="theme=Midnight" data-macro-schema-version="1" style="background-image: url(../servlet/confluence/placeholder/macro-heading86ef.png?definition=e2NvZGU6dGhlbWU9TWlkbmlnaHR9&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="PLAIN_TEXT"><tr><td class="wysiwyg-macro-body"><pre>ezconflistview-ez-template: # internal view name + '-ez-template' suffix
    type: 'template' # mandatory so that the template is available in JavaScript
    path: %extending_platformui.public_dir%/templates/ezconflistview.hbt</pre></td></tr></table><p>In <code>yui.yml</code>, we also have to change the <code>ezconf-listview</code> module to now require <span class="blob-code-inner"><span class="pl-s"><span class="pl-s"><code>ez-</code><span class="x x-first x-last"><code>templatebasedview</code> instead of <code>ez-view</code> so that <code>Y.eZConf.ListView</code> can inherit from <code>Y.eZ.TemplateBasedView</code> instead of <code>Y.eZ.View.</code></span></span></span></span> Once that in place, the rendering logic can be changed to use the template:</p><table class="wysiwyg-macro" data-macro-name="code" data-macro-id="02af4903-fa94-4507-aad4-ffb33b1585f5" data-macro-parameters="language=js|theme=Midnight" data-macro-schema-version="1" style="background-image: url(../servlet/confluence/placeholder/macro-headingd04d.png?definition=e2NvZGU6bGFuZ3VhZ2U9anN8dGhlbWU9TWlkbmlnaHR9&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="PLAIN_TEXT"><tr><td class="wysiwyg-macro-body"><pre>YUI.add('ezconf-listview', function (Y) {
    Y.namespace('eZConf');

    Y.eZConf.ListView = Y.Base.create('ezconfListView', Y.eZ.TemplateBasedView, [], { // Y.eZ.TemplateBasedView now!
        initializer: function () {
            console.log("Hey, I'm the list view");
        },

        render: function () {
            // when extending Y.eZ.TemplateBasedView
            // this.template is the result of the template
            // compilation, it's a function. You can pass an object
            // in parameters and each property will be available in the template
            // as a variable named after the property.
            this.get('container').setHTML(
                this.template({
                    "name": "listView"
                })
            );
            this.get('container').setStyles({
                background: '#fff',
                fontSize: '200%',
            });
            return this;
        },
    });
});
</pre></td></tr></table><p>And the last part of the chain is the Handlebars template file itself:</p><table class="wysiwyg-macro" data-macro-name="code" data-macro-id="a1b8f9f8-0cfa-4504-a1ec-66e4ef507532" data-macro-parameters="language=xml|theme=Midnight|title=ezconflistview.hbt" data-macro-schema-version="1" style="background-image: url(../servlet/confluence/placeholder/macro-headingbdde.png?definition=e2NvZGU6bGFuZ3VhZ2U9eG1sfHRoZW1lPU1pZG5pZ2h0fHRpdGxlPWV6Y29uZmxpc3R2aWV3LmhidH0&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="PLAIN_TEXT"><tr><td class="wysiwyg-macro-body"><pre>&lt;h1 class="ezconf-list-title">List view&lt;/h1>

Hey, I'm the {{ name }} and I'm rendered with the template!
</pre></td></tr></table><p>At this point, <code>/ez#/ezconf/list</code> should display the <span class="blob-code-inner"><span class="pl-s"><span class="pl-s"><span class="x x-first x-last"><code>Y.eZConf.ListView</code></span></span></span></span> rendered with the template.</p><h3>Adding a CSS</h3><p>We've just moved the markup logic from the view component to a template file. It is also time to do the same for the CSS styles that are still in the <code>render</code> method. For that, a CSS file can be created on the disk to replace the inline styles:</p><table class="wysiwyg-macro" data-macro-name="code" data-macro-id="75b7aabc-69da-40ff-9eeb-4dc25cafe8ec" data-macro-parameters="language=css|theme=Midnight|title=list.css" data-macro-schema-version="1" style="background-image: url(../servlet/confluence/placeholder/macro-headingaf7c.png?definition=e2NvZGU6bGFuZ3VhZ2U9Y3NzfHRoZW1lPU1pZG5pZ2h0fHRpdGxlPWxpc3QuY3NzfQ&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="PLAIN_TEXT"><tr><td class="wysiwyg-macro-body"><pre>.ez-view-ezconflistview {
    background: #fff;
}

.ez-view-ezconflistview .ezconf-list-title {
    margin-top: 0;
}
</pre></td></tr></table><table class="wysiwyg-macro" data-macro-name="info" data-macro-id="7d39a7b6-00ae-4eb7-9986-7b22b2b61505" data-macro-schema-version="1" style="background-image: url(../servlet/confluence/placeholder/macro-headingd35c.png?definition=e2luZm99&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="RICH_TEXT"><tr><td class="wysiwyg-macro-body"><p>By default, a view container element has an auto-generated class built from the internal view name.</p><p><strong>Good practice:</strong> using that auto-generated class to write the CSS rule greatly limits the risk of side effects when styling a view.</p></td></tr></table><p> </p><p>Then this file has to be listed in the extension bundle <code>css.yml</code> configuration file:</p><table class="wysiwyg-macro" data-macro-name="code" data-macro-id="14377701-3fbf-44e0-a7ba-ad0209891ef2" data-macro-parameters="language=text|theme=Midnight|title=css.yml" data-macro-schema-version="1" style="background-image: url(../servlet/confluence/placeholder/macro-heading0acf.png?definition=e2NvZGU6bGFuZ3VhZ2U9dGV4dHx0aGVtZT1NaWRuaWdodHx0aXRsZT1jc3MueW1sfQ&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="PLAIN_TEXT"><tr><td class="wysiwyg-macro-body"><pre>system:
    default:
        css:
            files:
                - %extending_platformui.css_dir%/views/list.css
</pre></td></tr></table><p>After this is done, a custom view is now used when reaching <code>/ez#/ezconf/list</code> and the UI is now styled with a custom external stylesheet.</p><table class="wysiwyg-macro" data-macro-name="tip" data-macro-id="d3171ff8-eb48-46de-9488-454dd337f5fb" data-macro-parameters="title=Results and next step:" data-macro-schema-version="1" style="background-image: url(../servlet/confluence/placeholder/macro-heading31fc.png?definition=e3RpcDp0aXRsZT1SZXN1bHRzIGFuZCBuZXh0IHN0ZXA6fQ&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="RICH_TEXT"><tr><td class="wysiwyg-macro-body"><div class="confluence-information-macro-body"><p>The resulting code can be seen in <a href="https://github.com/ezsystems/ExtendingPlatformUIConferenceBundle/tree/4_view">the 4_view tag on GitHub</a>, this step result can also be viewed as <a href="https://github.com/ezsystems/ExtendingPlatformUIConferenceBundle/compare/3_routing...4_view">a diff between tags <code>3_routing</code> and <code>4_view</code></a>.</p><p>The next step is then <a class="confluence-link" href="../../display/TECHDOC/Configure%2bthe%2bnavigation.html" data-linked-resource-id="31424526" data-linked-resource-version="9" data-linked-resource-type="page" data-linked-resource-default-alias="Configure the navigation" data-base-url="../../index.html">to configure the navigation</a> so that user can easily reach the new page.</p></div></td></tr></table>
        <p>&nbsp;</p>
    </body>

<!-- Mirrored from doc.ez.no/plugins/viewsource/viewpagesrc.action?pageId=30712516 by HTTrack Website Copier/3.x [XR&CO'2013], Tue, 31 Jan 2017 10:02:10 GMT -->
</html>
