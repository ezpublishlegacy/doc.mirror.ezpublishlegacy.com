                    
    
                    
    
                    
    
<!DOCTYPE html>
<html>
    
<!-- Mirrored from doc.ez.no/plugins/viewsource/viewpagesrc.action?pageId=31430614 by HTTrack Website Copier/3.x [XR&CO'2013], Tue, 31 Jan 2017 09:25:43 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head>
        <title>View Source</title>
        <link rel="canonical" href="../../pages/viewpage487b.html?pageId=31430614" />
        <script>
window.WRM=window.WRM||{};window.WRM._unparsedData=window.WRM._unparsedData||{};
WRM._unparsedData["com.atlassian.plugins.atlassian-plugins-webresource-rest:web-resource-manager.resource-base-url-pattern"]="\"(?:(?:/s/.*?/_)?/download)\"";
WRM._unparsedData["com.atlassian.plugins.atlassian-plugins-webresource-plugin:context-path.context-path"]="\"\"";
WRM._unparsedData["com.atlassian.plugins.browser.metrics.browser-metrics-plugin:browser-metrics.feature-data-provider-legacy"]="true";
</script>
<link type="text/css" rel="stylesheet" href="../../s/1b9968ac17721e3a6947d14e3a43c3f8-CDN/en_GB/5983/f3e491afc761ac0a6981cfa3dcbc04fc7e88c149.16/89/_/download/superbatch/css/batch9c16.css?build-number=5983" media="all">
<!--[if lt IE 9]>
<link type="text/css" rel="stylesheet" href="/s/d41d8cd98f00b204e9800998ecf8427e-CDN/en_GB/5983/f3e491afc761ac0a6981cfa3dcbc04fc7e88c149.16/89/_/download/superbatch/css/batch.css?conditionalComment=lt+IE+9" media="all">
<![endif]-->
<!--[if lte IE 9]>
<link type="text/css" rel="stylesheet" href="/s/d41d8cd98f00b204e9800998ecf8427e-CDN/en_GB/5983/f3e491afc761ac0a6981cfa3dcbc04fc7e88c149.16/89/_/download/superbatch/css/batch.css?conditionalComment=lte+IE+9" media="all">
<![endif]-->
<link type="text/css" rel="stylesheet" href="../../s/d41d8cd98f00b204e9800998ecf8427e-CDN/en_GB/5983/f3e491afc761ac0a6981cfa3dcbc04fc7e88c149.16/f3685658010e413141854089096800b5/_/download/contextbatch/css/plugin.viewsource/batch.css" media="all">
<link type="text/css" rel="stylesheet" href="../../s/df762e50bc83a9608020a1ff1476cda6-CDN/en_GB/5983/f3e491afc761ac0a6981cfa3dcbc04fc7e88c149.16/5a0f37b8e5a58a48983bc1f25fb099f6/_/download/contextbatch/css/page/batch.css" media="all">
<!--[if lt IE 9]>
<link type="text/css" rel="stylesheet" href="/s/d41d8cd98f00b204e9800998ecf8427e-CDN/en_GB/5983/f3e491afc761ac0a6981cfa3dcbc04fc7e88c149.16/5a0f37b8e5a58a48983bc1f25fb099f6/_/download/contextbatch/css/page/batch.css?conditionalComment=lt+IE+9" media="all">
<![endif]-->
<link type="text/css" rel="stylesheet" href="../../s/5714bd5a5c86641cad10106916cda7c8-CDN/en_GB/5983/f3e491afc761ac0a6981cfa3dcbc04fc7e88c149.16/49f5f7dfc888d48bff618d087d8044cc/_/download/contextbatch/css/editor-content/batch.css" media="all">
<!--[if lte IE 9]>
<link type="text/css" rel="stylesheet" href="/s/d41d8cd98f00b204e9800998ecf8427e-CDN/en_GB/5983/f3e491afc761ac0a6981cfa3dcbc04fc7e88c149.16/49f5f7dfc888d48bff618d087d8044cc/_/download/contextbatch/css/editor-content/batch.css?conditionalComment=lte+IE+9" media="all">
<![endif]-->
<link type="text/css" rel="stylesheet" href="../../s/en_GB/5983/f3e491afc761ac0a6981cfa3dcbc04fc7e88c149.16/6/_/styles/colors74cd.css?spaceKey=DEVELOPER" media="all">
<link type="text/css" rel="stylesheet" href="../../s/en_GB/5983/f3e491afc761ac0a6981cfa3dcbc04fc7e88c149.16/6/_/styles/custom74cd.css?spaceKey=DEVELOPER" media="all">

    </head>

    <body class="mceContentBody aui-theme-default wiki-content fullsize">
        <p>&nbsp;</p>         <div class="contentLayout2">
<div class="columnLayout two-right-sidebar" data-layout="two-right-sidebar">
<div class="cell normal" data-type="normal">
<div class="innerCell">
<h1>Description</h1><p><img class="editor-inline-macro" height="18" width="88" src="../servlet/status-macro/placeholder714c.png?=&amp;0=&amp;colour=Yellow&amp;title=v1.2" data-macro-name="status" data-macro-id="fc49514a-0327-4e31-b838-c28573d089d8" data-macro-parameters="colour=Yellow|title=v1.2" data-macro-default-parameter="" data-macro-schema-version="1"></p><p>A Landing Page has a customizable <span class="DEF"><span class="DEF">layout</span></span> with multiple zones where you can place predefined blocks with content.</p><p>By default eZ Enterprise comes with a number of preset Landing Page blocks. You can, however, add custom blocks to your configuration.</p><h1>Solution</h1><h2>Block configuration</h2><p>In the Demo installation the layout configuration is stored in <code>ezstudio-demo-bundle/Resources/config/default_layouts.yml</code>:</p><table class="wysiwyg-macro" data-macro-name="code" data-macro-id="a7870e6f-e62b-45fd-83d9-3b90204167e2" data-macro-parameters="language=xml|title=Example default_layouts.yml" data-macro-schema-version="1" style="background-image: url(../servlet/confluence/placeholder/macro-headingd73e.png?definition=e2NvZGU6bGFuZ3VhZ2U9eG1sfHRpdGxlPUV4YW1wbGUgZGVmYXVsdF9sYXlvdXRzLnltbH0&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="PLAIN_TEXT"><tr><td class="wysiwyg-macro-body"><pre>blocks:
    gallery:
        views:
            gallery:
                template: eZStudioDemoBundle:blocks:gallery.html.twig
                name: Default Gallery Block template
    keyword:
        views:
            keyword:
                template: eZStudioDemoBundle:blocks:keyword.html.twig
                name: Default Keyword Block template
    rss:
        views:
            rss:
                template: eZStudioDemoBundle:blocks:rss.html.twig
                name: Default RSS Block template
    tag:
        views:
            tag:
                template: eZStudioDemoBundle:blocks:tag.html.twig
                name: Default Tag Block template</pre></td></tr></table><p> </p><h2>Creating a new block</h2><h3>Creating a class for the block</h3><p>The class for the block must implement the <code>BlockType</code> interface:</p><table class="wysiwyg-macro" data-macro-name="code" data-macro-id="c314f4af-db7a-44bf-814b-b5eb853c5804" data-macro-schema-version="1" style="background-image: url(../servlet/confluence/placeholder/macro-heading34e7.png?definition=e2NvZGV9&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="PLAIN_TEXT"><tr><td class="wysiwyg-macro-body"><pre>EzSystems\LandingPageFieldTypeBundle\FieldType\LandingPage\Model\BlockType</pre></td></tr></table><p>Most methods are implemented in a universal way by using <span>the <code>AbstractBlockType</code> abstract class:</span></p><table class="wysiwyg-macro" data-macro-name="code" data-macro-id="94ab1edf-dfa6-49a2-a165-515b2758f078" data-macro-schema-version="1" style="background-image: url(../servlet/confluence/placeholder/macro-heading34e7.png?definition=e2NvZGV9&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="PLAIN_TEXT"><tr><td class="wysiwyg-macro-body"><pre>EzSystems\LandingPageFieldTypeBundle\FieldType\LandingPage\Model\AbstractBlockType </pre></td></tr></table><p>If your block does not have specific attributes or a structure, you can extend the <code>
          AbstractBlockType
        </code> <strong> </strong>class, which contains simple generic converters designated for the block attributes.</p><p><span>For example:</span></p><table class="wysiwyg-macro" data-macro-name="code" data-macro-id="afe82506-823e-4a26-bc08-8fc31d6fc8e4" data-macro-parameters="language=php" data-macro-schema-version="1" style="background-image: url(../servlet/confluence/placeholder/macro-heading1802.png?definition=e2NvZGU6bGFuZ3VhZ2U9cGhwfQ&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="PLAIN_TEXT"><tr><td class="wysiwyg-macro-body"><pre>&lt;?php
namespace AcmeDemoBundle\Block;

use EzSystems\LandingPageFieldTypeBundle\FieldType\LandingPage\Model\AbstractBlockType;

/**
* RSS block
* Renders feed from a given URL.
*/
class RSSBlock extends AbstractBlockType
{
   // Class body
}</pre></td></tr></table><p><span> <br /> </span></p><h3>Describing a class definition</h3><p>A block <strong>must</strong> have a definition set using two classes:</p><h4>BlockAttributeDefinition</h4><p>The <code>
              BlockAttributeDefinition
            </code> class defines the attributes of a block<span>:<br /> </span></p><table class="confluenceTable"><tbody><tr><th class="confluenceTh">Attribute</th><th class="confluenceTh">Type</th><th class="confluenceTh">Definition</th></tr><tr><td class="confluenceTd">$id</td><td class="confluenceTd">string</td><td class="confluenceTd">block attribute ID</td></tr><tr><td class="confluenceTd">$name</td><td class="confluenceTd">string</td><td class="confluenceTd">block attribute name</td></tr><tr><td class="confluenceTd">$type</td><td class="confluenceTd">string</td><td class="confluenceTd">block attribute type, available options are:<br /><ul><li><code>
                        <span style="color: rgb(61,60,64);">integer</span>
                      </code></li><li><code>
                        <span style="color: rgb(61,60,64);">string</span>
                      </code></li><li><code>
                        <span style="color: rgb(61,60,64);">url</span>
                      </code></li><li><code>
                        <span style="color: rgb(61,60,64);">text</span>
                      </code></li><li><code>
                        <span style="color: rgb(61,60,64);">embed</span>
                      </code></li><li><code>
                        <span style="color: rgb(61,60,64);">select</span>
                      </code></li><li><code>
                        <span style="color: rgb(61,60,64);">multiple</span>
                      </code></li></ul></td></tr><tr><td class="confluenceTd">$regex</td><td class="confluenceTd">string</td><td class="confluenceTd">block attribute regex used for validation</td></tr><tr><td class="confluenceTd">$regexErrorMessage</td><td class="confluenceTd">string</td><td class="confluenceTd">message displayed when regex does not match</td></tr><tr><td class="confluenceTd">$required</td><td class="confluenceTd">bool</td><td class="confluenceTd"><code>TRUE</code> if attribute is required</td></tr><tr><td class="confluenceTd">$inline</td><td class="confluenceTd">bool</td><td class="confluenceTd">indicates whether block attribute input should be rendered inline in a form</td></tr><tr><td class="confluenceTd">$values</td><td class="confluenceTd">array</td><td class="confluenceTd">array of chosen values</td></tr><tr><td colspan="1" class="confluenceTd">$options</td><td colspan="1" class="confluenceTd">array</td><td colspan="1" class="confluenceTd">array of available options</td></tr></tbody></table><p><span style="color: rgb(0,0,0);"> <br /> </span></p><h4>BlockDefinition</h4><p>The <code>
              BlockDefinition
            </code> class describes a block:</p><table class="confluenceTable"><tbody><tr><th class="confluenceTh">Attribute</th><th class="confluenceTh">Type</th><th class="confluenceTh">Definition</th><th colspan="1" class="confluenceTh">Note</th></tr><tr><td class="confluenceTd"><p>$type</p></td><td class="confluenceTd">string</td><td class="confluenceTd">block type</td><td colspan="1" class="confluenceTd"> </td></tr><tr><td class="confluenceTd">$name</td><td class="confluenceTd">string</td><td class="confluenceTd">block name</td><td colspan="1" class="confluenceTd"> </td></tr><tr><td class="confluenceTd">$category</td><td class="confluenceTd">string</td><td class="confluenceTd">block category</td><td colspan="1" class="confluenceTd"> </td></tr><tr><td class="confluenceTd">$thumbnail</td><td class="confluenceTd">string</td><td class="confluenceTd">path to block thumbnail image</td><td colspan="1" class="confluenceTd"> </td></tr><tr><td class="confluenceTd">$templates</td><td class="confluenceTd">array</td><td class="confluenceTd">array of available paths of templates</td><td colspan="1" class="confluenceTd"><p>Retrieved from the config file (default_layouts.yml)</p></td></tr><tr><td class="confluenceTd">$attributes</td><td class="confluenceTd">array</td><td class="confluenceTd">array of block attributes (objects of <code>
                    <strong>BlockAttributeDefinition</strong>
                  </code> class)</td><td colspan="1" class="confluenceTd"> </td></tr></tbody></table><p><span style="color: rgb(0,0,0);"> <br /> </span></p><p> </p><p>When extending <code>AbstractBlockType</code> you <strong>must</strong> implement at least 3 methods:</p><table class="wysiwyg-macro" data-macro-name="expand" data-macro-id="16799c70-1db4-4857-ad0a-989d2a21e5b1" data-macro-parameters="title=createBlockDefinition()" data-macro-schema-version="1" style="background-image: url(../servlet/confluence/placeholder/macro-heading11bf.png?definition=e2V4cGFuZDp0aXRsZT1jcmVhdGVCbG9ja0RlZmluaXRpb24oKX0&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="RICH_TEXT"><tr><td class="wysiwyg-macro-body"><p>This method must return an<strong> <code> EzSystems\LandingPageFieldTypeBundle\FieldType\LandingPage\Definition\BlockDefinition</code> </strong> object.</p><p>Example of a Gallery block:</p><table class="wysiwyg-macro" data-macro-name="code" data-macro-id="8905eada-15db-44bb-94f5-36a617149f71" data-macro-parameters="language=php" data-macro-schema-version="1" style="background-image: url(../servlet/confluence/placeholder/macro-heading1802.png?definition=e2NvZGU6bGFuZ3VhZ2U9cGhwfQ&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="PLAIN_TEXT"><tr><td class="wysiwyg-macro-body"><pre>/**
 * Creates BlockDefinition object for block type.
 *
 * @return \EzSystems\LandingPageFieldTypeBundle\FieldType\LandingPage\Definition\BlockDefinition
 */
public function createBlockDefinition()
{
    return new BlockDefinition(
        'gallery',
        'Gallery Block',
        'default',
        'bundles/ezsystemslandingpagefieldtype/images/thumbnails/gallery.svg',
        [], 
        [
            new BlockAttributeDefinition(
                'contentId',
                'Folder',
                'embed',
                '/^([a-zA-Z]:)?(\/[a-zA-Z0-9_\/-]+)+\/?/',
                'Choose an image folder'
            ),
        ]
    );
}</pre></td></tr></table></td></tr></table><table class="wysiwyg-macro" data-macro-name="expand" data-macro-id="310a110e-02fb-4345-aec8-73eeb2c10675" data-macro-parameters="title=getTemplateParameters(BlockValue $blockValue)" data-macro-schema-version="1" style="background-image: url(../servlet/confluence/placeholder/macro-headingbcf0.png?definition=e2V4cGFuZDp0aXRsZT1nZXRUZW1wbGF0ZVBhcmFtZXRlcnMoQmxvY2tWYWx1ZSAkYmxvY2tWYWx1ZSl9&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="RICH_TEXT"><tr><td class="wysiwyg-macro-body"><p>This method returns an array of parameters to be displayed in rendered view of block. <span>You can access them directly in a block template (e. g. via twig </span> <code>{{ title }}</code> <span>).</span></p><p> </p><table class="wysiwyg-macro" data-macro-name="note" data-macro-id="91cbd48f-f5b2-498c-b254-e67fccd6c0ab" data-macro-schema-version="1" style="background-image: url(../servlet/confluence/placeholder/macro-headingdd57.png?definition=e25vdGV9&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="RICH_TEXT"><tr><td class="wysiwyg-macro-body"><p>When parameters are used in the template you call them directly without the <code>parameters</code> array name:</p><table class="confluenceTable"><tbody><tr><th class="confluenceTh">Correct</th><th class="confluenceTh">Not Correct</th></tr><tr><td class="confluenceTd"><code>
                        <span style="color: rgb(51,153,102);">&lt;h1&gt;{{ title }}&lt;/h1&gt;</span>
                      </code></td><td class="confluenceTd"><s> <code>
                          <span style="color: rgb(255,0,0);">&lt;h1&gt;{{ parameters.title }}&lt;/h1&gt;</span>
                        </code> </s></td></tr></tbody></table></td></tr></table><p> </p><p>Example of the <code>getTemplateParameters()</code> method implementation:</p><table class="wysiwyg-macro" data-macro-name="code" data-macro-id="a2802566-a13b-4007-bbf5-3ede2868683f" data-macro-parameters="language=php" data-macro-schema-version="1" style="background-image: url(../servlet/confluence/placeholder/macro-heading1802.png?definition=e2NvZGU6bGFuZ3VhZ2U9cGhwfQ&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="PLAIN_TEXT"><tr><td class="wysiwyg-macro-body"><pre>/**
* @param \EzSystems\LandingPageFieldTypeBundle\FieldType\LandingPage\Model\BlockValue $blockValue
*
* @return array
*/
public function getTemplateParameters(BlockValue $blockValue)
{
	$attributes = $blockValue->getAttributes();
	$limit = (isset($attributes['limit'])) ? $attributes['limit'] : 10;
	$offset = (isset($attributes['offset'])) ? $attributes['offset'] : 0;
	$parameters = [
		'title' => $attributes['title'],
		'limit' => $limit,
		'offset' => $offset,
		'feeds' => $this->RssProvider->getFeeds($attributes['url']),
	];
	
	return $parameters;
}</pre></td></tr></table><p><span> </span> <span> <br /> </span></p></td></tr></table><table class="wysiwyg-macro" data-macro-name="expand" data-macro-id="40fd6b6d-fe0c-49ea-9039-34143eb82245" data-macro-parameters="title=checkAttributesStructure(array $attributes)" data-macro-schema-version="1" style="background-image: url(../servlet/confluence/placeholder/macro-heading969d.png?definition=e2V4cGFuZDp0aXRsZT1jaGVja0F0dHJpYnV0ZXNTdHJ1Y3R1cmUoYXJyYXkgJGF0dHJpYnV0ZXMpfQ&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="RICH_TEXT"><tr><td class="wysiwyg-macro-body"><p>This method validates the input fields for a block. You can specify your own conditions to throw the <code>InvalidBlockAttributeException</code> exception.</p><p>This <code>InvalidBlockAttributeException</code> exception has the following parameters:</p><table class="confluenceTable"><tbody><tr><th class="confluenceTh">Name</th><th class="confluenceTh">Description</th></tr><tr><td class="confluenceTd"><span class="pl-s1"> <span class="pl-smi"> <strong>blockType</strong> </span> </span></td><td class="confluenceTd"><span class="pl-s1"> <span class="pl-smi">name of a block</span> </span></td></tr><tr><td class="confluenceTd"><span class="pl-s1"> <span class="pl-smi"> <span class="pl-s1"> <span class="pl-smi"> <strong>attribute</strong> </span> </span> </span> </span></td><td class="confluenceTd"><span class="pl-s1"> <span class="pl-smi"> <span class="pl-s1"> <span class="pl-smi">name of the block's attribute which failed validation</span> </span> </span> </span></td></tr><tr><td class="confluenceTd"><span class="pl-s1"> <span class="pl-smi"> <span class="pl-s1"> <span class="pl-smi"> <span class="pl-s1"> <span class="pl-smi"> <strong>message</strong> </span> </span> </span> </span> </span> </span></td><td class="confluenceTd"><span class="pl-s1"> <span class="pl-smi"> <span class="pl-s1"> <span class="pl-smi"> <span class="pl-s1"> <span class="pl-smi">a short information about an error</span> </span> </span> </span> </span> </span></td></tr><tr><td class="confluenceTd"><span class="pl-s1"> <span class="pl-smi"> <span class="pl-s1"> <span class="pl-smi"> <span class="pl-s1"> <span class="pl-smi"> <span class="pl-s1"> <span class="pl-smi"> <strong>previous</strong> </span> </span> </span> </span> </span> </span> </span> </span></td><td class="confluenceTd"><span class="pl-s1"> <span class="pl-smi"> <span class="pl-s1"> <span class="pl-smi"> <span class="pl-s1"> <span class="pl-smi"> <span class="pl-s1"> <span class="pl-smi">previous exception, null by default</span> </span> </span> </span> </span> </span> </span> </span></td></tr></tbody></table><p><span class="pl-s1"> </span> <span class="pl-s1"> <span class="pl-smi"> <span class="pl-s1"> <span class="pl-smi"> <span class="pl-s1"> <span class="pl-smi"> <span class="pl-s1"> <span class="pl-smi"> <br /> </span> </span> </span> </span> </span> </span> </span> </span></p><p><span>For example:</span></p><table class="wysiwyg-macro" data-macro-name="code" data-macro-id="a144456e-78f8-4c24-881f-8efe8a837f7d" data-macro-schema-version="1" style="background-image: url(../servlet/confluence/placeholder/macro-heading34e7.png?definition=e2NvZGV9&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="PLAIN_TEXT"><tr><td class="wysiwyg-macro-body"><pre>/**
 * Checks if block's attributes are valid.
 *
 * @param array $attributes
 *
 * @throws \EzSystems\LandingPageFieldTypeBundle\Exception\InvalidBlockAttributeException
 */
public function checkAttributesStructure(array $attributes)
{
    if (!isset($attributes['url'])) {
        throw new InvalidBlockAttributeException('RSS', 'url', 'URL must be set.');
    }

    if (isset($attributes['limit']) &amp;&amp; (($attributes['limit'] &lt; 1) || (!is_numeric($attributes['limit'])))) {
        throw new InvalidBlockAttributeException('RSS', 'limit', 'Limit must be a number greater than 0.');
    }

    if (isset($attributes['offset']) &amp;&amp; (($attributes['offset'] &lt; 0) || (!is_numeric($attributes['limit'])))) {
        throw new InvalidBlockAttributeException('RSS', 'offset', 'Offset must be a number no less than 0.');
    }
}</pre></td></tr></table></td></tr></table><table class="wysiwyg-macro" data-macro-name="note" data-macro-id="2cccc9fa-96b1-4cae-bafe-19e415cb94b3" data-macro-schema-version="1" style="background-image: url(../servlet/confluence/placeholder/macro-headingdd57.png?definition=e25vdGV9&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="RICH_TEXT"><tr><td class="wysiwyg-macro-body"><p>When the class is created make sure it is added to a container.</p></td></tr></table><p> </p><h3>Adding the class to the container</h3><p> The <strong>services.yml</strong> file must contain info about your block class.</p><table class="wysiwyg-macro" data-macro-name="note" data-macro-id="4bd59a7d-c69a-4db5-8dbd-ba7ded416211" data-macro-schema-version="1" style="background-image: url(../servlet/confluence/placeholder/macro-headingdd57.png?definition=e25vdGV9&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="RICH_TEXT"><tr><td class="wysiwyg-macro-body"><p>The description of your class must contain a tag which provides:</p><ul><li>tag name: <strong>landing_page_field_type.block_type</strong></li><li>tag alias: &lt;name of a block&gt;</li></ul></td></tr></table><p> </p><p>For example:</p><table class="wysiwyg-macro" data-macro-name="code" data-macro-id="64487ae1-61fa-4e0b-83a3-a5aeee406c9d" data-macro-schema-version="1" style="background-image: url(../servlet/confluence/placeholder/macro-heading34e7.png?definition=e2NvZGV9&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="PLAIN_TEXT"><tr><td class="wysiwyg-macro-body"><pre>acme.landing_page.block.rss: 											# service id
       class: AcmeDemoBundle\FieldType\LandingPage\Model\Block\RSSBlock # block's class with namespace
       tags: 															# service definition must contain tag with 
           - { name: landing_page_field_type.block_type, alias: rss}	# "landing_page_field_type.block_type" name and block name as an alias
</pre></td></tr></table><h2>Custom editing UI</h2><p>If you want to add a custom editing UI to your new block, you need to provide the code for the custom popup UI in Javascript (see the code for <a href="https://github.com/ezsystems/StudioUIBundle/blob/ea683e0443bc3660e9ee25fe24e435d99e1133ff/Resources/public/js/views/blocks/ezs-scheduleblockview.js">eZS.ScheduleBlockView</a> or <a href="https://github.com/ezsystems/StudioUIBundle/blob/162d6b9b967cb549f32bc06c4405d3809d8546f0/Resources/public/js/views/blocks/ezs-tagblockview.js">eZS.TagBlockView</a> for examples).</p><p>Once it is ready, create a plugin for <code>eZS.LandingPageCreatorView</code> that makes a use of the <code>addBlock</code> public method from <code>eZS.LandingPageCreatorView</code>, see the example below:</p><table class="wysiwyg-macro" data-macro-name="code" data-macro-id="82e5ab5f-b4b6-4d5d-8bb7-0de8586ec383" data-macro-schema-version="1" style="background-image: url(../servlet/confluence/placeholder/macro-heading34e7.png?definition=e2NvZGV9&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="PLAIN_TEXT"><tr><td class="wysiwyg-macro-body"><pre>YUI.add('ezs-addcustomblockplugin', function (Y) {
    'use strict';

    var namespace = 'Any.Namespace.Of.Your.Choice',

    Y.namespace(namespace);
    NS = Y[namespace];

    NS.Plugin.AddCustomBlock = Y.Base.create('addCustomBlockPlugin', Y.Plugin.Base, [], {
        initializer: function () {
            this.get('host').addBlock('custom', NS.CustomBlockView);
        },
    }, {
        NS: 'dashboardPlugin'
    });

    Y.eZ.PluginRegistry.registerPlugin(
        NS.Plugin.AddCustomBlock, ['landingPageCreatorView']
    );
});</pre></td></tr></table><table class="wysiwyg-macro" data-macro-name="info" data-macro-id="605ac7ff-d724-46f0-bfe0-09eed4d1e5a0" data-macro-parameters="title=Upcoming feature - multiple block templates" data-macro-schema-version="1" style="background-image: url(../servlet/confluence/placeholder/macro-headingda79.png?definition=e2luZm86dGl0bGU9VXBjb21pbmcgZmVhdHVyZSAtIG11bHRpcGxlIGJsb2NrIHRlbXBsYXRlc30&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="RICH_TEXT"><tr><td class="wysiwyg-macro-body"><p>The ability to configure different templates (views) for one Landing Page block is upcoming. See <a href="https://jira.ez.no/browse/EZS-1008">EZS-1008</a> to follow its progress.</p></td></tr></table><p> </p><h1>Example</h1><h3>Block Class</h3><table class="wysiwyg-macro" data-macro-name="code" data-macro-id="9dd4e8ed-a1ca-4b07-9d47-b06ae82e7388" data-macro-parameters="language=php|title=TagBlock.php" data-macro-schema-version="1" style="background-image: url(../servlet/confluence/placeholder/macro-heading21df.png?definition=e2NvZGU6bGFuZ3VhZ2U9cGhwfHRpdGxlPVRhZ0Jsb2NrLnBocH0&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="PLAIN_TEXT"><tr><td class="wysiwyg-macro-body"><pre>&lt;?php
/**
 * @copyright Copyright (C) eZ Systems AS. All rights reserved.
 * @license For full copyright and license information view LICENSE file distributed with this source code.
 */
namespace EzSystems\LandingPageFieldTypeBundle\FieldType\LandingPage\Model\Block;

use EzSystems\LandingPageFieldTypeBundle\Exception\InvalidBlockAttributeException;
use EzSystems\LandingPageFieldTypeBundle\FieldType\LandingPage\Definition\BlockDefinition;
use EzSystems\LandingPageFieldTypeBundle\FieldType\LandingPage\Definition\BlockAttributeDefinition;
use EzSystems\LandingPageFieldTypeBundle\FieldType\LandingPage\Model\AbstractBlockType;
use EzSystems\LandingPageFieldTypeBundle\FieldType\LandingPage\Model\BlockType;
use EzSystems\LandingPageFieldTypeBundle\FieldType\LandingPage\Model\BlockValue;

/**
 * Tag block
 * Renders simple HTML.
 */
class TagBlock extends AbstractBlockType implements BlockType
{
    /**
     * Returns array of parameters required to render block template.
     *
     * @param array $blockValue Block value attributes
     *
     * @return array Template parameters
     */
    public function getTemplateParameters(BlockValue $blockValue)
    {
        return ['block' => $blockValue];
    }

	/**
 	 * Creates BlockDefinition object for block type.
 	 *
 	 * @return \EzSystems\LandingPageFieldTypeBundle\FieldType\LandingPage\Definition\BlockDefinition
 	 */
    public function createBlockDefinition()
    {
        return new BlockDefinition(
            'tag',
            'Tag Block',
            'default',
            'bundles/ezsystemslandingpagefieldtype/images/thumbnails/tag.svg',
            [],
            [
                new BlockAttributeDefinition(
                    'content',
                    'Content',
                    'text',
                    '/[^\\s]/',
                    'Provide html code'
                ),
            ]
        );
    }

	/**
 	 * Checks if block's attributes are valid.
	 *
	 * @param array $attributes
	 *
	 * @throws \EzSystems\LandingPageFieldTypeBundle\Exception\InvalidBlockAttributeException
	 */
    public function checkAttributesStructure(array $attributes)
    {
        if (!isset($attributes['content'])) {
            throw new InvalidBlockAttributeException('Tag', 'content', 'Content must be set.');
        }
    }
}

</pre></td></tr></table><table class="wysiwyg-macro" data-macro-name="tip" data-macro-id="fb05d9b0-5a08-4dd8-aabc-cbbe13f51386" data-macro-schema-version="1" style="background-image: url(../servlet/confluence/placeholder/macro-heading7f8c.png?definition=e3RpcH0&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="RICH_TEXT"><tr><td class="wysiwyg-macro-body"><p><img class="editor-inline-macro" height="18" width="88" src="../servlet/status-macro/placeholder5aeb.png?title=v1.7&amp;colour=Yellow" data-macro-name="status" data-macro-id="b3c53a44-2c2b-4d0f-a69c-99d00c8394ce" data-macro-parameters="colour=Yellow|title=v1.7" data-macro-schema-version="1"></p><p>If you want to make sure that your block is only available in the Element menu in a specific situation, you can override the <code>isAvailable</code> method, which makes the block accessible by default:</p><table class="wysiwyg-macro" data-macro-name="code" data-macro-id="40ce30c8-8b66-494c-a46e-05938a77d9e5" data-macro-schema-version="1" style="background-image: url(../servlet/confluence/placeholder/macro-heading34e7.png?definition=e2NvZGV9&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="PLAIN_TEXT"><tr><td class="wysiwyg-macro-body"><pre>public function isAvailable()
    {
        return true;
    }</pre></td></tr></table></td></tr></table><p> </p><h3>service.yml configuration</h3><table class="wysiwyg-macro" data-macro-name="code" data-macro-id="d4c33bde-4341-47c2-a2c0-10a0e7868aac" data-macro-parameters="language=text|title=services.yml" data-macro-schema-version="1" style="background-image: url(../servlet/confluence/placeholder/macro-heading93b2.png?definition=e2NvZGU6bGFuZ3VhZ2U9dGV4dHx0aXRsZT1zZXJ2aWNlcy55bWx9&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="PLAIN_TEXT"><tr><td class="wysiwyg-macro-body"><pre>ezpublish.landing_page.block.tag:
    class: EzSystems\LandingPageFieldTypeBundle\FieldType\LandingPage\Model\Block\TagBlock
    tags:
        - { name: landing_page_field_type.block_type, alias: tag }</pre></td></tr></table><h3><span>Block template</span></h3><pre>{{ block.attributes.content|raw }}</pre><p> </p></div>
</div>
<div class="cell aside" data-type="aside">
<div class="innerCell">
<h4>In this topic:</h4><p><img class="editor-inline-macro" src="../servlet/confluence/placeholder/macro7c73.png?definition=e3RvYzptYXhMZXZlbD0zfQ&amp;locale=en_GB&amp;version=2" data-macro-name="toc" data-macro-id="febb8621-a36a-433c-9450-b4a297ba4761" data-macro-parameters="maxLevel=3" data-macro-schema-version="1"></p><p> </p><h4>Related topics:</h4><p><a class="confluence-link" href="../../pages/viewpage4f31.html?pageId=31430259" data-linked-resource-id="31430259" data-linked-resource-version="8" data-linked-resource-type="page" data-linked-resource-default-alias="Creating Landing Page layouts (Enterprise)" data-base-url="../../index.html">Creating Landing Page layouts (Enterprise)</a></p><p><a class="confluence-link" href="../../pages/viewpage224c.html?pageId=31430521" data-linked-resource-id="31430521" data-linked-resource-version="4" data-linked-resource-type="page" data-linked-resource-default-alias="Landing Page Field Type (Enterprise)" data-base-url="../../index.html">Landing Page Field Type (Enterprise)</a></p></div>
</div>
</div>
</div>
        <p>&nbsp;</p>
    </body>

<!-- Mirrored from doc.ez.no/plugins/viewsource/viewpagesrc.action?pageId=31430614 by HTTrack Website Copier/3.x [XR&CO'2013], Tue, 31 Jan 2017 09:25:44 GMT -->
</html>
