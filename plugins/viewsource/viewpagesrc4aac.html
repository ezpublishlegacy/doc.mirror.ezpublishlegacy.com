                    
    
                    
    
                    
    
<!DOCTYPE html>
<html>
    
<!-- Mirrored from doc.ez.no/plugins/viewsource/viewpagesrc.action?pageId=2720546 by HTTrack Website Copier/3.x [XR&CO'2013], Tue, 31 Jan 2017 10:06:35 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head>
        <title>View Source</title>
        <link rel="canonical" href="../../pages/viewpage4aac.html?pageId=2720546" />
        <script>
window.WRM=window.WRM||{};window.WRM._unparsedData=window.WRM._unparsedData||{};
WRM._unparsedData["com.atlassian.plugins.atlassian-plugins-webresource-rest:web-resource-manager.resource-base-url-pattern"]="\"(?:(?:/s/.*?/_)?/download)\"";
WRM._unparsedData["com.atlassian.plugins.atlassian-plugins-webresource-plugin:context-path.context-path"]="\"\"";
WRM._unparsedData["com.atlassian.plugins.browser.metrics.browser-metrics-plugin:browser-metrics.feature-data-provider-legacy"]="true";
</script>
<link type="text/css" rel="stylesheet" href="../../s/1b9968ac17721e3a6947d14e3a43c3f8-CDN/en_GB/5983/f3e491afc761ac0a6981cfa3dcbc04fc7e88c149.16/89/_/download/superbatch/css/batch9c16.css?build-number=5983" media="all">
<!--[if lt IE 9]>
<link type="text/css" rel="stylesheet" href="/s/d41d8cd98f00b204e9800998ecf8427e-CDN/en_GB/5983/f3e491afc761ac0a6981cfa3dcbc04fc7e88c149.16/89/_/download/superbatch/css/batch.css?conditionalComment=lt+IE+9" media="all">
<![endif]-->
<!--[if lte IE 9]>
<link type="text/css" rel="stylesheet" href="/s/d41d8cd98f00b204e9800998ecf8427e-CDN/en_GB/5983/f3e491afc761ac0a6981cfa3dcbc04fc7e88c149.16/89/_/download/superbatch/css/batch.css?conditionalComment=lte+IE+9" media="all">
<![endif]-->
<link type="text/css" rel="stylesheet" href="../../s/d41d8cd98f00b204e9800998ecf8427e-CDN/en_GB/5983/f3e491afc761ac0a6981cfa3dcbc04fc7e88c149.16/f3685658010e413141854089096800b5/_/download/contextbatch/css/plugin.viewsource/batch.css" media="all">
<link type="text/css" rel="stylesheet" href="../../s/df762e50bc83a9608020a1ff1476cda6-CDN/en_GB/5983/f3e491afc761ac0a6981cfa3dcbc04fc7e88c149.16/5a0f37b8e5a58a48983bc1f25fb099f6/_/download/contextbatch/css/page/batch.css" media="all">
<!--[if lt IE 9]>
<link type="text/css" rel="stylesheet" href="/s/d41d8cd98f00b204e9800998ecf8427e-CDN/en_GB/5983/f3e491afc761ac0a6981cfa3dcbc04fc7e88c149.16/5a0f37b8e5a58a48983bc1f25fb099f6/_/download/contextbatch/css/page/batch.css?conditionalComment=lt+IE+9" media="all">
<![endif]-->
<link type="text/css" rel="stylesheet" href="../../s/5714bd5a5c86641cad10106916cda7c8-CDN/en_GB/5983/f3e491afc761ac0a6981cfa3dcbc04fc7e88c149.16/49f5f7dfc888d48bff618d087d8044cc/_/download/contextbatch/css/editor-content/batch.css" media="all">
<!--[if lte IE 9]>
<link type="text/css" rel="stylesheet" href="/s/d41d8cd98f00b204e9800998ecf8427e-CDN/en_GB/5983/f3e491afc761ac0a6981cfa3dcbc04fc7e88c149.16/49f5f7dfc888d48bff618d087d8044cc/_/download/contextbatch/css/editor-content/batch.css?conditionalComment=lte+IE+9" media="all">
<![endif]-->
<link type="text/css" rel="stylesheet" href="../../s/en_GB/5983/f3e491afc761ac0a6981cfa3dcbc04fc7e88c149.16/51/_/styles/colorsb538.css?spaceKey=EZP" media="all">
<link type="text/css" rel="stylesheet" href="../../s/en_GB/5983/f3e491afc761ac0a6981cfa3dcbc04fc7e88c149.16/51/_/styles/customb538.css?spaceKey=EZP" media="all">

    </head>

    <body class="mceContentBody aui-theme-default wiki-content fullsize">
        <p>&nbsp;</p>         <p> </p><p><img class="editor-inline-macro" src="../servlet/confluence/placeholder/macro4170.png?definition=e3RvY30&amp;locale=en_GB&amp;version=2" data-macro-name="toc" data-macro-schema-version="1"></p><p>As eZ Publish legacy is part of eZ Publish 5, you might want to access its settings (i.e. not migrated extension). Regarding this, a <strong>LegacyConfigResolver</strong> has been implemented, allowing the access to the legacy settings.</p><h2>LegacyConfigResolver</h2><p>The <code>LegacyConfigResolver</code> works in the same way the main <code>ConfigResolver</code> presented in the <a class="confluence-link" href="../../display/EZP/Configuration.html" data-linked-resource-id="2720538" data-linked-resource-version="31" data-linked-resource-type="page" data-linked-resource-default-alias="Configuration" data-base-url="https://doc.ez.no">configuration documentation</a>. However, it has its own specification.</p><ul><li><strong>Parameter name</strong> must be the combination of the INI block and parameter name (<strong><code>&lt;iniGroupName&gt;.&lt;paramName&gt;</code></strong>, e.g. <code>DebugSettings.DebugOutput</code>).</li><li><strong>Namespace</strong> is the <strong>INI file name</strong>, <u>without .ini suffix</u> (e.g. <strong>image</strong> for <em>image.ini</em>).</li><li><strong>Scope</strong> can still be a specific siteaccess to look into (still defaults to current siteaccess)</li></ul><h3>Example</h3><table class="wysiwyg-macro" data-macro-name="code" data-macro-parameters="language=php" data-macro-schema-version="1" style="background-image: url(../servlet/confluence/placeholder/macro-heading1802.png?definition=e2NvZGU6bGFuZ3VhZ2U9cGhwfQ&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="PLAIN_TEXT"><tr><td class="wysiwyg-macro-body"><pre>// Inside a controller

$legacyResolver = $this->get( 'ezpublish_legacy.config.resolver' );
// Get [DebugSettings].DebugOutput from site.ini
$debugOutput = $legacyResolver->getParameter( 'DebugSettings.DebugOutput' );
// Get [ImageMagick].ExecutablePath from image.ini
$imageMagickPath = $legacyResolver->getParameter( 'ImageMagick.ExecutablePath', 'image' );
// Get [DatabaseSettings].Database from site.ini, for ezdemo_site_admin siteaccess
$databaseName = $legacyResolver->getParameter( 'DatabaseSettings.Database', 'site', 'ezdemo_site_admin' );

// Note that the examples above are also applicable for hasParameter().</pre></td></tr></table><h2>Best practices for migration</h2><p>It might happen that your eZ Publish application still relies on legacy extensions (yours or from the community) that have not been migrated yet to eZ Publish 5. In this case the <strong>LegacyConfigResolver</strong> can be useful, but the problem is that once the extension is migrated you will then need to change your code to use the main config resolver, which can be a bit tedious on large applications.</p><p>Actually, the <em>main</em> config resolver is set in such a way that <strong>it chains the different available resolvers</strong> (i.e. the main one and the legacy one). The <strong>ChainConfigResolver</strong> always checks the main <code>ConfigResolver</code> first, and if no parameter is found, it fallbacks to the <code>LegacyConfigResolver</code>.</p><p>So the example described above could be done in the following way:</p><table class="wysiwyg-macro" data-macro-name="code" data-macro-parameters="language=php" data-macro-schema-version="1" style="background-image: url(../servlet/confluence/placeholder/macro-heading1802.png?definition=e2NvZGU6bGFuZ3VhZ2U9cGhwfQ&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="PLAIN_TEXT"><tr><td class="wysiwyg-macro-body"><pre>// Inside a controller

// Get the (chain) ConfigResolver
$configResolver = $this->getConfigResolver();
// Get [DebugSettings].DebugOutput from site.ini
$debugOutput = $configResolver->getParameter( 'DebugSettings.DebugOutput' );
// Get [ImageMagick].ExecutablePath from image.ini
$imageMagickPath = $configResolver->getParameter( 'ImageMagick.ExecutablePath', 'image' );
// Get [DatabaseSettings].Database from site.ini, for ezdemo_site_admin siteaccess
$databaseName = $configResolver->getParameter( 'DatabaseSettings.Database', 'site', 'ezdemo_site_admin' );</pre></td></tr></table><p>The main difference is that <strong>we don't explicitly call the LegacyConfigResolver</strong>. The benefit is that once the settings are migrated to work with eZ Publish 5 (and assuming that these settings are named in the same way), there will be absolutely no change to do in your code! The <strong>ChainConfigResolver</strong> will seamlessly use the new configuration files.</p><h3>Note for extension developers</h3><p>Considering what was explained above, the best practice for extension migration regarding configuration is to keep a compatible format.</p><h4>Example for SQLIImport</h4><p><strong>Legacy INI settings:</strong></p><table class="wysiwyg-macro" data-macro-name="code" data-macro-parameters="title=sqliimport.ini for ezdemo_site siteaccess" data-macro-schema-version="1" style="background-image: url(../servlet/confluence/placeholder/macro-headinga665.png?definition=e2NvZGU6dGl0bGU9c3FsaWltcG9ydC5pbmkgZm9yIGV6ZGVtb19zaXRlIHNpdGVhY2Nlc3N9&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="PLAIN_TEXT"><tr><td class="wysiwyg-macro-body"><pre>[ImportSettings]
# User ID of the XML Import Robot
# If none provided, site.ini [UserSettings]/AnonymousUserID will be used
RobotUserID=14

# Max time to wait for each Stream (in seconds)
StreamTimeout=50 </pre></td></tr></table><p><strong>Would become:</strong></p><table class="wysiwyg-macro" data-macro-name="code" data-macro-schema-version="1" style="background-image: url(../servlet/confluence/placeholder/macro-heading34e7.png?definition=e2NvZGV9&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="PLAIN_TEXT"><tr><td class="wysiwyg-macro-body"><pre>parameters:
    # Namespace is sqliimport (formerly sqliimport.ini), scope is defined to ezdemo_site siteaccess
    sqliimport.ezdemo_site.ImportSettings.RobotUserID: 14
    sqliimport.ezdemo_site.ImportSettings.StreamTimeout: 50</pre></td></tr></table><p><strong>Usage in a controller:</strong></p><table class="wysiwyg-macro" data-macro-name="code" data-macro-parameters="language=php" data-macro-schema-version="1" style="background-image: url(../servlet/confluence/placeholder/macro-heading1802.png?definition=e2NvZGU6bGFuZ3VhZ2U9cGhwfQ&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="PLAIN_TEXT"><tr><td class="wysiwyg-macro-body"><pre>// Assuming that current siteaccess is ezdemo_site
// The following code will work regardless using the legacy extension or the migrated one.
$resolver = $this->getConfigResolver();
$robotUserId = $resolver->getParameter( 'ImportSettings.RobotUserID', 'sqliimport' );
$streamTimeout = $resolver->getParameter( 'ImportSettings.StreamTimeout', 'sqliimport' );</pre></td></tr></table><p> </p><p> </p>
        <p>&nbsp;</p>
    </body>

<!-- Mirrored from doc.ez.no/plugins/viewsource/viewpagesrc.action?pageId=2720546 by HTTrack Website Copier/3.x [XR&CO'2013], Tue, 31 Jan 2017 10:06:36 GMT -->
</html>
