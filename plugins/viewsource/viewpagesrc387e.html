                    
    
                    
    
                    
    
<!DOCTYPE html>
<html>
    
<!-- Mirrored from doc.ez.no/plugins/viewsource/viewpagesrc.action?pageId=32866555 by HTTrack Website Copier/3.x [XR&CO'2013], Tue, 31 Jan 2017 10:56:16 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head>
        <title>View Source</title>
        <link rel="canonical" href="../../pages/viewpage387e.html?pageId=32866555" />
        <script>
window.WRM=window.WRM||{};window.WRM._unparsedData=window.WRM._unparsedData||{};
WRM._unparsedData["com.atlassian.plugins.atlassian-plugins-webresource-rest:web-resource-manager.resource-base-url-pattern"]="\"(?:(?:/s/.*?/_)?/download)\"";
WRM._unparsedData["com.atlassian.plugins.atlassian-plugins-webresource-plugin:context-path.context-path"]="\"\"";
WRM._unparsedData["com.atlassian.plugins.browser.metrics.browser-metrics-plugin:browser-metrics.feature-data-provider-legacy"]="true";
</script>
<link type="text/css" rel="stylesheet" href="../../s/1b9968ac17721e3a6947d14e3a43c3f8-CDN/en_GB/5983/f3e491afc761ac0a6981cfa3dcbc04fc7e88c149.16/89/_/download/superbatch/css/batch9c16.css?build-number=5983" media="all">
<!--[if lt IE 9]>
<link type="text/css" rel="stylesheet" href="/s/d41d8cd98f00b204e9800998ecf8427e-CDN/en_GB/5983/f3e491afc761ac0a6981cfa3dcbc04fc7e88c149.16/89/_/download/superbatch/css/batch.css?conditionalComment=lt+IE+9" media="all">
<![endif]-->
<!--[if lte IE 9]>
<link type="text/css" rel="stylesheet" href="/s/d41d8cd98f00b204e9800998ecf8427e-CDN/en_GB/5983/f3e491afc761ac0a6981cfa3dcbc04fc7e88c149.16/89/_/download/superbatch/css/batch.css?conditionalComment=lte+IE+9" media="all">
<![endif]-->
<link type="text/css" rel="stylesheet" href="../../s/d41d8cd98f00b204e9800998ecf8427e-CDN/en_GB/5983/f3e491afc761ac0a6981cfa3dcbc04fc7e88c149.16/f3685658010e413141854089096800b5/_/download/contextbatch/css/plugin.viewsource/batch.css" media="all">
<link type="text/css" rel="stylesheet" href="../../s/df762e50bc83a9608020a1ff1476cda6-CDN/en_GB/5983/f3e491afc761ac0a6981cfa3dcbc04fc7e88c149.16/5a0f37b8e5a58a48983bc1f25fb099f6/_/download/contextbatch/css/page/batch.css" media="all">
<!--[if lt IE 9]>
<link type="text/css" rel="stylesheet" href="/s/d41d8cd98f00b204e9800998ecf8427e-CDN/en_GB/5983/f3e491afc761ac0a6981cfa3dcbc04fc7e88c149.16/5a0f37b8e5a58a48983bc1f25fb099f6/_/download/contextbatch/css/page/batch.css?conditionalComment=lt+IE+9" media="all">
<![endif]-->
<link type="text/css" rel="stylesheet" href="../../s/5714bd5a5c86641cad10106916cda7c8-CDN/en_GB/5983/f3e491afc761ac0a6981cfa3dcbc04fc7e88c149.16/49f5f7dfc888d48bff618d087d8044cc/_/download/contextbatch/css/editor-content/batch.css" media="all">
<!--[if lte IE 9]>
<link type="text/css" rel="stylesheet" href="/s/d41d8cd98f00b204e9800998ecf8427e-CDN/en_GB/5983/f3e491afc761ac0a6981cfa3dcbc04fc7e88c149.16/49f5f7dfc888d48bff618d087d8044cc/_/download/contextbatch/css/editor-content/batch.css?conditionalComment=lte+IE+9" media="all">
<![endif]-->
<link type="text/css" rel="stylesheet" href="../../s/en_GB/5983/f3e491afc761ac0a6981cfa3dcbc04fc7e88c149.16/6/_/styles/colors74cd.css?spaceKey=DEVELOPER" media="all">
<link type="text/css" rel="stylesheet" href="../../s/en_GB/5983/f3e491afc761ac0a6981cfa3dcbc04fc7e88c149.16/6/_/styles/custom74cd.css?spaceKey=DEVELOPER" media="all">

    </head>

    <body class="mceContentBody aui-theme-default wiki-content fullsize">
        <p>&nbsp;</p>         <div class="contentLayout2">
<div class="columnLayout two-right-sidebar" data-layout="two-right-sidebar">
<div class="cell normal" data-type="normal">
<div class="innerCell">
<p><img class="editor-inline-macro" src="../servlet/confluence/placeholder/macroa4f0.png?definition=e3RvYzptYXhMZXZlbD0zfG91dGxpbmU9dHJ1ZX0&amp;locale=en_GB&amp;version=2" data-macro-name="toc" data-macro-id="ee502a7c-a4df-4282-99bb-46b12013fdd0" data-macro-parameters="maxLevel=3|outline=true" data-macro-schema-version="1"></p><p><img class="confluence-embedded-image image-center" height="250" width="488" confluence-query-params="effects=drop-shadow" src="../../download/attachments/32866555/Beginners_Tutorial-RideList-viewb294.jpg?version=1&amp;modificationDate=1473672088000&amp;api=v2&amp;effects=drop-shadow" data-image-src="/download/attachments/32866555/Beginners_Tutorial-RideList-view.png?version=1&amp;modificationDate=1473672088000&amp;api=v2" data-unresolved-comment-count="0" data-linked-resource-id="32866553" data-linked-resource-version="1" data-linked-resource-type="attachment" data-linked-resource-default-alias="Beginners_Tutorial-RideList-view.png" data-base-url="https://doc.ez.no" data-linked-resource-content-type="image/png" data-linked-resource-container-id="32866555" data-linked-resource-container-version="3" title="Developer > Step 2 - Display the list of Rides on the homepage > Beginners_Tutorial-RideList-view.png" data-location="Developer > Step 2 - Display the list of Rides on the homepage > Beginners_Tutorial-RideList-view.png" data-image-height="571" data-image-width="1115"></p><h2>Customize your homepage template</h2><p>Let's modify the <code>Resources/views/content/full/root_folder.html.twig<strong> </strong></code> adding a call to a subrequest to display the list of all existing Rides with pagination:</p><table class="wysiwyg-macro" data-macro-name="code" data-macro-id="eb6ca2d1-6421-424c-88d8-d891ad1b7cdd" data-macro-parameters="language=xml|linenumbers=true|title=root_folder.html.twig" data-macro-schema-version="1" style="background-image: url(../servlet/confluence/placeholder/macro-heading65b3.png?definition=e2NvZGU6bGFuZ3VhZ2U9eG1sfHRpdGxlPXJvb3RfZm9sZGVyLmh0bWwudHdpZ3xsaW5lbnVtYmVycz10cnVlfQ&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="PLAIN_TEXT"><tr><td class="wysiwyg-macro-body"><pre>{% extends "pagelayout.html.twig" %}

{% block content %}
    &lt;script src="http://maps.google.com/maps/api/js?sensor=false">&lt;/script>

    &lt;h3 class="center bottom-plus new-header">{{ ez_content_name(content) }}&lt;/h3>
    &lt;div class="col-xs-10 text-justified">
    {{ render( controller( "AppBundle:Homepage:getAllRides" ) ) }}
    &lt;/div>
 {% endblock %}</pre></td></tr></table><table class="wysiwyg-macro" data-macro-name="info" data-macro-id="4d299428-b7c6-4709-8a0a-1de19fe4136f" data-macro-schema-version="1" style="background-image: url(../servlet/confluence/placeholder/macro-headingd35c.png?definition=e2luZm99&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="RICH_TEXT"><tr><td class="wysiwyg-macro-body"><p> For the moment, we use a simple <code>render()</code> Twig function but when we talk about cache, we will use <code><a href="../../display/EZP/Content%2bview65bc.html?focusedCommentId=27394205#Contentview-ESI"><strong>render_esi</strong></a></code>.</p></td></tr></table><h2>Create your sub controller to display list of Rides</h2><p>Create your <code>/src/AppBundle/Controller/HomepageController.php </code>with the method <code>getAllRidesAction</code>:<strong><br /></strong></p><table class="wysiwyg-macro" data-macro-name="code" data-macro-id="49b6fa6c-e93e-4a04-9515-1835da71e484" data-macro-parameters="language=php|linenumbers=true|title=HomepageController.php" data-macro-schema-version="1" style="background-image: url(../servlet/confluence/placeholder/macro-heading3997.png?definition=e2NvZGU6bGFuZ3VhZ2U9cGhwfHRpdGxlPUhvbWVwYWdlQ29udHJvbGxlci5waHB8bGluZW51bWJlcnM9dHJ1ZX0&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="PLAIN_TEXT"><tr><td class="wysiwyg-macro-body"><pre>&lt;?php
namespace AppBundle\Controller;
use eZ\Publish\API\Repository\Values\Content\Query;
use eZ\Publish\API\Repository\Values\Content\Query\Criterion;
use eZ\Publish\Core\MVC\Symfony\Controller\Controller;
use eZ\Publish\API\Repository\Values\Content\Query\SortClause;
use eZ\Publish\Core\Pagination\Pagerfanta\ContentSearchAdapter;
use Pagerfanta\Pagerfanta;
use Symfony\Component\HttpFoundation\Request;
class HomepageController extends Controller
{
  public function getAllRidesAction(Request $request)
  {
    $repository = $this->getRepository();
    $locationService = $repository->getLocationService();
    $contentService = $repository->getContentService();
    $rootLocationId = $this->getConfigResolver()->getParameter('content.tree_root.location_id');
    $rootLocation = $locationService->loadLocation($rootLocationId);
    $currentLocationId = 2;
    $currentLocation = $locationService->loadLocation($currentLocationId);
    $currentContent = $contentService->loadContentByContentInfo($currentLocation->contentInfo);
    $query = new Query();
    $query->query = new Criterion\LogicalAnd(
      array(
        new Criterion\Subtree($rootLocation->pathString),
        new Criterion\Visibility(Criterion\Visibility::VISIBLE),
        new Criterion\ContentTypeIdentifier(array('ride'))
      )
    );
    $query->sortClauses = array(
      new SortClause\DatePublished(Query::SORT_ASC)
    );
    $pager = new Pagerfanta(
      new ContentSearchAdapter($query, $this->getRepository()->getSearchService())
    );
    //FIXME : get $limit value from a custom parameter
    $limit = 10;
    $pager->setMaxPerPage($limit);
    $pager->setCurrentPage($request->get('page', 1));
    return $this->render(
      'list/rides.html.twig',
      array(
        'location' => $currentLocation,
        'content' => $currentContent,
        'pagerRides' => $pager,
      )
    );
  }
}</pre></td></tr></table><h2>Create template to display the list of Rides</h2><p>Create <code>app/Resources/views/list/rides.html.twig </code>template. You use a &lt;table&gt; to display the list of rides. The &lt;thead&gt; of the &lt;table&gt; is in this Ride list template and each &lt;tr&gt; (line of the table) is in the line ride template.</p><p>So each time you use the line Ride template, you have to remember the choice of using a &lt;tr&gt;.</p><table class="wysiwyg-macro" data-macro-name="code" data-macro-id="ad21a23f-d399-4b12-ab24-f477bd38652a" data-macro-parameters="language=xml|linenumbers=true|title=rides.html.twig" data-macro-schema-version="1" style="background-image: url(../servlet/confluence/placeholder/macro-headingcfbf.png?definition=e2NvZGU6bGFuZ3VhZ2U9eG1sfHRpdGxlPXJpZGVzLmh0bWwudHdpZ3xsaW5lbnVtYmVycz10cnVlfQ&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="PLAIN_TEXT"><tr><td class="wysiwyg-macro-body"><pre>&lt;div class="row regular-content-size">
  &lt;div class="col-xs-10 col-xs-offset-1 box-style">
    &lt;h3 class="center bottom-plus new-header">List of all Rides&lt;/h3>
    {# Loop over the page results #}
    {% for ride in pagerRides %}
      {% if loop.first %}
        &lt;table class="table table-hover">
        &lt;thead>
        &lt;tr class="table-header">
          &lt;th> Ride&lt;/th>
          &lt;th>From&lt;/th>
          &lt;th> To&lt;/th>
          &lt;th>Distance&lt;/th>
          &lt;th>Level&lt;/th>
        &lt;/tr>
        &lt;/thead>
        &lt;tbody>
      {% endif %}
      {{ render( controller( 'ez_content:viewLocation', { 'locationId': ride.versionInfo.contentInfo.mainLocationId, 'viewType': 'line' } )) }}
      {% if loop.last %}
        &lt;/tbody>
        &lt;/table>
      {% endif %}
    {% endfor %}
  &lt;/div>
&lt;/div></pre></td></tr></table><p>The next step is to create the override rule to use a dedicated template for the view line of Rides.</p><p>To do so, you need to configure your Bundle to inject override configuration.</p><h2><span>Use a custom template to display view line of a Ride</span></h2><p>You add the rule for the line_ride template to be used in your <code>app/config/ezplatform.yml </code>file.</p><table class="wysiwyg-macro" data-macro-name="code" data-macro-id="424a21f6-c067-437d-acf9-526fce312d08" data-macro-parameters="language=groovy|title=ezplatform.yml" data-macro-schema-version="1" style="background-image: url(../servlet/confluence/placeholder/macro-headingad1e.png?definition=e2NvZGU6bGFuZ3VhZ2U9Z3Jvb3Z5fHRpdGxlPWV6cGxhdGZvcm0ueW1sfQ&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="PLAIN_TEXT"><tr><td class="wysiwyg-macro-body"><pre>system:
    site_group:
        content_view:
            line:
                line_ride:
                    template: "line/ride.html.twig"
                    match:
                        Identifier\ContentType: "ride"</pre></td></tr></table><p>Create your <code>app/Resources/views/line/ride.html.twig </code>template.</p><p><em>Remember, it's only one line of a table, so you will find a &lt;tr&gt; tag with some &lt;td&gt; tags.</em></p><table class="wysiwyg-macro" data-macro-name="code" data-macro-id="6b9179da-ac69-46e1-b195-089bb33c4ea4" data-macro-parameters="language=xml|linenumbers=true|title=ride.html.twig" data-macro-schema-version="1" style="background-image: url(../servlet/confluence/placeholder/macro-headingc24d.png?definition=e2NvZGU6bGFuZ3VhZ2U9eG1sfHRpdGxlPXJpZGUuaHRtbC50d2lnfGxpbmVudW1iZXJzPXRydWV9&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="PLAIN_TEXT"><tr><td class="wysiwyg-macro-body"><pre>&lt;tr>
    &lt;td>
        &lt;strong>
            &lt;a href="{{ path( "ez_urlalias", { 'locationId': content.contentInfo.mainLocationId } ) }}"
               target="_self">
                {{ ez_content_name( content ) }}
            &lt;/a>
        &lt;/strong>
    &lt;/td>
    &lt;td>
        {{ ez_render_field(content, 'starting_point', {'parameters': {'width': '100%', 'height': '100px', 'showMap': true, 'showInfo': true }}
        ) }}
    &lt;/td>
    &lt;td>
        {{ ez_render_field(content, 'ending_point', {'parameters': {'width': '100%', 'height': '100px', 'showMap': true, 'showInfo': true }}
        ) }}
    &lt;/td>
    &lt;td>
        &lt;p>{{ ez_render_field( content, 'length' ) }} Km&lt;/p>
    &lt;/td>
    &lt;td>
        &lt;p>{{ ez_render_field( content, 'level' ) }}&lt;/p>
    &lt;/td>
&lt;/tr></pre></td></tr></table><p>Go to the homepage of your Tutorial website, and you will see the list of Rides !</p><p> </p><p> </p><table class="wysiwyg-macro" data-macro-name="section" data-macro-id="7d4fe832-5435-4ad3-9521-64d1248e24db" data-macro-schema-version="1" style="background-image: url(../servlet/confluence/placeholder/macro-heading83a9.png?definition=e3NlY3Rpb259&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="RICH_TEXT"><tr><td class="wysiwyg-macro-body"><table class="wysiwyg-macro" data-macro-name="column" data-macro-id="aaf0605f-7f9a-4abb-9210-943879fa1ab6" data-macro-parameters="width=50%" data-macro-schema-version="1" style="background-image: url(../servlet/confluence/placeholder/macro-heading99b3.png?definition=e2NvbHVtbjp3aWR0aD01MCV9&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="RICH_TEXT"><tr><td class="wysiwyg-macro-body"><p><span class="char" title="Leftwards Black Arrow">⬅</span> Previous: <a class="confluence-link" href="../../display/DEVELOPER/Step%2b1%2b-%2bDisplay%2bcontent%2bof%2ba%2bRide.html" data-linked-resource-id="31431852" data-linked-resource-version="36" data-linked-resource-type="page" data-linked-resource-default-alias="Step 1 - Display content of a Ride" data-base-url="../../index.html">Step 1 - Display content of a Ride</a></p></td></tr></table><table class="wysiwyg-macro" data-macro-name="column" data-macro-id="961312c5-7cf0-4983-b1e4-d915cb06fab7" data-macro-schema-version="1" style="background-image: url(../servlet/confluence/placeholder/macro-heading16cd.png?definition=e2NvbHVtbn0&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="RICH_TEXT"><tr><td class="wysiwyg-macro-body"><p style="text-align: right;">Next: <a href="../../pages/viewpage762c.html?pageId=31431873">Congrats!</a> <span class="confluence-link" title="Black Rightwards Arrow">➡</span></p></td></tr></table></td></tr></table><p> </p><p> </p></div>
</div>
<div class="cell aside" data-type="aside">
<div class="innerCell">
<table class="wysiwyg-macro" data-macro-name="panel" data-macro-id="d8c77d99-57aa-4735-a392-c4f56fe8f2c9" data-macro-parameters="borderColor=#f58220|borderWidth=2|title=Tutorial path" data-macro-schema-version="1" style="background-image: url(../servlet/confluence/placeholder/macro-headingc82d-2.png?definition=e3BhbmVsOmJvcmRlckNvbG9yPSNmNTgyMjB8Ym9yZGVyV2lkdGg9Mnx0aXRsZT1UdXRvcmlhbCBwYXRofQ&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="RICH_TEXT"><tr><td class="wysiwyg-macro-body"><p><img class="editor-inline-macro" src="../servlet/confluence/placeholder/macroc62c.png?definition=e3BhZ2V0cmVlOnJvb3Q9QnVpbGRpbmcgYSBCaWN5Y2xlIFJvdXRlIFRyYWNrZXIgaW4gZVogUGxhdGZvcm19&amp;locale=en_GB&amp;version=2" data-macro-name="pagetree" data-macro-id="c7f521bd-a024-475d-86f4-7093ee4da54f" data-macro-parameters="root=Building a Bicycle Route Tracker in eZ Platform" data-macro-schema-version="1"></p></td></tr></table></div>
</div>
</div>
</div>
        <p>&nbsp;</p>
    </body>

<!-- Mirrored from doc.ez.no/plugins/viewsource/viewpagesrc.action?pageId=32866555 by HTTrack Website Copier/3.x [XR&CO'2013], Tue, 31 Jan 2017 10:56:17 GMT -->
</html>
