                    
    
                    
    
                    
    
<!DOCTYPE html>
<html>
    
<!-- Mirrored from doc.ez.no/plugins/viewsource/viewpagesrc.action?pageId=30711418 by HTTrack Website Copier/3.x [XR&CO'2013], Tue, 31 Jan 2017 10:03:29 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head>
        <title>View Source</title>
        <link rel="canonical" href="../../pages/viewpage3e63.html?pageId=30711418" />
        <script>
window.WRM=window.WRM||{};window.WRM._unparsedData=window.WRM._unparsedData||{};
WRM._unparsedData["com.atlassian.plugins.atlassian-plugins-webresource-rest:web-resource-manager.resource-base-url-pattern"]="\"(?:(?:/s/.*?/_)?/download)\"";
WRM._unparsedData["com.atlassian.plugins.atlassian-plugins-webresource-plugin:context-path.context-path"]="\"\"";
WRM._unparsedData["com.atlassian.plugins.browser.metrics.browser-metrics-plugin:browser-metrics.feature-data-provider-legacy"]="true";
</script>
<link type="text/css" rel="stylesheet" href="../../s/1b9968ac17721e3a6947d14e3a43c3f8-CDN/en_GB/5983/f3e491afc761ac0a6981cfa3dcbc04fc7e88c149.16/89/_/download/superbatch/css/batch9c16.css?build-number=5983" media="all">
<!--[if lt IE 9]>
<link type="text/css" rel="stylesheet" href="/s/d41d8cd98f00b204e9800998ecf8427e-CDN/en_GB/5983/f3e491afc761ac0a6981cfa3dcbc04fc7e88c149.16/89/_/download/superbatch/css/batch.css?conditionalComment=lt+IE+9" media="all">
<![endif]-->
<!--[if lte IE 9]>
<link type="text/css" rel="stylesheet" href="/s/d41d8cd98f00b204e9800998ecf8427e-CDN/en_GB/5983/f3e491afc761ac0a6981cfa3dcbc04fc7e88c149.16/89/_/download/superbatch/css/batch.css?conditionalComment=lte+IE+9" media="all">
<![endif]-->
<link type="text/css" rel="stylesheet" href="../../s/d41d8cd98f00b204e9800998ecf8427e-CDN/en_GB/5983/f3e491afc761ac0a6981cfa3dcbc04fc7e88c149.16/f3685658010e413141854089096800b5/_/download/contextbatch/css/plugin.viewsource/batch.css" media="all">
<link type="text/css" rel="stylesheet" href="../../s/df762e50bc83a9608020a1ff1476cda6-CDN/en_GB/5983/f3e491afc761ac0a6981cfa3dcbc04fc7e88c149.16/5a0f37b8e5a58a48983bc1f25fb099f6/_/download/contextbatch/css/page/batch.css" media="all">
<!--[if lt IE 9]>
<link type="text/css" rel="stylesheet" href="/s/d41d8cd98f00b204e9800998ecf8427e-CDN/en_GB/5983/f3e491afc761ac0a6981cfa3dcbc04fc7e88c149.16/5a0f37b8e5a58a48983bc1f25fb099f6/_/download/contextbatch/css/page/batch.css?conditionalComment=lt+IE+9" media="all">
<![endif]-->
<link type="text/css" rel="stylesheet" href="../../s/5714bd5a5c86641cad10106916cda7c8-CDN/en_GB/5983/f3e491afc761ac0a6981cfa3dcbc04fc7e88c149.16/49f5f7dfc888d48bff618d087d8044cc/_/download/contextbatch/css/editor-content/batch.css" media="all">
<!--[if lte IE 9]>
<link type="text/css" rel="stylesheet" href="/s/d41d8cd98f00b204e9800998ecf8427e-CDN/en_GB/5983/f3e491afc761ac0a6981cfa3dcbc04fc7e88c149.16/49f5f7dfc888d48bff618d087d8044cc/_/download/contextbatch/css/editor-content/batch.css?conditionalComment=lte+IE+9" media="all">
<![endif]-->
<link type="text/css" rel="stylesheet" href="../../s/en_GB/5983/f3e491afc761ac0a6981cfa3dcbc04fc7e88c149.16/8/_/styles/colors82a8.css?spaceKey=TECHDOC" media="all">
<link type="text/css" rel="stylesheet" href="../../s/en_GB/5983/f3e491afc761ac0a6981cfa3dcbc04fc7e88c149.16/8/_/styles/custom82a8.css?spaceKey=TECHDOC" media="all">

    </head>

    <body class="mceContentBody aui-theme-default wiki-content fullsize">
        <p>&nbsp;</p>         <table class="wysiwyg-macro" data-macro-name="warning" data-macro-id="ca3aac60-de9a-4283-934d-be41b3778de7" data-macro-parameters="title=Deprecated" data-macro-schema-version="1" style="background-image: url(../servlet/confluence/placeholder/macro-headingeaf6.png?definition=e3dhcm5pbmc6dGl0bGU9RGVwcmVjYXRlZH0&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="RICH_TEXT"><tr><td class="wysiwyg-macro-body"><p>The Page Field Type has as of first stable releases of eZ Platform 15.12 and eZ Studio 15.12 been deprecated. A replacement called <a href="../../display/TECHDOC/The%2bLandingPage%2bFieldType.html">LandingPage</a> is provided with eZ Studio and tools for migration are planned to be provided together with 16.02/16.04 release. At that point Page Field Type will not be bundled anymore.</p></td></tr></table><p> </p><p><img class="editor-inline-macro" src="../servlet/confluence/placeholder/macro4170.png?definition=e3RvY30&amp;locale=en_GB&amp;version=2" data-macro-name="toc" data-macro-id="f542535b-97c2-4221-bc2e-4ff8f2601ba6" data-macro-schema-version="1"></p><h2>Description</h2><p>With the Page Field Type, in legacy part of &quot;ezflow&quot; extension, editors can define a <strong>layout</strong> with <strong>multiple zones</strong> within a single front- or landing-page.</p><p>Within each zone, editors create <strong>blocks</strong> that contain particular content categories. Specific content can be added to these blocks, they are called <strong>block items</strong>.</p><p>This is particularly useful for managing homepages/landing pages.</p><table class="wysiwyg-macro" data-macro-name="note" data-macro-id="4b3a7bd4-bcfd-486a-bee9-b96c4bbba9d5" data-macro-schema-version="1" style="background-image: url(../servlet/confluence/placeholder/macro-headingdd57.png?definition=e25vdGV9&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="RICH_TEXT"><tr><td class="wysiwyg-macro-body"><p>The Page Field Type has limited write support with the Public API as of <img class="editor-inline-macro" src="../servlet/confluence/placeholder/macro42ad.png?definition=e2ppcmE6a2V5PUVaUC0yNTQxM30=&amp;locale=en_GB" data-macro-name="jira" data-macro-id="a1b67b89-8882-45a9-952e-4d183f0de763" data-macro-parameters="key=EZP-25413|server=eZ Systems JIRA tracker|serverId=841cf523-cc54-30bc-bc5d-89e63192498a" data-macro-schema-version="1"> with 16.04 <em>(v1.3.0)</em> release, before this it where read-only. In all versions it is still possible to edit content with it through the admin interface <em>(which runs through the legacy stack)</em>. </p></td></tr></table><table class="confluenceTable"><tbody><tr><th class="confluenceTh">Name</th><th class="confluenceTh">Internal name</th><th colspan="1" class="confluenceTh">Expected input</th><th colspan="1" class="confluenceTh">Output</th></tr><tr><td class="confluenceTd"><code>Page</code></td><td class="confluenceTd"><code>ezpage</code></td><td colspan="1" class="confluenceTd"><code>N/A</code></td><td colspan="1" class="confluenceTd"><code>eZ\Publish\Core\FieldType\Page\Parts\Page </code></td></tr></tbody></table><h2>Configuration</h2><table class="wysiwyg-macro" data-macro-name="warning" data-macro-id="ecefe63b-1e0a-4409-8fed-97bfa1b07c4e" data-macro-parameters="title=Warning" data-macro-schema-version="1" style="background-image: url(../servlet/confluence/placeholder/macro-heading340d.png?definition=e3dhcm5pbmc6dGl0bGU9V2FybmluZ30&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="RICH_TEXT"><tr><td class="wysiwyg-macro-body"><p>You still need to define your available layouts and blocks in the legacy part to get them available in the admin interface. Please refer to <a href="../../Extensions/eZ-Publish-extensions/eZ-Flow/eZ-Flow-2.5/Configuration/Configuring-the-eZ-Flow-block-system.html">eZ Publish legacy documentation</a> to learn how to do so.</p></td></tr></table><h3>Defining a zone layout</h3><p><span>A layout is a combination of zones that are placed on a page. The placement of the zones is defined in a template that is specified as part of the layout configuration. You can define as many layouts as you need.</span></p><p>You can define a new layout and enable it in your main YAML configuration:</p><table class="wysiwyg-macro" data-macro-name="code" data-macro-id="ce52ce9f-4c84-49a7-b67b-e594478464fe" data-macro-parameters="title=ezplatform.yml" data-macro-schema-version="1" style="background-image: url(../servlet/confluence/placeholder/macro-headingfc7c.png?definition=e2NvZGU6dGl0bGU9ZXpwbGF0Zm9ybS55bWx9&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="PLAIN_TEXT"><tr><td class="wysiwyg-macro-body"><pre>ezpublish:
    system:
        my_siteaccess:
            ezpage:
                layouts:
                    myLayoutIdentifier:
                        name: "My über cool layout"
                        template: "AcmeDemoBundle:page/zonelayouts:my_template.html.twig"
				enabledLayouts: [myLayoutIdentifier]</pre></td></tr></table><p>Then, when rendering a Page Field Type using <code>myLayoutIdentifier</code>, <code>Resources/views/page/zonelayouts/my_template.html.twig</code> from AcmeDemoBundle will be used (see <a href="http://symfony.com/doc/master/book/controller.html#rendering-templates">how to use template identifiers in Symfony documentation</a>).</p><table class="wysiwyg-macro" data-macro-name="tip" data-macro-id="09d03ac8-f346-47e7-92dd-9638f5202b50" data-macro-parameters="title=Tip" data-macro-schema-version="1" style="background-image: url(../servlet/confluence/placeholder/macro-heading6668.png?definition=e3RpcDp0aXRsZT1UaXB9&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="RICH_TEXT"><tr><td class="wysiwyg-macro-body"><p>You can specify a legacy template in your layout definition.</p><table class="wysiwyg-macro" data-macro-name="code" data-macro-id="0978ad82-fa93-4a8d-84a7-2850fa256244" data-macro-schema-version="1" style="background-image: url(../servlet/confluence/placeholder/macro-heading34e7.png?definition=e2NvZGV9&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="PLAIN_TEXT"><tr><td class="wysiwyg-macro-body"><pre>ezpublish:
    system:
        my_siteaccess:
            ezpage:
                layouts:
                    myLegacyLayout:
                        name: My legacy layout
                        template: "design:zone/my_legacy_template.tpl"
				enabledLayouts: [myLayoutIdentifier]</pre></td></tr></table><p><span>However, doing so will defer block display to the legacy templates as well.</span></p></td></tr></table><h3>Available blocks</h3><p>The blocks need to be defined and enabled in the YAML configuration as well:</p><table class="wysiwyg-macro" data-macro-name="code" data-macro-id="c41ef868-0488-4b38-9fff-5e060d23a518" data-macro-parameters="title=ezplatform.yml" data-macro-schema-version="1" style="background-image: url(../servlet/confluence/placeholder/macro-headingfc7c.png?definition=e2NvZGU6dGl0bGU9ZXpwbGF0Zm9ybS55bWx9&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="PLAIN_TEXT"><tr><td class="wysiwyg-macro-body"><pre>ezpublish:
    system:
        my_siteaccess:
            ezpage:
                blocks:
                    myBlockIdentifier:
                        name: "My über cool block"
                    myBlockIdentifier2:
                        name: "My über cool block 2"
				enabledBlocks: [myBlockIdentifier, myBlockIdentifier2]</pre></td></tr></table><h3>Block template selection</h3><table class="wysiwyg-macro" data-macro-name="note" data-macro-id="91f30069-d65a-4925-b112-e9f37c3d233b" data-macro-schema-version="1" style="background-image: url(../servlet/confluence/placeholder/macro-headingdd57.png?definition=e25vdGV9&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="RICH_TEXT"><tr><td class="wysiwyg-macro-body"><p>Template selection rules are applied only when you render a block with the <code>PageController</code> (using <code><a href="http://ez_pageviewblock/">ez_page:viewBlock</a></code> from templates), <a class="confluence-link" href="#ThePageFieldType-Renderingblocks" data-anchor="Renderingblocks" data-linked-resource-default-alias="Renderingblocks" data-base-url="../../index.html">see below</a>.</p></td></tr></table><p><span>Like you are able to </span><a class="confluence-link" href="../../display/TECHDOC/View%2bprovider%2bconfiguration.html" data-linked-resource-id="30711180" data-linked-resource-version="8" data-linked-resource-type="page" data-linked-resource-default-alias="View provider configuration" data-base-url="../../index.html">define template selection rules when displaying Location and Content objects</a><span>, you can also define rules for blocks, with dedicated matchers.</span></p><p>Configuration is a hash built in the following way:</p><table class="wysiwyg-macro" data-macro-name="code" data-macro-id="4c40d0b6-b842-42a4-8ab2-41bac6f4dedf" data-macro-parameters="title=ezplatform.yml" data-macro-schema-version="1" style="background-image: url(../servlet/confluence/placeholder/macro-headingfc7c.png?definition=e2NvZGU6dGl0bGU9ZXpwbGF0Zm9ybS55bWx9&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="PLAIN_TEXT"><tr><td class="wysiwyg-macro-body"><pre>ezpublish:
    system:
        my_siteaccess:
            block_view:
                # A simple unique key for your matching ruleset
                my_rule_set:
                    # The template identifier to load, following the Symfony bundle notation for templates
                    template: AcmeTestBundle:block:campaign.html.twig
                    # Hash of matchers to use, with their corresponding values to match against
                    match:
                        # Key is the matcher "identifier" (class name or service identifier)
                        # Value will be passed to the matcher's setMatchingConfig() method.
                        Type: Campaign
                another_rule:
                    template: AcmeTestBundle:block:custom_block.html.twig
                    match:
                        Type: CustomBlock</pre></td></tr></table><table class="wysiwyg-macro" data-macro-name="tip" data-macro-id="fa09ceff-fe3f-4f26-a7dd-161d94bd552e" data-macro-parameters="title=Tip" data-macro-schema-version="1" style="background-image: url(../servlet/confluence/placeholder/macro-heading6668.png?definition=e3RpcDp0aXRsZT1UaXB9&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="RICH_TEXT"><tr><td class="wysiwyg-macro-body"><p>You can define your template selection rules in a different configuration file. <a class="confluence-link" href="../../display/TECHDOC/Import%2bsettings%2bfrom%2ba%2bbundle.html" data-linked-resource-id="30711491" data-linked-resource-version="4" data-linked-resource-type="page" data-linked-resource-default-alias="Import settings from a bundle" data-base-url="../../index.html">Read the cookbook recipe to learn more about it</a> .</p></td></tr></table><table class="wysiwyg-macro" data-macro-name="info" data-macro-id="37e9ab10-4f63-4b3c-a507-dfd7d5a3967f" data-macro-schema-version="1" style="background-image: url(../servlet/confluence/placeholder/macro-headingd35c.png?definition=e2luZm99&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="RICH_TEXT"><tr><td class="wysiwyg-macro-body"><p>Matchers for <code>block_view</code> follow the same behavior than <a class="confluence-link" href="../../display/TECHDOC/View%2bprovider%2bconfiguration.html#Viewproviderconfiguration-Matchers" data-anchor="Matchers" data-linked-resource-id="30711180" data-linked-resource-version="8" data-linked-resource-type="page" data-linked-resource-default-alias="View provider configuration#Matchers" data-base-url="../../index.html">matchers for regular location_view / content_view</a>, except that their relative namespace will be <code>eZ\Publish\Core\MVC\Symfony\View\BlockViewProvider\Configured\Matcher</code> .</p><p>Hence you can combine matchers with AND and OR capabilities (<a href="https://confluence.ez.no/display/EZP/View+provider+configuration#Viewproviderconfiguration-Matchers">see main matchers' documentation page</a>).</p></td></tr></table><h4>Available matchers</h4><table class="confluenceTable"><tbody><tr><th class="confluenceTh">Identifier</th><th class="confluenceTh">Description</th></tr><tr><td class="confluenceTd"><code>Type</code></td><td class="confluenceTd"><p><span>Matches the unique <strong>block identifier</strong> defined in the legacy </span><code>block.ini</code><span> file (<a href="../../Extensions/eZ-Publish-extensions/eZ-Flow/eZ-Flow-2.5/Configuration/Configuring-the-eZ-Flow-block-system/Defining-the-eZ-Flow-blocks/Defining-block-types.html">see legacy documentation</a>).</span></p><p><span>For example with the following configuration in legacy block.ini, it will match against <code>Manual3Items</code>:</span></p><table class="wysiwyg-macro" data-macro-name="code" data-macro-id="5ee7f966-e456-4bf3-a13b-4904be036250" data-macro-schema-version="1" style="background-image: url(../servlet/confluence/placeholder/macro-heading34e7.png?definition=e2NvZGV9&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="PLAIN_TEXT"><tr><td class="wysiwyg-macro-body"><pre>[Manual3Items]
Name=3 Column News</pre></td></tr></table><p><span><br /></span></p></td></tr><tr><td colspan="1" class="confluenceTd"><code>View</code></td><td colspan="1" class="confluenceTd"><p><span>Matches the <strong>view’s unique identifier</strong> defined in the block definition in the legacy </span><code>block.ini</code><span> (see legacy documentation).</span></p><p><span>For example with the following configuration in legacy <code>block.ini</code>, it will match against <code>3_items1</code>:</span></p><table class="wysiwyg-macro" data-macro-name="code" data-macro-id="28c296bb-8511-4b13-8d55-a44c26871fa0" data-macro-schema-version="1" style="background-image: url(../servlet/confluence/placeholder/macro-heading34e7.png?definition=e2NvZGV9&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="PLAIN_TEXT"><tr><td class="wysiwyg-macro-body"><pre>[Manual3Items]
Name=3 Column News
ViewList[]=3_items1</pre></td></tr></table><table class="wysiwyg-macro" data-macro-name="info" data-macro-id="9e820428-eeae-4b6e-bea6-246e5aa3bc4f" data-macro-schema-version="1" style="background-image: url(../servlet/confluence/placeholder/macro-headingd35c.png?definition=e2luZm99&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="RICH_TEXT"><tr><td class="wysiwyg-macro-body"><p>When no view is defined, the default value is <strong>default</strong>.</p></td></tr></table><p><span><br /></span></p></td></tr><tr><td colspan="1" class="confluenceTd"><code>Id\Block</code></td><td colspan="1" class="confluenceTd">Matches against the block ID, as stored in <code>ezm_block</code> table</td></tr><tr><td colspan="1" class="confluenceTd"><code>Id\Zone</code></td><td colspan="1" class="confluenceTd">Matches against the zone ID a block belongs to, as stored in <code>ezm_block</code> table</td></tr></tbody></table><p> </p><h2>Displaying the Page content</h2><table class="wysiwyg-macro" data-macro-name="info" data-macro-id="9b9f29b7-4054-4b5a-a6e6-50c2c19350ca" data-macro-schema-version="1" style="background-image: url(../servlet/confluence/placeholder/macro-headingd35c.png?definition=e2luZm99&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="RICH_TEXT"><tr><td class="wysiwyg-macro-body"><p>This section focuses on how to display blocks from zone/layout templates.</p><p>Render of these templates are triggered when using <code>ez_render_field()</code> helper, like for any other field type.</p><p><a class="confluence-link" href="../../display/TECHDOC/Content%2bview.html#Contentview-Contentview-UsingtheFieldType'stemplateblock" data-anchor="Contentview-UsingtheFieldType'stemplateblock" data-linked-resource-id="30711198" data-linked-resource-version="6" data-linked-resource-type="page" data-linked-resource-default-alias="Content view#Contentview-UsingtheFieldType'stemplateblock" data-base-url="../../index.html">See field rendering documentation</a> for more information.</p></td></tr></table><p><span style="color: rgb(0,0,0);font-size: 1.4em;font-weight: bold;line-height: normal;">Layout template</span></p><p>Goal of a <strong>layout</strong> template is to display <strong>zones</strong> for the given layout, depending on your layout configuration.</p><h4>Variables passed to the layout template</h4><table class="confluenceTable"><tbody><tr><th class="confluenceTh">Variable name</th><th class="confluenceTh">Description</th><th class="confluenceTh">Type</th></tr><tr><td class="confluenceTd"><code>zones</code></td><td class="confluenceTd">Zone objects for this Page field</td><td class="confluenceTd">Array of <code>eZ\Publish\Core\FieldType\Page\Parts\Zone</code> objects</td></tr><tr><td colspan="1" class="confluenceTd"><code>zone_layout</code></td><td colspan="1" class="confluenceTd">The layout identifier (e.g. &quot;2ZonesLayout1&quot;)</td><td colspan="1" class="confluenceTd"><code>string</code></td></tr><tr><td colspan="1" class="confluenceTd"><code>pageService</code></td><td colspan="1" class="confluenceTd"><p>The PageService object (read more below). </p></td><td colspan="1" class="confluenceTd"><code>eZ\Bundle\EzPublishCoreBundle\FieldType\Page</code></td></tr></tbody></table><h3>Rendering blocks</h3><p>Each zone contain blocks that hold your content as block items. <span>To render blocks from a layout template, you need to do a sub-request.</span></p><table class="wysiwyg-macro" data-macro-name="tip" data-macro-id="0673545a-0e3e-4237-beaf-fdc630f15d45" data-macro-parameters="title=Tip" data-macro-schema-version="1" style="background-image: url(../servlet/confluence/placeholder/macro-heading6668.png?definition=e3RpcDp0aXRsZT1UaXB9&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="RICH_TEXT"><tr><td class="wysiwyg-macro-body"><p>You can use a custom controller to display a block.</p><p>However, if you do so, you might need to get access to the <a class="confluence-link" href="#ThePageFieldType-ThePageServiceobj" data-anchor="ThePageServiceobj" data-linked-resource-default-alias="ThePageServiceobj" data-base-url="../../index.html">PageService</a>. You can get it via the service container with identifier <code>ezpublish.fieldType.ezpage.pageService</code>.</p></td></tr></table><h4>Using <code>ez_page:viewBlock</code></h4><p><span>This controller is responsible of choosing the right template for your block, <a class="confluence-link" href="#ThePageFieldType-Blocktemplates" data-anchor="Blocktemplates" data-linked-resource-default-alias="Blocktemplates" data-base-url="../../index.html">depending on the rules you defined</a>.</span></p><p><span>You can use this controller from templates with the following syntax:</span></p><table class="wysiwyg-macro" data-macro-name="code" data-macro-id="772a6351-2561-4fd9-848c-dd915e1d17dd" data-macro-schema-version="1" style="background-image: url(../servlet/confluence/placeholder/macro-heading34e7.png?definition=e2NvZGV9&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="PLAIN_TEXT"><tr><td class="wysiwyg-macro-body"><pre>{{ render( controller( "ez_page:viewBlock", {'block': myBlock} ) ) }}</pre></td></tr></table><h5><span style="color: rgb(51,51,51);">Available arguments</span></h5><table class="confluenceTable"><tbody><tr><th class="confluenceTh">Name</th><th class="confluenceTh">Description</th><th class="confluenceTh">Type</th><th class="confluenceTh">Default value</th></tr><tr><td class="confluenceTd"><code>block</code></td><td class="confluenceTd">The block object you want to render</td><td class="confluenceTd"><code>eZ\Publish\Core\FieldType\Page\Parts\Block</code></td><td class="confluenceTd">N/A</td></tr><tr><td colspan="1" class="confluenceTd"><code>params</code></td><td colspan="1" class="confluenceTd"><p>Hash of variables you want to inject to sub-template, key being the exposed variable name.</p><table class="wysiwyg-macro" data-macro-name="code" data-macro-id="44a532a9-790e-4caa-9aeb-40eaab669846" data-macro-schema-version="1" style="background-image: url(../servlet/confluence/placeholder/macro-heading34e7.png?definition=e2NvZGV9&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="PLAIN_TEXT"><tr><td class="wysiwyg-macro-body"><pre>{{ render(
      controller( 
          "ez_page:viewBlock", 
          {
              'block': myBlock,
              'params': { 'some_variable': 'some_value' }
          }
      )
) }}</pre></td></tr></table></td><td colspan="1" class="confluenceTd">hash</td><td colspan="1" class="confluenceTd">empty</td></tr><tr><td colspan="1" class="confluenceTd"><code>cacheSettings</code></td><td colspan="1" class="confluenceTd"><p>Hash of cache settings to use by the sub-controller (useful if you use ESI or Hinclude strategies).</p><table class="wysiwyg-macro" data-macro-name="code" data-macro-id="1c9f2e7d-ae11-4399-83fd-12354b0cd025" data-macro-schema-version="1" style="background-image: url(../servlet/confluence/placeholder/macro-heading34e7.png?definition=e2NvZGV9&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="PLAIN_TEXT"><tr><td class="wysiwyg-macro-body"><pre>{{ render_esi(
      controller( 
          "ez_page:viewBlock", 
          {
              'block': myBlock,
              'params': { 'some_variable': 'some_value' },
              'cacheSettings': { 'smax-age': 600 }
          }
      )
) }}</pre></td></tr></table></td><td colspan="1" class="confluenceTd">hash (accepted keys are <code>max-age</code> and <code>smax-age</code>)</td><td colspan="1" class="confluenceTd">empty</td></tr></tbody></table><p><span><br /></span></p><h5>Variables exposed to the block template</h5><table class="confluenceTable"><tbody><tr><th class="confluenceTh">Variable name</th><th class="confluenceTh">Type</th><th class="confluenceTh">Description</th></tr><tr><td class="confluenceTd"><code>block</code></td><td class="confluenceTd"><code>eZ\Publish\Core\FieldType\Page\Parts\Block</code></td><td class="confluenceTd">The block to display</td></tr><tr><td colspan="1" class="confluenceTd"><code>valid_items</code></td><td colspan="1" class="confluenceTd">Array of <code>eZ\Publish\Core\FieldType\Page\Parts</code></td><td colspan="1" class="confluenceTd">Displayable block items</td></tr><tr><td colspan="1" class="confluenceTd"><code>valid_contentinfo_items</code></td><td colspan="1" class="confluenceTd">Array of <code>eZ\Publish\API\Repository\Values\Content\ContentInfo</code></td><td colspan="1" class="confluenceTd">Displayable block items, as <code>ContentInfo</code> objects.</td></tr><tr><td colspan="1" class="confluenceTd"><code>pageService</code> (deprecated as of v5.2)</td><td colspan="1" class="confluenceTd"><code>eZ\Bundle\EzPublishCoreBundle\FieldType\Page\PageService</code></td><td colspan="1" class="confluenceTd"><a class="confluence-link" href="#ThePageFieldType-ThePageServiceo" data-anchor="ThePageServiceo" data-linked-resource-default-alias="ThePageServiceo" data-base-url="../../index.html">The PageService object</a> (deprecated)</td></tr></tbody></table><p>And of course, all the additional variables <a class="confluence-link" href="#ThePageFieldType-Availablear" data-anchor="Availablear" data-linked-resource-default-alias="Availablear" data-base-url="../../index.html">you injected in the <code>params</code> argument </a>.</p><table class="wysiwyg-macro" data-macro-name="info" data-macro-id="54d41f72-f5af-4feb-b200-b206a277a638" data-macro-schema-version="1" style="background-image: url(../servlet/confluence/placeholder/macro-headingd35c.png?definition=e2luZm99&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="RICH_TEXT"><tr><td class="wysiwyg-macro-body"><p><code>valid_items</code> and <code>valid_contentinfo_items</code> variables are available as of <strong>v5.2 / 2013.11</strong>.</p><p>Usage of <code>pageService</code> is deprecated as of <strong>v5.2 / 2013.11.</strong></p></td></tr></table><p> </p><h4>Using <code>pageView:<span class="pl-s2"><span class="pl-en">viewBlockById </span></span></code></h4><p><code><span class="pl-s2"><span class="pl-en"><img class="editor-inline-macro" height="18" width="88" src="../servlet/status-macro/placeholder484b.png?title=%3E%3D+EZP+5.3.2&amp;colour=Yellow" data-macro-name="status" data-macro-id="6cfec3a2-eb1d-4f8e-9a7f-f7c19cd57420" data-macro-parameters="colour=Yellow|title=>\= EZP 5.3.2" data-macro-schema-version="1"><br /></span></span></code></p><p><span class="pl-s2"><span class="pl-en">You can render Blocks with ESI strategy in all contexts, ie including using Varnish with the controller viewBlockById. </span></span></p><p> </p><table class="wysiwyg-macro" data-macro-name="note" data-macro-id="6cf9183f-7368-4696-9f5f-b17c65bc9ce1" data-macro-schema-version="1" style="background-image: url(../servlet/confluence/placeholder/macro-headingdd57.png?definition=e25vdGV9&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="RICH_TEXT"><tr><td class="wysiwyg-macro-body"><p><span class="pl-s2"><span class="pl-en"><span class="pl-s2"><span class="pl-en">This feature is available from eZ Platform 5.3.2.</span></span></span></span></p></td></tr></table><h5><span style="color: rgb(51,51,51);">Available arguments</span></h5><table class="confluenceTable"><tbody><tr><th class="confluenceTh">Name</th><th class="confluenceTh">Description</th><th class="confluenceTh">Type</th><th class="confluenceTh">Default value</th></tr><tr><td class="confluenceTd"><code>id</code></td><td class="confluenceTd">The block ID of the block you want to render<br /><span class="pl-s2"><span class="pl-en">A <code>\eZ\Publish\API\Repository\Exceptions\NotFoundException</code> will be thrown, if block could not be found</span></span></td><td class="confluenceTd"><code>string</code></td><td class="confluenceTd">N/A</td></tr><tr><td colspan="1" class="confluenceTd"><code>params</code></td><td colspan="1" class="confluenceTd"><p>Hash of variables you want to inject to sub-template, key being the exposed variable name.</p><table class="wysiwyg-macro" data-macro-name="code" data-macro-id="5d0d27ca-4e97-41e0-b898-67c2e1b48d53" data-macro-schema-version="1" style="background-image: url(../servlet/confluence/placeholder/macro-heading34e7.png?definition=e2NvZGV9&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="PLAIN_TEXT"><tr><td class="wysiwyg-macro-body"><pre>{{ render(
      controller( 
          "ez_page:viewBlockById", 
          {
              'id': 42,
              'params': { 'some_variable': 'some_value' }
          }
      )
) }}</pre></td></tr></table></td><td colspan="1" class="confluenceTd">hash</td><td colspan="1" class="confluenceTd">empty</td></tr><tr><td colspan="1" class="confluenceTd"><code>cacheSettings</code></td><td colspan="1" class="confluenceTd"><p>Hash of cache settings to use by the sub-controller (useful if you use ESI or Hinclude strategies).</p><table class="wysiwyg-macro" data-macro-name="code" data-macro-id="597c3b71-e68a-4005-a769-065dae2d0447" data-macro-schema-version="1" style="background-image: url(../servlet/confluence/placeholder/macro-heading34e7.png?definition=e2NvZGV9&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="PLAIN_TEXT"><tr><td class="wysiwyg-macro-body"><pre>{{ render_esi(
      controller( 
          "ez_page:viewBlockById", 
          {
              'id': 42,
              'params': { 'some_variable': 'some_value' },
              'cacheSettings': { 'smax-age': 600 }
          }
      )
) }}</pre></td></tr></table></td><td colspan="1" class="confluenceTd">hash (accepted keys are <code>max-age</code> and <code>smax-age</code>)</td><td colspan="1" class="confluenceTd">empty</td></tr></tbody></table><p> </p><h4>Rendering Block items</h4><p>As said above, <strong>a block holds your displayable content as block items</strong> which consists of <code>eZ\Publish\Core\FieldType\Page\Parts\Item</code> objects. Among <a href="https://github.com/ezsystems/ezpublish-kernel/blob/master/eZ/Publish/Core/FieldType/Page/Parts/Item.php">the available properties</a>, you will find <code>contentId</code> and <code>locationId</code> which reference the content/location you want to display. All you have to do then is to <strong>render it view <code><a href="http://ez_contentviewlocation/">ez_content:viewLocation</a></code> or <code><a href="http://ez_contentviewcontent/">ez_content:viewContent</a></code></strong> (<a class="confluence-link" href="#ThePageFieldType-ExampleExample" data-anchor="ExampleExample" data-linked-resource-default-alias="ExampleExample" data-base-url="../../index.html">see full example below</a>).</p><h3>The PageService object</h3><p>The PageService object (<code>eZ\Bundle\EzPublishCoreBundle\FieldType\Page\PageService</code>) is a helper giving the possibility to get current zone/block definitions and to retrieve block items.</p><h4>Main methods</h4><table class="confluenceTable"><tbody><tr><th class="confluenceTh">Method name</th><th class="confluenceTh">Description</th><th class="confluenceTh">Return type</th></tr><tr><td class="confluenceTd"><code>getZoneDefinition()</code></td><td class="confluenceTd">Returns zone definition (all defined zones for the current siteaccess) as an array</td><td class="confluenceTd"><code>array</code></td></tr><tr><td colspan="1" class="confluenceTd"><code>getZoneDefinitionByLayout()</code></td><td colspan="1" class="confluenceTd">Returns a zone definition for a given layout. It consists of a configuration array for the given layout.</td><td colspan="1" class="confluenceTd"><code>array</code></td></tr><tr><td colspan="1" class="confluenceTd"><code>getBlockDefinition()</code></td><td colspan="1" class="confluenceTd">Returns block definition as an array</td><td colspan="1" class="confluenceTd"><code>array</code></td></tr><tr><td colspan="1" class="confluenceTd"><code>getBlockDefinitionByIdentifier()</code></td><td colspan="1" class="confluenceTd">Returns a block definition for a given block identifier.</td><td colspan="1" class="confluenceTd"><code>array</code></td></tr><tr><td colspan="1" class="confluenceTd"><code>getValidBlockItems()</code></td><td colspan="1" class="confluenceTd">Returns valid items (that are to be displayed), for a given block.</td><td colspan="1" class="confluenceTd"><code>eZ\Publish\Core\FieldType\Page\Parts\Item[]</code></td></tr><tr><td colspan="1" class="confluenceTd"><code>getLastValidBlockItem()</code></td><td colspan="1" class="confluenceTd">Returns the last valid item, for a given block.</td><td colspan="1" class="confluenceTd"><code>eZ\Publish\Core\FieldType\Page\Parts\Item|null</code></td></tr><tr><td colspan="1" class="confluenceTd"><code>getWaitingBlockItems()</code></td><td colspan="1" class="confluenceTd">Returns queued items (the next to be displayed), for a given block.</td><td colspan="1" class="confluenceTd"><code>eZ\Publish\Core\FieldType\Page\Parts\Item[]</code></td></tr><tr><td colspan="1" class="confluenceTd"><code>getArchivedBlockItems()</code></td><td colspan="1" class="confluenceTd">Returns archived items (that were previously displayed), for a given block.</td><td colspan="1" class="confluenceTd"><code>eZ\Publish\Core\FieldType\Page\Parts\Item[]</code></td></tr><tr><td colspan="1" class="confluenceTd"><code>getValidBlockItemsAsContentInfo()</code></td><td colspan="1" class="confluenceTd">Returns valid block items as content objects</td><td colspan="1" class="confluenceTd"><code>eZ\Publish\API\Repository\Values\Content\ContentInfo[] </code></td></tr></tbody></table><h3><img class="editor-inline-macro" src="../servlet/confluence/placeholder/macroa2f5.png?definition=e2FuY2hvcjpFeGFtcGxlfQ&amp;locale=en_GB&amp;version=2" data-macro-name="anchor" data-macro-id="ed46334b-8bb0-47e3-aed1-611ed1f6e812" data-macro-default-parameter="Example" data-macro-schema-version="1">Example</h3><table class="wysiwyg-macro" data-macro-name="code" data-macro-id="d1549f2c-e88d-42c1-91fe-804837ca4735" data-macro-parameters="language=html/xml|title=2zoneslayout1.html.twig" data-macro-schema-version="1" style="background-image: url(../servlet/confluence/placeholder/macro-headinge57d.png?definition=e2NvZGU6bGFuZ3VhZ2U9aHRtbC94bWx8dGl0bGU9MnpvbmVzbGF5b3V0MS5odG1sLnR3aWd9&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="PLAIN_TEXT"><tr><td class="wysiwyg-macro-body"><pre>&lt;h2>Twig Template for 2 zoneslayout1 zone&lt;/h2>
&lt;div class="zone-layout-{{ zone_layout|lower }} row">
    &lt;div class="span8">
        &lt;section class="content-view-block">
        {% if zones[0].blocks %}
            {# Rendering blocks with default PageController #}
            {% for block in zones[0].blocks %}
                {{ render( controller( "ez_page:viewBlock", {'block': block} ) ) }}
            {% endfor %}
            &lt;div class="block-separator">&lt;/div>
        {% endif %}
        &lt;/section>
    &lt;/div>
    &lt;div class="span4">
        &lt;aside>
            &lt;section class="content-view-block content-view-aside">
            {% if zones[1].blocks %}
                {# Still rendering with default PageController, but passing specific cache value (TTL of 100 seconds) and using ESI #}
                {% for block in zones[1].blocks %}
                    {{ render_esi( controller( "ez_page:viewBlock", {'block': block, 'cacheSettings': {'smax-age': 100}} ) ) }}
                {% endfor %}
                &lt;div class="block-separator">&lt;/div>
            {% endif %}
            &lt;/section>
        &lt;/aside>
    &lt;/div>
&lt;/div></pre></td></tr></table><table class="wysiwyg-macro" data-macro-name="code" data-macro-id="ab64c27b-09e7-48d5-858b-addc8d5e06c1" data-macro-parameters="language=html/xml|title=campaign_block.html.twig" data-macro-schema-version="1" style="background-image: url(../servlet/confluence/placeholder/macro-heading00ce.png?definition=e2NvZGU6bGFuZ3VhZ2U9aHRtbC94bWx8dGl0bGU9Y2FtcGFpZ25fYmxvY2suaHRtbC50d2lnfQ&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="PLAIN_TEXT"><tr><td class="wysiwyg-macro-body"><pre>&lt;h3>Twig Template for Campaign Block type&lt;/h3>
{% set validContentInfoItems = pageService.getValidBlockItemsAsContentInfo( block ) %}
{% set validItems = pageService.getValidBlockItems( block ) %}
&lt;!-- BLOCK: START -->
&lt;div class="block-type-campaign">
    &lt;div class="campaign">
        &lt;a href="#" class="navig prev" style="opacity:0;">&lt;span class="hide">&amp;lt;&lt;/span>&lt;/a>
        &lt;a href="#" class="navig next">&lt;span class="hide">&amp;gt;&lt;/span>&lt;/a>
        &lt;ul class="indicator">
            {% for contentInfo in validContentInfoItems %}
                &lt;li>&lt;span>{{ contentInfo.name }} (#{{ contentInfo.id }})&lt;/span>&lt;/li>
            {% endfor %}
        &lt;/ul>
        &lt;ul class="images">
        {# Rendering valid items with regular view controller, with "block_item_campaign" view type #}
        {# Also passing an "image_class" parameter which will be available in sub-template. #}
        {% for item in validItems %}
            {{ render(
                controller(
                    'ez_content:viewLocation',
                    {
                        'locationId': item.locationId,
                        'viewType': 'block_item_campaign',
                        'params': {'image_class': 'campaign'}
                    }
                )
            ) }}
        {% endfor %}
        &lt;/ul>
    &lt;/div>
&lt;/div>
&lt;!-- BLOCK: END --></pre></td></tr></table>
        <p>&nbsp;</p>
    </body>

<!-- Mirrored from doc.ez.no/plugins/viewsource/viewpagesrc.action?pageId=30711418 by HTTrack Website Copier/3.x [XR&CO'2013], Tue, 31 Jan 2017 10:03:31 GMT -->
</html>
