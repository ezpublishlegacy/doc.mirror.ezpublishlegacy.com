                    
    
                    
    
                    
    
<!DOCTYPE html>
<html>
    
<!-- Mirrored from doc.ez.no/plugins/viewsource/viewpagesrc.action?pageId=31424917 by HTTrack Website Copier/3.x [XR&CO'2013], Tue, 31 Jan 2017 10:01:54 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head>
        <title>View Source</title>
        <link rel="canonical" href="../../pages/viewpage5e1e.html?pageId=31424917" />
        <script>
window.WRM=window.WRM||{};window.WRM._unparsedData=window.WRM._unparsedData||{};
WRM._unparsedData["com.atlassian.plugins.atlassian-plugins-webresource-rest:web-resource-manager.resource-base-url-pattern"]="\"(?:(?:/s/.*?/_)?/download)\"";
WRM._unparsedData["com.atlassian.plugins.atlassian-plugins-webresource-plugin:context-path.context-path"]="\"\"";
WRM._unparsedData["com.atlassian.plugins.browser.metrics.browser-metrics-plugin:browser-metrics.feature-data-provider-legacy"]="true";
</script>
<link type="text/css" rel="stylesheet" href="../../s/1b9968ac17721e3a6947d14e3a43c3f8-CDN/en_GB/5983/f3e491afc761ac0a6981cfa3dcbc04fc7e88c149.16/89/_/download/superbatch/css/batch9c16.css?build-number=5983" media="all">
<!--[if lt IE 9]>
<link type="text/css" rel="stylesheet" href="/s/d41d8cd98f00b204e9800998ecf8427e-CDN/en_GB/5983/f3e491afc761ac0a6981cfa3dcbc04fc7e88c149.16/89/_/download/superbatch/css/batch.css?conditionalComment=lt+IE+9" media="all">
<![endif]-->
<!--[if lte IE 9]>
<link type="text/css" rel="stylesheet" href="/s/d41d8cd98f00b204e9800998ecf8427e-CDN/en_GB/5983/f3e491afc761ac0a6981cfa3dcbc04fc7e88c149.16/89/_/download/superbatch/css/batch.css?conditionalComment=lte+IE+9" media="all">
<![endif]-->
<link type="text/css" rel="stylesheet" href="../../s/d41d8cd98f00b204e9800998ecf8427e-CDN/en_GB/5983/f3e491afc761ac0a6981cfa3dcbc04fc7e88c149.16/f3685658010e413141854089096800b5/_/download/contextbatch/css/plugin.viewsource/batch.css" media="all">
<link type="text/css" rel="stylesheet" href="../../s/df762e50bc83a9608020a1ff1476cda6-CDN/en_GB/5983/f3e491afc761ac0a6981cfa3dcbc04fc7e88c149.16/5a0f37b8e5a58a48983bc1f25fb099f6/_/download/contextbatch/css/page/batch.css" media="all">
<!--[if lt IE 9]>
<link type="text/css" rel="stylesheet" href="/s/d41d8cd98f00b204e9800998ecf8427e-CDN/en_GB/5983/f3e491afc761ac0a6981cfa3dcbc04fc7e88c149.16/5a0f37b8e5a58a48983bc1f25fb099f6/_/download/contextbatch/css/page/batch.css?conditionalComment=lt+IE+9" media="all">
<![endif]-->
<link type="text/css" rel="stylesheet" href="../../s/5714bd5a5c86641cad10106916cda7c8-CDN/en_GB/5983/f3e491afc761ac0a6981cfa3dcbc04fc7e88c149.16/49f5f7dfc888d48bff618d087d8044cc/_/download/contextbatch/css/editor-content/batch.css" media="all">
<!--[if lte IE 9]>
<link type="text/css" rel="stylesheet" href="/s/d41d8cd98f00b204e9800998ecf8427e-CDN/en_GB/5983/f3e491afc761ac0a6981cfa3dcbc04fc7e88c149.16/49f5f7dfc888d48bff618d087d8044cc/_/download/contextbatch/css/editor-content/batch.css?conditionalComment=lte+IE+9" media="all">
<![endif]-->
<link type="text/css" rel="stylesheet" href="../../s/en_GB/5983/f3e491afc761ac0a6981cfa3dcbc04fc7e88c149.16/8/_/styles/colors82a8.css?spaceKey=TECHDOC" media="all">
<link type="text/css" rel="stylesheet" href="../../s/en_GB/5983/f3e491afc761ac0a6981cfa3dcbc04fc7e88c149.16/8/_/styles/custom82a8.css?spaceKey=TECHDOC" media="all">

    </head>

    <body class="mceContentBody aui-theme-default wiki-content fullsize">
        <p>&nbsp;</p>         <p><img class="editor-inline-macro" src="../servlet/confluence/placeholder/macro4170.png?definition=e3RvY30&amp;locale=en_GB&amp;version=2" data-macro-name="toc" data-macro-id="58f14e86-302e-4a5b-986a-da2e14dbe2bf" data-macro-schema-version="1"></p><p>The JavaScript REST API Client is a JavaScript library meant to ease the use of the eZ Platform REST API. For now, it can only be used in a web browser.</p><h2>Installation</h2><h3>In the PlatformUIAssetsBundle</h3><p>Since the JavaScript REST Client is one of the foundations of <a class="confluence-link" href="../../display/TECHDOC/Backend%2binterface.html" data-linked-resource-id="30712101" data-linked-resource-version="11" data-linked-resource-type="page" data-linked-resource-default-alias="Backend interface" data-base-url="https://doc.ez.no">the Platform Backend Interface</a>, the client is provided by the <a href="https://github.com/ezsystems/PlatformUIAssetsBundle">PlatformUIAssetsBundle</a> which is installed by default. As a result, the client is directly available and can be embedded in any Platform-generated page with the following Twig code:</p><table class="wysiwyg-macro" data-macro-name="code" data-macro-id="3318f61a-9d36-49cc-b247-f7ed49962618" data-macro-parameters="language=xml|theme=Midnight|title=Embedding the JavaScript REST Client" data-macro-schema-version="1" style="background-image: url(../servlet/confluence/placeholder/macro-headingbc6c.png?definition=e2NvZGU6bGFuZ3VhZ2U9eG1sfHRoZW1lPU1pZG5pZ2h0fHRpdGxlPUVtYmVkZGluZyB0aGUgSmF2YVNjcmlwdCBSRVNUIENsaWVudH0&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="PLAIN_TEXT"><tr><td class="wysiwyg-macro-body"><pre>&lt;script src="{{ asset('bundles/ezplatformuiassets/vendors/ez-js-rest-client/dist/CAPI.js') }}">&lt;/script>
&lt;!-- or the minified version -->
&lt;!-- &lt;script src="{{ asset('bundles/ezplatformuiassets/vendors/ez-js-rest-client/dist/CAPI-min.js') }}">&lt;/script> --></pre></td></tr></table><h3>With Bower</h3><p>Alternatively, the JavaScript REST Client can be installed directly in any project with <a href="http://bower.io/">Bower</a>:</p><table class="wysiwyg-macro" data-macro-name="code" data-macro-id="8bdfb15f-65b0-4b79-8dd5-d774afecf43f" data-macro-parameters="language=bash|theme=Midnight|title=Installing with bower" data-macro-schema-version="1" style="background-image: url(../servlet/confluence/placeholder/macro-heading31ff.png?definition=e2NvZGU6bGFuZ3VhZ2U9YmFzaHx0aGVtZT1NaWRuaWdodHx0aXRsZT1JbnN0YWxsaW5nIHdpdGggYm93ZXJ9&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="PLAIN_TEXT"><tr><td class="wysiwyg-macro-body"><pre>$ bower install --save ezsystems/ez-js-rest-client</pre></td></tr></table><p>After using this command, <code>dist/CAPI.js</code> or <code>dist/CAPI-min.js</code> are available in <code>bower\_components/ez-js-rest-client/</code>.</p><h3>Manual install</h3><p>It is also possible to directly retrieve either <code>dist/CAPI.js</code> or <code>dist/CAPI-min.js</code> in <a href="https://github.com/ezsystems/ez-js-rest-client/">the Github repository of the project</a>.</p><h2>Usage examples</h2><p>Once included, <code>CAPI.js</code> exports the <code>eZ</code> namespace which contains <code>eZ.CAPI</code>, the constructor function of the client. This constructor must receive the API end point and an authentication agent responsible for handling the authentication (session or basic auth). This is detailed in the <a href="../../index.html#UsingtheJavaScriptRESTAPIClient-Instantiationandauthentication">Instantiation and authentication</a> section below.</p><p><a href="http://ezsystems.github.io/javascript-rest-client">The auto-generated API documentation of the JavaScript REST API client is available online.</a> Like in the Public API, the code is organized around 3 main services:</p><ul><li><a href="http://ezsystems.github.io/javascript-rest-client/classes/ContentService.html">the Content Service</a></li><li><a href="http://ezsystems.github.io/javascript-rest-client/classes/ContentTypeService.html">the Content Type Service</a></li><li><a href="http://ezsystems.github.io/javascript-rest-client/classes/UserService.html">the User Service</a></li></ul><p>In essence, the operations available through those services are asynchronous, so all the corresponding methods accept a callback function as its last argument. This callback function will be called when the operation has been done and it will receive two arguments:</p><ol><li><code>error</code>: depending on the success of the operation, this parameter is either <code>false</code> or a <a href="http://ezsystems.github.io/javascript-rest-client/classes/CAPIError.html"><code>CAPIError</code></a> instance representing the error</li><li><code>response</code>: it's always of a <a href="http://ezsystems.github.io/javascript-rest-client/classes/Response.html"><code>Response</code></a> instance allowing you to retrieve any information from the REST API response</li></ol><h3>Instantiation and authentication</h3><p><a href="http://ezsystems.github.io/javascript-rest-client/classes/CAPI.html">The <code>eZ.CAPI</code> constructor function</a> expects two parameters:</p><ol><li>the API end point URI</li><li>an authentication agent instance to configure the client for <a class="confluence-link" href="../../display/TECHDOC/REST%2bAPI%2bAuthentication.html" data-linked-resource-id="30711248" data-linked-resource-version="4" data-linked-resource-type="page" data-linked-resource-default-alias="REST API Authentication" data-base-url="../../index.html">the authentication mechanism configuration in eZ Platform</a>.</li></ol><p>The JavaScript REST Client comes with two authentication agents for the Session and Basic Auth authentication mechanism.</p><h4>Session auth</h4><p>The Session Auth Agent expects an object describing the existing Session or containing the credentials for the user to create the corresponding session. So if the user is not yet authenticated, the client can be instantiated with:</p><table class="wysiwyg-macro" data-macro-name="code" data-macro-id="f6d2aeea-f38f-4c00-8e34-376d73e2d992" data-macro-parameters="language=js|theme=Midnight|title=Session Authentication (new session)" data-macro-schema-version="1" style="background-image: url(../servlet/confluence/placeholder/macro-heading6327.png?definition=e2NvZGU6bGFuZ3VhZ2U9anN8dGhlbWU9TWlkbmlnaHR8dGl0bGU9U2Vzc2lvbiBBdXRoZW50aWNhdGlvbiAobmV3IHNlc3Npb24pfQ&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="PLAIN_TEXT"><tr><td class="wysiwyg-macro-body"><pre>var capi,
    credentials = {
        login: 'admin',
        password: 'publish',
    };

capi = new eZ.CAPI(
    'http://example.com',
    new eZ.SessionAuthAgent(credentials)
);
capi.logIn(function (error, response) {
    if ( error ) {
        console.log('Error!');
        return;
    }
    console.log("I'm logged in");
});</pre></td></tr></table><table class="wysiwyg-macro" data-macro-name="info" data-macro-id="7425ba39-4dfb-40f7-82a4-ba21fe1a4351" data-macro-schema-version="1" style="background-image: url(../servlet/confluence/placeholder/macro-headingd35c.png?definition=e2luZm99&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="RICH_TEXT"><tr><td class="wysiwyg-macro-body"><p>Instead of passing the <code>credentials</code> to the <code>eZ.SessionAuthAgent</code> constructor, it is also possible to pass this object as <a href="http://ezsystems.github.io/javascript-rest-client/classes/CAPI.html#method_logIn">the first parameter of the <code>logIn</code> method</a>.</p></td></tr></table><p>If the user already has a session, the agent expects an object describing the session, something like:</p><table class="wysiwyg-macro" data-macro-name="code" data-macro-id="be688d61-c193-49c9-b5b9-45e6cea49df9" data-macro-parameters="language=js|theme=Midnight|title=Session Authentication (existing session)" data-macro-schema-version="1" style="background-image: url(../servlet/confluence/placeholder/macro-heading6e3f.png?definition=e2NvZGU6bGFuZ3VhZ2U9anN8dGhlbWU9TWlkbmlnaHR8dGl0bGU9U2Vzc2lvbiBBdXRoZW50aWNhdGlvbiAoZXhpc3Rpbmcgc2Vzc2lvbil9&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="PLAIN_TEXT"><tr><td class="wysiwyg-macro-body"><pre>var capi,
    sessionInfo = {
        name: 'eZSESSID', // name of the session, might also be something like eZSESSID98defd6ee70dfb1dea416cecdf391f58
        identifier: '6pp87ah63m44jdf53b35qlt2i7', // session id
        href: '/api/ezp/v2/user/sessions/6pp87ah63m44jdf53b35qlt2i7',
        csrfToken: 'memEneT7WvX9WmSlG2wDqUj0eeLRC7hXG--pLUx4dFE', // can be retrieved with @security.csrf.token_manager Symfony service
    };

capi = new eZ.CAPI(
    'http://example.com',
    new eZ.SessionAuthAgent(sessionInfo)
);
capi.isLoggedIn(function (error, response) {
    if ( error ) {
        console.log('Error!');
        return;
    }
    console.log("I'm logged in");
});</pre></td></tr></table><h4>Basic auth</h4><p>When configured in the Basic Authentication, the basic auth agent just expects the user's credentials:</p><table class="wysiwyg-macro" data-macro-name="code" data-macro-id="b2496119-4b81-4512-a167-d975e8ff85ca" data-macro-parameters="language=js|theme=Midnight|title=Basic Authentication" data-macro-schema-version="1" style="background-image: url(../servlet/confluence/placeholder/macro-headingf9c9.png?definition=e2NvZGU6bGFuZ3VhZ2U9anN8dGhlbWU9TWlkbmlnaHR8dGl0bGU9QmFzaWMgQXV0aGVudGljYXRpb259&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="PLAIN_TEXT"><tr><td class="wysiwyg-macro-body"><pre>var capi,
    credentials = {
        login: 'admin',
        password: 'publish',
    };

capi = new eZ.CAPI(
    'http://example.com',
    new eZ.HttpBasicAuthAgent(credentials)
);
capi.logIn(function (error, response) {
    if ( error ) {
        console.log('Error!');
        return;
    }
    console.log("The credentials are valid");
});</pre></td></tr></table><h3>Loading a ContentInfo or a Content</h3><p>To load a ContentInfo, you need <a href="http://ezsystems.github.io/javascript-rest-client/classes/ContentService.html">the Content Service</a>, it is returned by the <code>getContentService</code> method on the client instance:</p><table class="wysiwyg-macro" data-macro-name="code" data-macro-id="1b2ed807-15a6-48b0-8238-3fe179970832" data-macro-parameters="language=js|theme=Midnight|title=Loading a ContentInfo" data-macro-schema-version="1" style="background-image: url(../servlet/confluence/placeholder/macro-headingde81.png?definition=e2NvZGU6bGFuZ3VhZ2U9anN8dGhlbWU9TWlkbmlnaHR8dGl0bGU9TG9hZGluZyBhIENvbnRlbnRJbmZvfQ&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="PLAIN_TEXT"><tr><td class="wysiwyg-macro-body"><pre>var capi, contentService,
    contentRestId = '/api/ezp/v2/content/objects/1',
    credentials = {
        login: 'admin',
        password: 'publish',
    };

capi = new eZ.CAPI(
    'http://example.com',
    new eZ.SessionAuthAgent(credentials)
);
contentService = capi.getContentService();
contentService.loadContentInfo(contentRestId, function (error, response) {
    if ( error ) {
        console.log('Error!');
        return;
    }
    // response.document contains the parsed JSON structure
    console.log('Content name: ' + response.document.Content.Name);
})</pre></td></tr></table><p>If you run this example, you should see in the browser network panel a GET HTTP request to <a href="http://example.com/api/ezp/v2/content/objects/1">http://example.com/api/ezp/v2/content/objects/1</a> with the necessary headers to get a JSON representation of the ContentInfo. If you want to load the Content instead, you can use <a href="http://ezsystems.github.io/javascript-rest-client/classes/ContentService.html#method_loadContent">the <code>loadContent</code> method</a>.</p><h3>Moving a Location</h3><p>To move a Location, <a href="http://ezsystems.github.io/javascript-rest-client/classes/ContentService.html">the Content Service</a> is also needed, this operation will generate a MOVE HTTP request. If configured for the session authentication mechanism, the client will automatically add the CSRF Token.</p><table class="wysiwyg-macro" data-macro-name="code" data-macro-id="ed7b409f-107d-4a90-abb0-115509a11e24" data-macro-parameters="language=js|theme=Midnight|title=Moving a Location" data-macro-schema-version="1" style="background-image: url(../servlet/confluence/placeholder/macro-heading665c.png?definition=e2NvZGU6bGFuZ3VhZ2U9anN8dGhlbWU9TWlkbmlnaHR8dGl0bGU9TW92aW5nIGEgTG9jYXRpb259&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="PLAIN_TEXT"><tr><td class="wysiwyg-macro-body"><pre>var capi, contentService,
    locationRestId = '/api/ezp/v2/content/locations/1/43/53', // Media/Multimedia in a default install
    newParentLocationRestId = '/api/ezp/v2/content/locations/1/43/52', // Media/Files in a default install
    credentials = {
        login: 'admin',
        password: 'publish',
    };

capi = new eZ.CAPI(
    'http://example.com',
    new eZ.SessionAuthAgent(credentials)
);
contentService = capi.getContentService();
contentService.moveSubtree(locationRestId, newParentLocationRestId, function (error, response) {
    if ( error ) {
        console.log('Error!');
        return;
    }
    console.log('Media/Multimedia is now Media/Files/Multimedia');
})</pre></td></tr></table><h3>Searching for Content or Location</h3><p>Searching for Content or Location can be done with <a href="https://github.com/ezsystems/ezpublish-kernel/blob/master/doc/specifications/rest/REST-API-V2.rst#views">REST views</a>. REST views can be configured with <a class="confluence-link" href="../../display/TECHDOC/Criteria%2breference.html" data-linked-resource-id="30711488" data-linked-resource-version="3" data-linked-resource-type="page" data-linked-resource-default-alias="Criteria reference" data-base-url="../../index.html">the search engine criteria</a> to match some Content items or Locations:</p><table class="wysiwyg-macro" data-macro-name="code" data-macro-id="20e90933-96ef-4e65-8dfd-7914166a63ec" data-macro-parameters="language=js|theme=Midnight|title=REST views" data-macro-schema-version="1" style="background-image: url(../servlet/confluence/placeholder/macro-headinga584.png?definition=e2NvZGU6bGFuZ3VhZ2U9anN8dGhlbWU9TWlkbmlnaHR8dGl0bGU9UkVTVCB2aWV3c30&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="PLAIN_TEXT"><tr><td class="wysiwyg-macro-body"><pre>var capi, contentService, query,
   Â credentials = {
        login: 'admin',
        password: 'publish',
    };

capi = new eZ.CAPI(
    'http://example.com',
    new eZ.SessionAuthAgent(credentials)
);
contentService = capi.getContentService();
query = contentService.newViewCreateStruct('test-rest-view', 'LocationQuery'); // use 'ContentQuery' to retrieve a list of Content items
query.body.ViewInput.LocationQuery.Criteria = { // use 'ContentQuery' here as well
    FullTextCriterion: "ez",
};
query.body.ViewInput.LocationQuery.limit = 10;
// query.body.ViewInput.LocationQuery.offset = 0;
contentService.createView(query, function (error, response) {
    if ( error ) {
        console.log('Error!');
        return;
    }
    console.log("Search results", response.document.View.Result.searchHits.searchHit);
})</pre></td></tr></table><table class="wysiwyg-macro" data-macro-name="info" data-macro-id="c417ddba-bdfb-488d-9aa0-f821d56b253c" data-macro-parameters="title=REST views" data-macro-schema-version="1" style="background-image: url(../servlet/confluence/placeholder/macro-heading9c25.png?definition=e2luZm86dGl0bGU9UkVTVCB2aWV3c30&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="RICH_TEXT"><tr><td class="wysiwyg-macro-body"><p>REST views are designed to be persisted but this feature is not yet implemented. As a result, when calling <code>createView</code>, the POST request does not create the view but directly returns the results.</p></td></tr></table>
        <p>&nbsp;</p>
    </body>

<!-- Mirrored from doc.ez.no/plugins/viewsource/viewpagesrc.action?pageId=31424917 by HTTrack Website Copier/3.x [XR&CO'2013], Tue, 31 Jan 2017 10:01:58 GMT -->
</html>
