                    
    
                    
    
                    
    
<!DOCTYPE html>
<html>
    
<!-- Mirrored from doc.ez.no/plugins/viewsource/viewpagesrc.action?pageId=12781275 by HTTrack Website Copier/3.x [XR&CO'2013], Tue, 21 Oct 2014 13:51:12 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head>
        <title>View Source</title>
        <link rel="canonical" href="../../pages/viewpage4a92.html?pageId=12781275" />
        <link type="text/css" rel="stylesheet" href="../../s/d41d8cd98f00b204e9800998ecf8427e/en_GB-1988229788/4733/f235dd088df5682b0560ab6fc66ed22c9124c0be.12/73/_/download/superbatch/css/batch.css" media="all">
<link type="text/css" rel="stylesheet" href="../../s/d41d8cd98f00b204e9800998ecf8427e/en_GB-1988229788/4733/f235dd088df5682b0560ab6fc66ed22c9124c0be.12/73/_/download/superbatch/css/batch934e.css?media=print" media="print">
<!--[if lt IE 9]>
<link type="text/css" rel="stylesheet" href="/s/d41d8cd98f00b204e9800998ecf8427e/en_GB-1988229788/4733/f235dd088df5682b0560ab6fc66ed22c9124c0be.12/73/_/download/superbatch/css/batch.css?conditionalComment=lt+IE+9" media="all">
<![endif]-->
<!--[if lte IE 8]>
<link type="text/css" rel="stylesheet" href="/s/d41d8cd98f00b204e9800998ecf8427e/en_GB-1988229788/4733/f235dd088df5682b0560ab6fc66ed22c9124c0be.12/73/_/download/superbatch/css/batch.css?conditionalComment=lte+IE+8" media="all">
<![endif]-->
<!--[if lte IE 9]>
<link type="text/css" rel="stylesheet" href="/s/d41d8cd98f00b204e9800998ecf8427e/en_GB-1988229788/4733/f235dd088df5682b0560ab6fc66ed22c9124c0be.12/73/_/download/superbatch/css/batch.css?conditionalComment=lte+IE+9" media="all">
<![endif]-->
<link type="text/css" rel="stylesheet" href="../../s/d41d8cd98f00b204e9800998ecf8427e/en_GB-1988229788/4733/f235dd088df5682b0560ab6fc66ed22c9124c0be.12/1f2a9c4c7f2593422cc9b02d1a652a22/_/download/contextbatch/css/plugin.viewsource/batch.css" media="all">
<link type="text/css" rel="stylesheet" href="../../s/d41d8cd98f00b204e9800998ecf8427e/en_GB-1988229788/4733/f235dd088df5682b0560ab6fc66ed22c9124c0be.12/70f6d025b64de5008ccd042576cd8d90/_/download/contextbatch/css/page/batch.css" media="all">
<!--[if lt IE 9]>
<link type="text/css" rel="stylesheet" href="/s/d41d8cd98f00b204e9800998ecf8427e/en_GB-1988229788/4733/f235dd088df5682b0560ab6fc66ed22c9124c0be.12/70f6d025b64de5008ccd042576cd8d90/_/download/contextbatch/css/page/batch.css?conditionalComment=lt+IE+9" media="all">
<![endif]-->
<link type="text/css" rel="stylesheet" href="../../s/d41d8cd98f00b204e9800998ecf8427e/en_GB-1988229788/4733/f235dd088df5682b0560ab6fc66ed22c9124c0be.12/26ac2724af3c6ece1051365650d982fa/_/download/contextbatch/css/editor-content/batch.css" media="all">
<link type="text/css" rel="stylesheet" href="../../s/d41d8cd98f00b204e9800998ecf8427e/en_GB-1988229788/4733/f235dd088df5682b0560ab6fc66ed22c9124c0be.12/1.3/_/download/batch/com.atlassian.confluence.plugins.confluence-hig/com.atlassian.confluence.plugins.confluence-highlight-ac" media="all">
<!--[if lt IE 9]>
<link type="text/css" rel="stylesheet" href="/s/d41d8cd98f00b204e9800998ecf8427e/en_GB-1988229788/4733/f235dd088df5682b0560ab6fc66ed22c9124c0be.12/1.3/_/download/batch/com.atlassian.confluence.plugins.confluence-highlight-actions:highlighting-experiment-resources/com.atlassian.confluence.plugins.confluence-highlight-actions:highlighting-experiment-resources.css?conditionalComment=lt+IE+9" media="all">
<![endif]-->
<link type="text/css" rel="stylesheet" href="../../s/en_GB-1988229788/4733/f235dd088df5682b0560ab6fc66ed22c9124c0be.12/12/_/styles/colors.css" media="all">

    </head>

    <body class="mceContentBody aui-theme-default wiki-content fullsize">
        <p>&nbsp;</p>         <p><img class="editor-inline-macro" src="../servlet/confluence/placeholder/macrob964.png?definition=e2V4Y2VycHQtaW5jbHVkZTplWiBQdWJsaXNoIERvY3VtZW50YXRpb259&amp;locale=en_GB&amp;version=2" data-macro-name="excerpt-include" data-macro-default-parameter="eZ Publish Documentation"></p><p><img class="editor-inline-macro" src="../servlet/confluence/placeholder/macro4170.png?definition=e3RvY30&amp;locale=en_GB&amp;version=2" data-macro-name="toc"></p><p>In the following recipes, you will see how to create Content, including complex fields like XmlText or Image.</p><h2>Identifying to the repository with a login and a password</h2><p>As seen earlier, the Repository executes operations with a user's credentials. In a web context, the currently logged in user is automatically identified. In a command line context, you need to manually log a user in. We have already seen how to manually load and set a user using its ID. If you would like to identify a user using his username and password instead, this can be achieved as follows.</p><table class="wysiwyg-macro" data-macro-name="code" data-macro-parameters="language=php|title=authentication " style="background-image: url(../servlet/confluence/placeholder/macro-heading4bcf.png?definition=e2NvZGU6dGl0bGU9YXV0aGVudGljYXRpb24gfGxhbmd1YWdlPXBocH0&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="PLAIN_TEXT"><tr><td class="wysiwyg-macro-body"><pre>$user = $userService->loadUserByCredentials( $user, $password );
$repository->setCurrentUser( $user );</pre></td></tr></table><h2>Creating content</h2><table class="wysiwyg-macro" data-macro-name="info" data-macro-parameters="title=Full code" style="background-image: url(../servlet/confluence/placeholder/macro-headingecc6.png?definition=e2luZm86dGl0bGU9RnVsbCBjb2RlfQ&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="RICH_TEXT"><tr><td class="wysiwyg-macro-body"><p><a href="https://github.com/ezsystems/CookbookBundle/blob/master/Command/CreateContentCommand.php">https://github.com/ezsystems/CookbookBundle/blob/master/Command/CreateContentCommand.php</a></p></td></tr></table><p>We will now see how to create Content using the Public API. This example will work with the default Folder (ID 1) Content Type from eZ Publish.</p><table class="wysiwyg-macro" data-macro-name="code" data-macro-parameters="language=php" style="background-image: url(../servlet/confluence/placeholder/macro-heading1802.png?definition=e2NvZGU6bGFuZ3VhZ2U9cGhwfQ&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="PLAIN_TEXT"><tr><td class="wysiwyg-macro-body"><pre>/** @var $repository \eZ\Publish\API\Repository\Repository */
$repository = $this->getContainer()->get( 'ezpublish.api.repository' );
$contentService = $repository->getContentService();
$locationService = $repository->getLocationService();
$contentTypeService = $repository->getContentTypeService();</pre></td></tr></table><p>We first need the required services. In this case: <code>ContentService</code>, <code>LocationService</code> and <code>ContentTypeService</code>.</p><h3>The ContentCreateStruct</h3><p>As explained in the <a class="confluence-link" href="../../display/EZP51/Public%2bAPI%2bbasics.html" data-linked-resource-id="12125354" data-linked-resource-type="page" data-linked-resource-default-alias="Public API basics" data-base-url="../../index.html">Public API Basics</a>, Value Objects are read only. Dedicated objects are provided for Update and Create operations: structs, like ContentCreateStruct or UpdateCreateStruct. In this case, we need to use a ContentCreateStruct. </p><table class="wysiwyg-macro" data-macro-name="code" data-macro-parameters="language=php" style="background-image: url(../servlet/confluence/placeholder/macro-heading1802.png?definition=e2NvZGU6bGFuZ3VhZ2U9cGhwfQ&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="PLAIN_TEXT"><tr><td class="wysiwyg-macro-body"><pre>$contentType = $contentTypeService->loadContentTypeByIdentifier( 'article' );
$contentCreateStruct = $contentService->newContentCreateStruct( $contentType, 'eng-GB' );</pre></td></tr></table><p>We first need to get the <a href="http://ezsystems.github.com/ezpublish-kernel/sami/eZ/Publish/API/Repository/Values/ContentType/ContentType"><code>ContentType</code></a> we want to create a <code>Content</code> with. To do so, we use <a href="http://ezsystems.github.com/ezpublish-kernel/sami/eZ/Publish/API/Repository/ContentTypeService#method_loadContentTypeByIdentifier"><code>ContentTypeService::loadContentTypeByIdentifier()</code></a>, with the wanted <code>ContentType</code> identifier, like 'article'. We finally get a ContentTypeCreateStruct using <a href="http://ezsystems.github.com/ezpublish-kernel/sami/eZ/Publish/API/Repository/ContentService#method_newContentCreateStruct"><code>ContentService::newContentCreateStruct()</code></a>, providing the ContentType and a Locale Code (eng-GB).</p><h3>Setting the fields values</h3><table class="wysiwyg-macro" data-macro-name="code" data-macro-parameters="language=php" style="background-image: url(../servlet/confluence/placeholder/macro-heading1802.png?definition=e2NvZGU6bGFuZ3VhZ2U9cGhwfQ&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="PLAIN_TEXT"><tr><td class="wysiwyg-macro-body"><pre>$contentCreateStruct->setField( 'title', 'My title' );
$contentCreateStruct->setField( 'intro', $intro );
$contentCreateStruct->setField( 'body', $body );</pre></td></tr></table><p>Using our create struct, we can now set the values for our Content's fields, using the <a href="http://ezsystems.github.com/ezpublish-kernel/sami/eZ/Publish/API/Repository/Values/Content/ContentCreateStruct"><code>setField()</code></a> method. For now, we will just set the title. <code>setField()</code> for a TextLine Field simply expects a string as input argument. More complex FieldTypes, like Author or Image, expect different input values.</p><table class="wysiwyg-macro" data-macro-name="note" style="background-image: url(../servlet/confluence/placeholder/macro-headingdd57.png?definition=e25vdGV9&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="RICH_TEXT"><tr><td class="wysiwyg-macro-body"><p>The <code>ContentCreateStruct::setField()</code> method can take several type of arguments.</p><p>In any case, whatever the FieldType is, a Value of this type can be provided. For instance, a TextLine\Value can be provided for a TextLine\Type. Depending on the FieldType implementation itself, more specifically on the fromHash() method every FieldType implements, various arrays can be accepted, as well as primitive types, depending on the Type.</p></td></tr></table><h3>Setting the Location</h3><p>In order to set a Location for our object, we must instantiate a <a href="http://ezsystems.github.com/ezpublish-kernel/sami/eZ/Publish/API/Repository/Values/Content/LocationCreateStruct"><code>LocationCreateStruct</code></a>. This is done with LocationService::newLocationCreateStruct(), with the new Location's parent ID as an argument.</p><table class="wysiwyg-macro" data-macro-name="code" data-macro-parameters="language=php" style="background-image: url(../servlet/confluence/placeholder/macro-heading1802.png?definition=e2NvZGU6bGFuZ3VhZ2U9cGhwfQ&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="PLAIN_TEXT"><tr><td class="wysiwyg-macro-body"><pre>$locationCreateStruct = $locationService->newLocationCreateStruct( 2 );</pre></td></tr></table><h3>Creating and publishing</h3><p>To actually create our Content in the Repository, we need to use ContentService::createContent(). This method expects a <code>ContentCreateStruct</code>, as well as a <code>LocationCreateStruct</code>. We have created both in the previous steps.</p><table class="wysiwyg-macro" data-macro-name="code" data-macro-parameters="language=php" style="background-image: url(../servlet/confluence/placeholder/macro-heading1802.png?definition=e2NvZGU6bGFuZ3VhZ2U9cGhwfQ&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="PLAIN_TEXT"><tr><td class="wysiwyg-macro-body"><pre>$draft = $contentService->createContent( $contentCreateStruct, array( $locationCreateStruct ) );
$content = $contentService->publishVersion( $draft->versionInfo );</pre></td></tr></table><p>The LocationCreateStruct is provided as an array, since a Content can have multiple locations.</p><p><code>createContent()</code> returns a new Content Value Object, with one version that has the DRAFT status. To make this Content visible, we need to publish it. This is done using <code>ContentService::publishVersion()</code>. This method expects a <code>VersionInfo</code> object as its parameter. In our case, we simply use the current version from <code>$draft</code>, with the <code>versionInfo</code> property.</p><h2>Updating Content</h2><table class="wysiwyg-macro" data-macro-name="info" data-macro-parameters="title=Full code" style="background-image: url(../servlet/confluence/placeholder/macro-headingecc6.png?definition=e2luZm86dGl0bGU9RnVsbCBjb2RlfQ&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="RICH_TEXT"><tr><td class="wysiwyg-macro-body"><p><a href="https://github.com/ezsystems/CookbookBundle/blob/master/Command/UpdateContentCommand.php">https://github.com/ezsystems/CookbookBundle/blob/master/Command/UpdateContentCommand.php</a></p></td></tr></table><p>We will now see how the previously created Content can be updated. To do so, we will create a new draft for our Content, update it using a <a href="http://ezsystems.github.com/ezpublish-kernel/sami/eZ/Publish/API/Repository/Values/Content/ContentUpdateStruct"><code>ContentUpdateStruct</code></a>, and publish the updated Version.</p><table class="wysiwyg-macro" data-macro-name="code" data-macro-parameters="language=php" style="background-image: url(../servlet/confluence/placeholder/macro-heading1802.png?definition=e2NvZGU6bGFuZ3VhZ2U9cGhwfQ&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="PLAIN_TEXT"><tr><td class="wysiwyg-macro-body"><pre>$contentInfo = $contentService->loadContentInfo( $contentId );
$contentDraft = $contentService->createContentDraft( $contentInfo );</pre></td></tr></table><p>To create our draft, we need to load the Content's ContentInfo using <code>ContentService::loadContentInfo()</code>. We can then use <code>ContentService::createContentDraft()</code> to add a new Draft to our Content.</p><table class="wysiwyg-macro" data-macro-name="code" data-macro-parameters="language=php" style="background-image: url(../servlet/confluence/placeholder/macro-heading1802.png?definition=e2NvZGU6bGFuZ3VhZ2U9cGhwfQ&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="PLAIN_TEXT"><tr><td class="wysiwyg-macro-body"><pre>// instantiate a content update struct and set the new fields
$contentUpdateStruct = $contentService->newContentUpdateStruct();
$contentUpdateStruct->initialLanguageCode = 'eng-GB'; // set language for new version
$contentUpdateStruct->setField( 'title', $newTitle );
$contentUpdateStruct->setField( 'body', $newBody );</pre></td></tr></table><p>To set the new values for this version, we request a <code>ContentUpdateStruct</code> from the <code>ContentService</code> using the <code>newContentUpdateStruct()</code> method. Updating the values hasn't changed: we use the <code>setField()</code> method.</p><table class="wysiwyg-macro" data-macro-name="code" data-macro-parameters="language=php" style="background-image: url(../servlet/confluence/placeholder/macro-heading1802.png?definition=e2NvZGU6bGFuZ3VhZ2U9cGhwfQ&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="PLAIN_TEXT"><tr><td class="wysiwyg-macro-body"><pre>$contentDraft = $contentService->updateContent( $contentDraft->versionInfo, $contentUpdateStruct );
$content = $contentService->publishVersion( $contentDraft->versionInfo );</pre></td></tr></table><p>We can now use <code>ContentService::updateContent()</code> to apply our <code>ContentUpdateStruct</code> to our draft's <code>VersionInfo</code>. Publishing is done exactly the same way as for a new content, using <code>ContentService::publishVersion()</code>.</p><h2>Handling translations</h2><p>In the two previous examples, you have seen that we set the ContentUpdateStruct's initialLanguageCode property. To translate an object to a new language, set the locale to a new one.</p><table class="wysiwyg-macro" data-macro-name="code" data-macro-parameters="language=php|title=translating" style="background-image: url(../servlet/confluence/placeholder/macro-headingbeda.png?definition=e2NvZGU6dGl0bGU9dHJhbnNsYXRpbmd8bGFuZ3VhZ2U9cGhwfQ&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="PLAIN_TEXT"><tr><td class="wysiwyg-macro-body"><pre>$contentUpdateStruct->initialLanguageCode = 'ger-DE';
$contentUpdateStruct->setField( 'title', $newtitle );
$contentUpdateStruct->setField( 'body', $newbody );</pre></td></tr></table><p>It is possible to create or update content in multiple languages at once. There is one restriction: only one language can be set a version's language. This language is the one that will get a flag in the back office. However, you can set values in other languages for your attributes, using the setField method's third argument.</p><table class="wysiwyg-macro" data-macro-name="code" data-macro-parameters="language=php|title=update multiple languages" style="background-image: url(../servlet/confluence/placeholder/macro-heading7f0a.png?definition=e2NvZGU6dGl0bGU9dXBkYXRlIG11bHRpcGxlIGxhbmd1YWdlc3xsYW5ndWFnZT1waHB9&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="PLAIN_TEXT"><tr><td class="wysiwyg-macro-body"><pre>// set one language for new version
$contentUpdateStruct->initialLanguageCode = 'fre-FR';

$contentUpdateStruct->setField( 'title', $newgermantitle, 'ger-DE' );
$contentUpdateStruct->setField( 'body', $newgermanbody, 'ger-DE' );

$contentUpdateStruct->setField( 'title', $newfrenchtitle );
$contentUpdateStruct->setField( 'body', $newfrenchbody );
</pre></td></tr></table><p>Since we don't specify a locale for the last two fields, they are set for the <code>UpdateStruct</code>'s <code>initialLanguageCode</code>, fre-FR.</p><h2>Creating Content containing an image</h2><table class="wysiwyg-macro" data-macro-name="info" data-macro-parameters="title=Full code" style="background-image: url(../servlet/confluence/placeholder/macro-headingecc6.png?definition=e2luZm86dGl0bGU9RnVsbCBjb2RlfQ&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="RICH_TEXT"><tr><td class="wysiwyg-macro-body"><p><a href="https://github.com/ezsystems/CookbookBundle/blob/master/Command/CreateImageCommand.php">https://github.com/ezsystems/CookbookBundle/blob/master/Command/CreateImageCommand.php</a></p></td></tr></table><p>As explained above, the setField() method can accept various values: an instance of the FieldType's Value class, a primitive type, or a hash. The last two depend on what the <code>Type::acceptValue()</code> method is build up to handle. TextLine can, for instance, accept a simple string as an input value. In this example, you will see how to set an Image value.</p><p>We assume that we use the default image class. Creating our Content, using the ContentType and a ContentCreateStruct, has been covered above, and can be found in the full code. Let's focus on how the image is provided.</p><table class="wysiwyg-macro" data-macro-name="code" data-macro-parameters="language=php" style="background-image: url(../servlet/confluence/placeholder/macro-heading1802.png?definition=e2NvZGU6bGFuZ3VhZ2U9cGhwfQ&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="PLAIN_TEXT"><tr><td class="wysiwyg-macro-body"><pre>$file = '/path/to/image.png';

$value = new \eZ\Publish\Core\FieldType\Image\Value(
    array(
        'path' => '/path/to/image.png',
        'fileSize' => filesize( '/path/to/image.png' ),
        'fileName' => basename( 'image.png' ),
        'alternativeText' => 'My image'
    )
);
$contentCreateStruct->setField( 'image', $value );</pre></td></tr></table><p>This time, we create our image by directly providing an <a href="http://ezsystems.github.com/ezpublish-kernel/sami/eZ/Publish/Core/FieldType/Image/Value"><code>Image\Value</code></a> object. The values are directly provided to the constructor using a hash with predetermined keys that depend on each Type. In this case: the path where the image can be found, its size, the file name, and an alternative text.</p><p>Images also implement a static <a href="http://ezsystems.github.com/ezpublish-kernel/sami/eZ/Publish/Core/FieldType/Image/Value#method_fromString"><code>fromString()</code></a> method that will, given a path to an image, return an <code>Image\Value</code> object.</p><table class="wysiwyg-macro" data-macro-name="code" data-macro-parameters="language=php" style="background-image: url(../servlet/confluence/placeholder/macro-heading1802.png?definition=e2NvZGU6bGFuZ3VhZ2U9cGhwfQ&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="PLAIN_TEXT"><tr><td class="wysiwyg-macro-body"><pre>$value = \eZ\Publish\Core\FieldType\Image\Value::fromString( '/path/to/image.png' );</pre></td></tr></table><p>But as said before, whatever you provide <code>setField()</code> with is sent to the <code>acceptValue()</code> method. This method really is the entry point to the input formats a FieldType accepts. In this case, you could have provided setField with either a hash, similar to the one we provided the Image\Value constructor with, or the path to your image, as a string.</p><table class="wysiwyg-macro" data-macro-name="code" data-macro-parameters="language=php" style="background-image: url(../servlet/confluence/placeholder/macro-heading1802.png?definition=e2NvZGU6bGFuZ3VhZ2U9cGhwfQ&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="PLAIN_TEXT"><tr><td class="wysiwyg-macro-body"><pre>$contentCreateStruct->setField( 'image', '/path/to/image.png' );
 
// or
 
$contentCreateStruct->setField( 'image', array(
    'path' => '/path/to/image.png',
    'fileSize' => filesize( '/path/to/image.png' ),
    'fileName' => basename( 'image.png' ),
    'alternativeText' => 'My image'
);</pre></td></tr></table><h2>Create Content with XML Text</h2><table class="wysiwyg-macro" data-macro-name="info" data-macro-parameters="title=Full code" style="background-image: url(../servlet/confluence/placeholder/macro-headingecc6.png?definition=e2luZm86dGl0bGU9RnVsbCBjb2RlfQ&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="RICH_TEXT"><tr><td class="wysiwyg-macro-body"><p><a href="https://github.com/ezsystems/CookbookBundle/blob/master/Command/CreateXMLContentCommand.php">https://github.com/ezsystems/CookbookBundle/blob/master/Command/CreateXMLContentCommand.php</a></p></td></tr></table><p>Another very commonly used FieldType is the rich text one, <code>XmlText</code>.</p><table class="wysiwyg-macro" data-macro-name="code" data-macro-parameters="language=php|title=working with xml text" style="background-image: url(../servlet/confluence/placeholder/macro-heading5aa3.png?definition=e2NvZGU6dGl0bGU9d29ya2luZyB3aXRoIHhtbCB0ZXh0fGxhbmd1YWdlPXBocH0&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="PLAIN_TEXT"><tr><td class="wysiwyg-macro-body"><pre>$xmlText = &lt;&lt;&lt; EOX
&lt;?xml version='1.0' encoding='utf-8'?>
&lt;section>
&lt;paragraph>This is a &lt;strong>image test&lt;/strong>&lt;/paragraph>
&lt;paragraph>&lt;embed view='embed' size='medium' object_id='$imageId'/>&lt;/paragraph>
&lt;/section>
EOX;
$contentCreateStruct->setField( 'body', $xmlText );</pre></td></tr></table><p>As for the last example above, we use the multiple formats accepted by <code>setField()</code>, and provide our XML string as is. The only accepted format as of 5.0 is internal XML, the one stored in the Legacy database.</p><table class="wysiwyg-macro" data-macro-name="info" style="background-image: url(../servlet/confluence/placeholder/macro-headingd35c.png?definition=e2luZm99&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="RICH_TEXT"><tr><td class="wysiwyg-macro-body"><p>The XSD for the internal XML representation can be found in the kernel: <a href="https://github.com/ezsystems/ezpublish-kernel/blob/master/eZ/Publish/Core/FieldType/XmlText/Input/Resources/schemas/ezxml.xsd">https://github.com/ezsystems/ezpublish-kernel/blob/master/eZ/Publish/Core/FieldType/XmlText/Input/Resources/schemas/ezxml.xsd</a>.</p></td></tr></table><p>We embed an image in our XML, using the <code>&lt;embed&gt;</code> tag, providing an image Content ID as the <code>object_id</code> attribute.</p><table class="wysiwyg-macro" data-macro-name="note" data-macro-parameters="title=Using a custom format as input" style="background-image: url(../servlet/confluence/placeholder/macro-headinga8c3.png?definition=e25vdGU6dGl0bGU9VXNpbmcgYSBjdXN0b20gZm9ybWF0IGFzIGlucHV0fQ&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="RICH_TEXT"><tr><td class="wysiwyg-macro-body"><p>More input formats will be added later. The API for that is actually already available: you simply need to implement the <a href="http://ezsystems.github.com/ezpublish-kernel/sami/eZ/Publish/Core/FieldType/XmlText/Input.html"><code>XmlText\Input</code></a> interface. It contains one method, <a href="http://ezsystems.github.com/ezpublish-kernel/sami/eZ/Publish/Core/FieldType/XmlText/Input.html#method_getInternalRepresentation"><code>getInternalRepresentation()</code></a>, that must return an internal XML string. Create your own bundle, add your implementation to it, and use it in your code!</p><table class="wysiwyg-macro" data-macro-name="code" data-macro-parameters="language=php" style="background-image: url(../servlet/confluence/placeholder/macro-heading1802.png?definition=e2NvZGU6bGFuZ3VhZ2U9cGhwfQ&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="PLAIN_TEXT"><tr><td class="wysiwyg-macro-body"><pre>$input = new \My\XmlText\CustomInput( 'My custom format string' );
$contentCreateStruct->setField( 'body', $input );</pre></td></tr></table></td></tr></table><h2>Deleting Content</h2><p> </p><table class="wysiwyg-macro" data-macro-name="code" data-macro-parameters="language=php" style="background-image: url(../servlet/confluence/placeholder/macro-heading1802.png?definition=e2NvZGU6bGFuZ3VhZ2U9cGhwfQ&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="PLAIN_TEXT"><tr><td class="wysiwyg-macro-body"><pre>$contentService->delete( $contentInfo );</pre></td></tr></table><p><a href="http://ezsystems.github.com/ezpublish-kernel/sami/eZ/Publish/API/Repository/ContentService#method_deleteContent"><code>ContentService::delete()</code></a> method expects a ContentInfo as an argument. It will delete the given Content, all of its Locations, as well as all of the Content's Locations' descendants and their associated Content. <strong>Use with caution !</strong></p><div><span style="color: rgb(51,51,153);"><strong><br /></strong></span></div>
        <p>&nbsp;</p>
    </body>

<!-- Mirrored from doc.ez.no/plugins/viewsource/viewpagesrc.action?pageId=12781275 by HTTrack Website Copier/3.x [XR&CO'2013], Tue, 21 Oct 2014 13:51:12 GMT -->
</html>
