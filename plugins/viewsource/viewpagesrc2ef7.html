                    
    
                    
    
                    
    
<!DOCTYPE html>
<html>
    
<!-- Mirrored from doc.ez.no/plugins/viewsource/viewpagesrc.action?pageId=31432029 by HTTrack Website Copier/3.x [XR&CO'2013], Tue, 31 Jan 2017 09:37:41 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head>
        <title>View Source</title>
        <link rel="canonical" href="../../pages/viewpage2ef7.html?pageId=31432029" />
        <script>
window.WRM=window.WRM||{};window.WRM._unparsedData=window.WRM._unparsedData||{};
WRM._unparsedData["com.atlassian.plugins.atlassian-plugins-webresource-rest:web-resource-manager.resource-base-url-pattern"]="\"(?:(?:/s/.*?/_)?/download)\"";
WRM._unparsedData["com.atlassian.plugins.atlassian-plugins-webresource-plugin:context-path.context-path"]="\"\"";
WRM._unparsedData["com.atlassian.plugins.browser.metrics.browser-metrics-plugin:browser-metrics.feature-data-provider-legacy"]="true";
</script>
<link type="text/css" rel="stylesheet" href="../../s/1b9968ac17721e3a6947d14e3a43c3f8-CDN/en_GB/5983/f3e491afc761ac0a6981cfa3dcbc04fc7e88c149.16/89/_/download/superbatch/css/batch9c16.css?build-number=5983" media="all">
<!--[if lt IE 9]>
<link type="text/css" rel="stylesheet" href="/s/d41d8cd98f00b204e9800998ecf8427e-CDN/en_GB/5983/f3e491afc761ac0a6981cfa3dcbc04fc7e88c149.16/89/_/download/superbatch/css/batch.css?conditionalComment=lt+IE+9" media="all">
<![endif]-->
<!--[if lte IE 9]>
<link type="text/css" rel="stylesheet" href="/s/d41d8cd98f00b204e9800998ecf8427e-CDN/en_GB/5983/f3e491afc761ac0a6981cfa3dcbc04fc7e88c149.16/89/_/download/superbatch/css/batch.css?conditionalComment=lte+IE+9" media="all">
<![endif]-->
<link type="text/css" rel="stylesheet" href="../../s/d41d8cd98f00b204e9800998ecf8427e-CDN/en_GB/5983/f3e491afc761ac0a6981cfa3dcbc04fc7e88c149.16/f3685658010e413141854089096800b5/_/download/contextbatch/css/plugin.viewsource/batch.css" media="all">
<link type="text/css" rel="stylesheet" href="../../s/df762e50bc83a9608020a1ff1476cda6-CDN/en_GB/5983/f3e491afc761ac0a6981cfa3dcbc04fc7e88c149.16/5a0f37b8e5a58a48983bc1f25fb099f6/_/download/contextbatch/css/page/batch.css" media="all">
<!--[if lt IE 9]>
<link type="text/css" rel="stylesheet" href="/s/d41d8cd98f00b204e9800998ecf8427e-CDN/en_GB/5983/f3e491afc761ac0a6981cfa3dcbc04fc7e88c149.16/5a0f37b8e5a58a48983bc1f25fb099f6/_/download/contextbatch/css/page/batch.css?conditionalComment=lt+IE+9" media="all">
<![endif]-->
<link type="text/css" rel="stylesheet" href="../../s/5714bd5a5c86641cad10106916cda7c8-CDN/en_GB/5983/f3e491afc761ac0a6981cfa3dcbc04fc7e88c149.16/49f5f7dfc888d48bff618d087d8044cc/_/download/contextbatch/css/editor-content/batch.css" media="all">
<!--[if lte IE 9]>
<link type="text/css" rel="stylesheet" href="/s/d41d8cd98f00b204e9800998ecf8427e-CDN/en_GB/5983/f3e491afc761ac0a6981cfa3dcbc04fc7e88c149.16/49f5f7dfc888d48bff618d087d8044cc/_/download/contextbatch/css/editor-content/batch.css?conditionalComment=lte+IE+9" media="all">
<![endif]-->
<link type="text/css" rel="stylesheet" href="../../s/en_GB/5983/f3e491afc761ac0a6981cfa3dcbc04fc7e88c149.16/6/_/styles/colors74cd.css?spaceKey=DEVELOPER" media="all">
<link type="text/css" rel="stylesheet" href="../../s/en_GB/5983/f3e491afc761ac0a6981cfa3dcbc04fc7e88c149.16/6/_/styles/custom74cd.css?spaceKey=DEVELOPER" media="all">

    </head>

    <body class="mceContentBody aui-theme-default wiki-content fullsize">
        <p>&nbsp;</p>         <div class="contentLayout2">
<div class="columnLayout two-right-sidebar" data-layout="two-right-sidebar">
<div class="cell normal" data-type="normal">
<div class="innerCell">
<h1>Introduction</h1><h2>Cache Clearing</h2><p>This page describes commands involved in clearing cache from the command line.</p><h3>Clearing file cache using the Symfony cache:clear command</h3><p>Out of the box Symfony provides a command to perform cache clearing. It will delete all file-based caches, which mainly consist of Twig template, Symfony container, and Symfony route cache, but also everything else stored in cache folder. Out of the box on a single-server setup this includes &quot;Content cache&quot;. For further information on use, see the help text of the command:</p><table class="wysiwyg-macro" data-macro-name="code" data-macro-id="cd4b89d5-b4ce-4463-8e36-f1f5a41d9142" data-macro-parameters="language=bash" data-macro-schema-version="1" style="background-image: url(../servlet/confluence/placeholder/macro-heading174f.png?definition=e2NvZGU6bGFuZ3VhZ2U9YmFzaH0&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="PLAIN_TEXT"><tr><td class="wysiwyg-macro-body"><pre>php app/console --env=prod cache:clear -h</pre></td></tr></table><table class="wysiwyg-macro" data-macro-name="note" data-macro-id="26bf57e7-a91b-438e-b47d-417c3d6c1c61" data-macro-schema-version="1" style="background-image: url(../servlet/confluence/placeholder/macro-headingdd57.png?definition=e25vdGV9&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="RICH_TEXT"><tr><td class="wysiwyg-macro-body"><p>If you do not specify an environment, by default <code>cache:clear</code> will clear the cache for the <code>dev</code> environment. If you want to clear it for <code>prod</code> you need to to use the --env=prod option.</p></td></tr></table><table class="wysiwyg-macro" data-macro-name="info" data-macro-id="4be7e44b-e16b-413c-8e07-393e8f9c912b" data-macro-parameters="title=On each web server" data-macro-schema-version="1" style="background-image: url(../servlet/confluence/placeholder/macro-heading45ed.png?definition=e2luZm86dGl0bGU9T24gZWFjaCB3ZWIgc2VydmVyfQ&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="RICH_TEXT"><tr><td class="wysiwyg-macro-body"><p>In <a class="confluence-link" href="../../display/DEVELOPER/Clustering.html" data-linked-resource-id="31430387" data-linked-resource-version="19" data-linked-resource-type="page" data-linked-resource-default-alias="Clustering" data-base-url="../../index.html">Clustering</a> setup <em>(several web servers),</em> the command to clear file cache needs to be executed on each and every web server!</p></td></tr></table><h3>Clearing &quot;Content Cache&quot; on a Cluster setup</h3><p>For <a class="confluence-link" href="../../display/DEVELOPER/Clustering.html" data-linked-resource-id="31430387" data-linked-resource-version="19" data-linked-resource-type="page" data-linked-resource-default-alias="Clustering" data-base-url="../../index.html">Cluster</a> setup, the content cache (<a class="confluence-link" href="../../display/DEVELOPER/HTTP%2bCache.html" data-linked-resource-id="31430152" data-linked-resource-version="22" data-linked-resource-type="page" data-linked-resource-default-alias="HTTP Cache" data-base-url="../../index.html"> <span class="confluence-link">HTTP Cache</span> </a> <span class="confluence-link"> </span> and <a class="confluence-link" href="../../display/DEVELOPER/Repository.html#Repository-PersistenceCache" data-anchor="PersistenceCache" data-linked-resource-id="31432023" data-linked-resource-version="48" data-linked-resource-type="page" data-linked-resource-default-alias="Repository#PersistenceCache" data-base-url="../../index.html">Persistent Cache</a>) must be set up to be shared among the servers. And while all relevant cache is cleared for you on repository changes when using the APIs, there might be times where you'll need to clear cache manually: </p><ul><li>Varnish: <a href="../../display/DEVELOPER/HTTP%2bCache.html#HTTPCache-CachePurge">Cache purge</a></li><li>Persistence Cache: <a class="confluence-link" href="../../display/DEVELOPER/Repository.html#Repository-UsingCacheService" data-anchor="UsingCacheService" data-linked-resource-id="31432023" data-linked-resource-version="48" data-linked-resource-type="page" data-linked-resource-default-alias="Repository#UsingCacheService" data-base-url="../../index.html">Using Cache service</a></li></ul><h2>Web Debug Toolbar</h2><p>When running eZ Platform in the <code>dev</code> environment you have access to the standard Symfony Web Debug Toolbar. It is extended with some eZ Platform-specific information:</p><p><img class="confluence-embedded-image" alt="eZ Platform info in Web Debug Toolbar" src="../../download/attachments/31432029/webdebugtoolbarb2ed.png?version=1&amp;modificationDate=1479810720000&amp;api=v2" data-image-src="/download/attachments/31432029/webdebugtoolbar.png?version=1&amp;modificationDate=1479810720000&amp;api=v2" data-unresolved-comment-count="0" data-linked-resource-id="32868731" data-linked-resource-version="1" data-linked-resource-type="attachment" data-linked-resource-default-alias="webdebugtoolbar.png" data-base-url="https://doc.ez.no" data-linked-resource-content-type="image/png" data-linked-resource-container-id="31432029" data-linked-resource-container-version="13" title="Developer > Devops > webdebugtoolbar.png (eZ Platform info in Web Debug Toolbar)" data-location="Developer > Devops > webdebugtoolbar.png" data-element-title="eZ Platform info in Web Debug Toolbar" data-image-height="224" data-image-width="191"></p><h4>SPI (persistence)</h4><p>This section provides the number of non-cached <a class="confluence-link" href="../../display/DEVELOPER/Repository.html#Repository-SPI" data-anchor="SPI" data-linked-resource-id="31432023" data-linked-resource-version="48" data-linked-resource-type="page" data-linked-resource-default-alias="Repository#SPI" data-base-url="../../index.html">SPI </a>calls and handlers. You can see details of these calls in the <a href="http://symfony.com/doc/current/profiler.html">Symfony Profiler</a> page.</p><h4>Site Access</h4><p>Here you can see the name of the current Siteaccess and how it was matched. For reference see the <a class="confluence-link" href="../../display/DEVELOPER/SiteAccess.html#SiteAccess-Availablematchers" data-anchor="Availablematchers" data-linked-resource-id="31429665" data-linked-resource-version="21" data-linked-resource-type="page" data-linked-resource-default-alias="SiteAccess#Availablematchers" data-base-url="../../index.html">list of possible siteaccess matchers</a>.</p><h1>Configuration</h1><h2>Logging and Debug Configuration</h2><h3>Introduction</h3><p>Logging in eZ Platform consists of two parts, several debug systems that integrates with symfony developer toolbar to give you detailed information about what is going on. And standard <a href="https://github.com/php-fig/fig-standards/blob/master/accepted/PSR-3-logger-interface.md">PSR-3</a> logger, as provided by Symfony using <a href="https://github.com/Seldaek/monolog">Monolog</a>.</p><h3>Debugging in dev environment</h3><p>When using the Symfony dev <a class="confluence-link" href="../../display/DEVELOPER/Environments.html" data-linked-resource-id="31429669" data-linked-resource-version="4" data-linked-resource-type="page" data-linked-resource-default-alias="Environments" data-base-url="../../index.html"> <span class="confluence-link">environment</span> </a>, the system out of the box tracks additional metrics for you to be able to debug issues, this includes <a class="external-link" href="http://stash.tedivm.com/" rel="nofollow">Stash</a> cache use <em>(done by <a class="external-link" href="https://github.com/tedivm/TedivmStashBundle" rel="nofollow">StashBundle</a>)</em>, and a <a class="confluence-link" href="../../display/DEVELOPER/Repository.html#Repository-Persistencecacheconfiguration" data-anchor="Persistencecacheconfiguration" data-linked-resource-id="31432023" data-linked-resource-version="48" data-linked-resource-type="page" data-linked-resource-default-alias="Repository#Persistencecacheconfiguration" data-base-url="../../index.html">persistence cache</a> use.</p><h4>Reducing memory use</h4><table class="wysiwyg-macro" data-macro-name="tip" data-macro-id="7141654d-b5e6-4ca0-83b3-c76b089bf8ef" data-macro-schema-version="1" style="background-image: url(../servlet/confluence/placeholder/macro-heading7f8c.png?definition=e3RpcH0&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="RICH_TEXT"><tr><td class="wysiwyg-macro-body"><p class="confluence-link">For long running scripts, instead head over to <a class="confluence-link" href="../../display/DEVELOPER/Executing%2blong-running%2bconsole%2bcommands.html" data-linked-resource-id="31429811" data-linked-resource-version="6" data-linked-resource-type="page" data-linked-resource-default-alias="Executing long-running console commands" data-base-url="../../index.html">Executing long-running console commands</a> for some much more relevant info.</p></td></tr></table><p>If you are running out of memory and don't need to keep track of cache hits and misses. Then StashBundle tracking, represented by the <code>stash.tracking</code> setting, and persistence cache logging, represented by the setting <code>parameters.ezpublish.spi.persistence.cache.persistenceLogger.enableCallLogging</code>, can optionally be disabled.</p><p> </p><table class="wysiwyg-macro" data-macro-name="code" data-macro-id="8d26e4d6-2de1-4260-8011-4404ecb343de" data-macro-parameters="title=config_dev.yml" data-macro-schema-version="1" style="background-image: url(../servlet/confluence/placeholder/macro-heading2a7d.png?definition=e2NvZGU6dGl0bGU9Y29uZmlnX2Rldi55bWx9&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="PLAIN_TEXT"><tr><td class="wysiwyg-macro-body"><pre>stash:
    tracking: false                  # Default is true in dev
    tracking_values: false           # Default is false in dev, to only track cache keys not values
    caches:
        default:
            inMemory: false          # Default is true
            registerDoctrineAdapter: false

parameters:
    ezpublish.spi.persistence.cache.persistenceLogger.enableCallLogging: false</pre></td></tr></table><h3>Error logging and rotation</h3><p>eZ Platform uses the Monolog component to log errors, and it has a <code>RotatingFileHandler</code> that allows for file rotation.</p><p>According to their documentation, it &quot;logs records to a file and creates one logfile per day. It will also delete files older than <code>$maxFiles</code>&quot;.</p><p>But then, their own recommendation is to use &quot;<code>logrotate</code>&quot; instead of doing the rotation in the handler as you would have better performance.</p><p> </p><table class="wysiwyg-macro" data-macro-name="info" data-macro-id="b128be71-94ba-49b3-acd3-e51c17ba9166" data-macro-schema-version="1" style="background-image: url(../servlet/confluence/placeholder/macro-headingd35c.png?definition=e2luZm99&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="RICH_TEXT"><tr><td class="wysiwyg-macro-body"><p>More details here:</p><ul><li><a href="https://github.com/Seldaek/monolog">https://github.com/Seldaek/monolog</a></li><li><a href="http://linuxcommand.org/man_pages/logrotate8.html">http://linuxcommand.org/man_pages/logrotate8.html</a></li></ul></td></tr></table><p> </p><p>If you decided to use Monolog's handler, it can be configured in <code>app/config/config.yml</code></p><table class="wysiwyg-macro" data-macro-name="code" data-macro-id="bff1af0f-c0f5-41cb-a13e-5adf6f829ee2" data-macro-schema-version="1" style="background-image: url(../servlet/confluence/placeholder/macro-heading34e7.png?definition=e2NvZGV9&amp;locale=en_GB&amp;version=2); background-repeat: no-repeat;" data-macro-body-type="PLAIN_TEXT"><tr><td class="wysiwyg-macro-body"><pre>monolog:
    handlers:
        main:
            type: rotating_file
            max_files: 10
            path: "%kernel.logs_dir%/%kernel.environment%.log"
            level: debug</pre></td></tr></table></div>
</div>
<div class="cell aside" data-type="aside">
<div class="innerCell">
<h4>In this topic:</h4><p><img class="editor-inline-macro" src="../servlet/confluence/placeholder/macro7c73.png?definition=e3RvYzptYXhMZXZlbD0zfQ&amp;locale=en_GB&amp;version=2" data-macro-name="toc" data-macro-id="5c574569-832e-4f2e-8e5e-5c1867c0ab6c" data-macro-parameters="maxLevel=3" data-macro-schema-version="1"></p></div>
</div>
</div>
</div>
        <p>&nbsp;</p>
    </body>

<!-- Mirrored from doc.ez.no/plugins/viewsource/viewpagesrc.action?pageId=31432029 by HTTrack Website Copier/3.x [XR&CO'2013], Tue, 31 Jan 2017 09:37:42 GMT -->
</html>
